import{j as e}from"./components-core-BRDcvPfU.js";import{r as d,S as A,C as W,A as M,u as Le,b as V,v as Ce,F as z,w as ke,x as Re,d as Ae,D as he,e as Y,y as me,z as Me,X as De,B as Ee,J as Te,K as _e,T as B,G as X,O as Pe,a as Oe,c as Ie,U as Q,t as Fe,Q as ae,V as He,Y as $e,_ as ze,Z,i as Be,s as te,P as We,L as ie,$ as Ke,m as Ue,l as Qe}from"./vendor-icons-B0irx6x7.js";import{R as C,P as q,c as J,d as K,T as k,B as H,C as E,X as T,Y as _,L as F,a as P,A as Ge,b as G,e as Ve,f as Ze}from"./vendor-charts-rUuPS_kI.js";import{a as L}from"./components-dashboard-CdxA_Amh.js";import{m as Ye,a as Xe,b as qe,c as Je,d as es,e as ss,f as as,g as ts}from"./components-features-IjJoa6UW.js";const le={Malware:["Trojan","Backdoor","RAT","Botnet","Cryptominer"],Exploit:["RCE","SQLi","XSS","Buffer Overflow","Code Injection"],Phishing:["Credential Harvesting","Fake Login","CEO Fraud"],Scan:["Port Scan","Vuln Scan","Network Mapping"],Policy:["Unauthorized Access","Data Exfiltration","Suspicious Traffic"]},ne={Ransomware:["WannaCry","Ryuk","Lockbit","BlackCat"],APT:["APT28","APT29","Lazarus","Equation Group"],Webshell:["PHP Shell","JSP Shell","ASPX Shell"],Script:["Obfuscated PowerShell","Malicious VBS","JavaScript Dropper"],"Credential Theft":["Mimikatz","LaZagne","Password Dumper"]},ce={Execution:["Process Creation","Command Line","Scripting"],Persistence:["Registry","Scheduled Task","Startup"],"Defense Evasion":["Clear Logs","Disable Security","Obfuscation"],"Credential Access":["Credential Dumping","Brute Force"],Discovery:["Network Discovery","System Info","Account Discovery"]},is={Windows:.4,Linux:.3,Web:.25,Cloud:.15,Network:.2,Database:.1,Email:.05};function ee(a=365){const o=new Date;return o.setDate(o.getDate()-Math.floor(Math.random()*a)),o.toISOString().split("T")[0]}function se(){const a=Object.keys(is),o=Math.floor(Math.random()*3)+1,m=[];for(let h=0;h<o;h++){const x=a[Math.floor(Math.random()*a.length)];m.includes(x)||m.push(x)}return m}function ls(a){const o=[],m=Object.keys(le),h=["Low","Medium","High","Critical"];for(let x=0;x<a;x++){const j=m[Math.floor(Math.random()*m.length)],v=le[j],t=v[Math.floor(Math.random()*v.length)],l=h[Math.floor(Math.random()*h.length)];o.push({id:2e6+x,name:`ET ${j.toUpperCase()} ${t}`,description:`Detects ${t.toLowerCase()} activity in network traffic`,category:j,severity:l,status:Math.random()>.7?"enabled":"disabled",hits:Math.floor(Math.random()*1e3),updated:ee(),technology:se(),ruleType:"suricata"})}return o}function ns(a){const o=[],m=Object.keys(ne),h=["Medium","High","Critical"];for(let x=0;x<a;x++){const j=m[Math.floor(Math.random()*m.length)],v=ne[j],t=v[Math.floor(Math.random()*v.length)],l=h[Math.floor(Math.random()*h.length)];o.push({id:`yara-${String(x+1).padStart(4,"0")}`,name:`MALW_${t.replace(/\s/g,"_")}`,description:`Signature for ${t} malware family`,category:j,severity:l,status:Math.random()>.8?"enabled":"disabled",hits:Math.floor(Math.random()*50),updated:ee(180),technology:se(),ruleType:"yara"})}return o}function cs(a){const o=[],m=Object.keys(ce),h=["Low","Medium","High","Critical"];for(let x=0;x<a;x++){const j=m[Math.floor(Math.random()*m.length)],v=ce[j],t=v[Math.floor(Math.random()*v.length)],l=h[Math.floor(Math.random()*h.length)];o.push({id:`sigma-${String(x+1).padStart(4,"0")}`,name:`${j}: ${t}`,description:`Detects suspicious ${t.toLowerCase()} behavior`,category:j,severity:l,status:Math.random()>.75?"enabled":"disabled",hits:Math.floor(Math.random()*200),updated:ee(90),technology:se(),ruleType:"sigma"})}return o}function rs(){const a=ls(3e3),o=ns(1500),m=cs(500);return[...a,...o,...m]}const ds={Malware:"#ef4444",Exploit:"#f59e0b",Phishing:"#8b5cf6",Scan:"#3b82f6",Policy:"#10b981",Ransomware:"#dc2626",APT:"#7c3aed",Webshell:"#ea580c",Script:"#0891b2","Credential Theft":"#e11d48",Execution:"#f97316",Persistence:"#84cc16","Defense Evasion":"#06b6d4","Credential Access":"#ec4899",Discovery:"#14b8a6"},re={Critical:"#dc2626",High:"#f59e0b",Medium:"#3b82f6",Low:"#10b981"};function os({rules:a,onCategoryClick:o,onSeverityClick:m}){const h=d.useMemo(()=>{const t=a.length,l=a.filter(u=>u.status==="enabled").length,i=a.filter(u=>u.severity==="Critical").length,r=a.reduce((u,y)=>u+y.hits,0),f=t>0?Math.round(r/t):0,n=t>0?Math.round(l/t*100):0;return{totalRules:t,enabledRules:l,enabledPercentage:n,criticalRules:i,avgHits:f}},[a]),x=d.useMemo(()=>{const t={};return a.forEach(l=>{t[l.category]=(t[l.category]||0)+1}),Object.entries(t).map(([l,i])=>({name:l,value:i})).sort((l,i)=>i.value-l.value)},[a]),j=d.useMemo(()=>{const t={Critical:{total:0,enabled:0},High:{total:0,enabled:0},Medium:{total:0,enabled:0},Low:{total:0,enabled:0}};return a.forEach(l=>{t[l.severity]&&(t[l.severity].total++,l.status==="enabled"&&t[l.severity].enabled++)}),Object.entries(t).map(([l,i])=>({name:l,total:i.total,enabled:i.enabled}))},[a]),v=d.useMemo(()=>[...a].sort((t,l)=>l.hits-t.hits).slice(0,10),[a]);return e.jsxs("div",{className:"rule-analytics",children:[e.jsxs("div",{className:"analytics-stats-row",children:[e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h.totalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(W,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[h.enabledPercentage,"%"]}),e.jsxs("div",{className:"stat-label",children:["Enabled (",h.enabledRules.toLocaleString(),")"]})]})]}),e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h.criticalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Critical Severity"})]})]}),e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(Le,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h.avgHits}),e.jsx("div",{className:"stat-label",children:"Avg Hits per Rule"})]})]})]}),e.jsxs("div",{className:"analytics-charts-row",children:[e.jsxs("div",{className:"analytics-chart-card",children:[e.jsx("h3",{children:"Rules by Category"}),e.jsx(C,{width:"100%",height:300,children:e.jsxs(q,{children:[e.jsx(J,{data:x,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:l})=>l?`${t} (${(l*100).toFixed(0)}%)`:t,outerRadius:100,fill:"#8884d8",dataKey:"value",onClick:t=>o?.(t.name),style:{cursor:"pointer"},children:x.map((t,l)=>e.jsx(K,{fill:ds[t.name]||"#64748b"},`cell-${l}`))}),e.jsx(k,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"0.5rem",color:"#e2e8f0"}})]})})]}),e.jsxs("div",{className:"analytics-chart-card",children:[e.jsx("h3",{children:"Rules by Severity"}),e.jsx(C,{width:"100%",height:300,children:e.jsxs(H,{data:j,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(T,{dataKey:"name",stroke:"#94a3b8"}),e.jsx(_,{stroke:"#94a3b8"}),e.jsx(k,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"0.5rem",color:"#e2e8f0"}}),e.jsx(F,{}),e.jsx(P,{dataKey:"total",fill:"#3b82f6",name:"Total Rules",onClick:t=>t?.name&&m?.(t.name),style:{cursor:"pointer"}}),e.jsx(P,{dataKey:"enabled",fill:"#10b981",name:"Enabled"})]})})]})]}),e.jsxs("div",{className:"analytics-top-rules",children:[e.jsx("h3",{children:"Top 10 Most Triggered Rules"}),e.jsx("div",{className:"top-rules-table-container",children:e.jsxs("table",{className:"top-rules-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Rule Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Hits"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:v.map((t,l)=>e.jsxs("tr",{children:[e.jsx("td",{className:"rank",children:l+1}),e.jsx("td",{className:"rule-name",children:t.name}),e.jsx("td",{children:e.jsx("span",{className:"category-badge",children:t.category})}),e.jsx("td",{children:e.jsx("span",{className:`severity-badge ${t.severity.toLowerCase()}`,style:{background:`${re[t.severity]}20`,color:re[t.severity]},children:t.severity})}),e.jsx("td",{className:"hits",children:t.hits.toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${t.status}`,children:t.status})})]},t.id))})]})})]})]})}function hs(){const[a,o]=d.useState("suricata"),[m,h]=d.useState([]),[x,j]=d.useState([]),[v,t]=d.useState(!0),[l,i]=d.useState(null),[r,f]=d.useState(""),[n,u]=d.useState(""),[y,b]=d.useState(!1),[c,w]=d.useState(new Set),[D,$]=d.useState(!1),[S,O]=d.useState({category:"all",severity:"all",technology:"all",status:"all"}),[U,ue]=d.useState(!1),xe=s=>{if(typeof s=="number")return s>=1&&s<=3?"Critical":s===4?"High":s===5?"Medium":"Low";switch(String(s).toLowerCase()){case"critical":return"Critical";case"high":return"High";case"medium":return"Medium";case"low":return"Low";default:return"Informational"}},je=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return s}},ve=()=>{t(!0);const s=rs();j(s),ue(!0);const R=s.filter(g=>g.ruleType===a).map(g=>({id:g.id,name:g.name,category:g.category,severity:g.severity,status:g.status,hits:g.hits,updated:g.updated}));h(R),i({totalRules:s.length,activeRules:s.filter(g=>g.status==="enabled").length,recentHits:s.reduce((g,p)=>g+p.hits,0),lastUpdate:"Just now"}),t(!1)},pe=()=>{c.size===I.length?w(new Set):w(new Set(I.map(s=>s.id)))},ge=()=>{h(m.map(s=>c.has(s.id)?{...s,status:"enabled"}:s)),w(new Set)},ye=()=>{h(m.map(s=>c.has(s.id)?{...s,status:"disabled"}:s)),w(new Set)},Ne=()=>{h(m.map(s=>s.severity==="Critical"?{...s,status:"enabled"}:s))},be=()=>{h(m.map(s=>s.severity==="Critical"||s.severity==="High"&&(s.category.includes("Malware")||s.category.includes("Exploit")||s.category.includes("Ransomware"))?{...s,status:"enabled"}:s))},fe=()=>{h(m.map(s=>({...s,status:"disabled"}))),w(new Set)};d.useEffect(()=>{(async()=>{t(!0);try{if(a==="editor"){const g=await L.getSuricataRules();u(g.rules||""),t(!1);return}const[N,R]=await Promise.all([L.getDetectionRules(),L.getDetectionStats().catch(()=>null)]);if(N&&Array.isArray(N)){const g=N.filter(p=>a==="suricata"?p.type==="suricata"||p.type==="ids":a==="yara"?p.type==="yara":a==="sigma"?p.type==="sigma":!0).map(p=>({id:p.id||p.sid,name:p.name||p.msg,category:p.category||"Unclassified",severity:xe(p.severity||p.priority),status:p.enabled?"enabled":"disabled",hits:p.hit_count||0,updated:je(p.updated_at||p.last_modified)}));h(g),i(R?{totalRules:R.total_rules||g.length,activeRules:R.active_rules||g.filter(p=>p.status==="enabled").length,recentHits:R.recent_hits||0,lastUpdate:R.last_update||"10m ago"}:{totalRules:g.length,activeRules:g.filter(p=>p.status==="enabled").length,recentHits:0,lastUpdate:"Just now"})}else throw new Error("Invalid rules response")}catch(N){console.warn("Failed to load detection rules from API, using mock data:",N),i({totalRules:15420,activeRules:12850,recentHits:452,lastUpdate:"10m ago"}),h(a==="suricata"?[{id:2010983,name:"ET MALWARE Cobalt Strike Beacon",category:"Malware",severity:"Critical",status:"enabled",hits:124,updated:"2023-11-15"},{id:2025641,name:"ET EXPLOIT Apache Log4j RCE",category:"Exploit",severity:"Critical",status:"enabled",hits:45,updated:"2023-10-01"},{id:2001219,name:"ET SCAN Nmap Scripting Engine",category:"Scan",severity:"Medium",status:"enabled",hits:1250,updated:"2023-09-20"},{id:2014752,name:"ET POLICY Suspicious Inbound to Oracle SQL",category:"Policy",severity:"High",status:"disabled",hits:0,updated:"2023-08-15"},{id:2031450,name:"ET PHISHING Successful Generic Phish",category:"Phishing",severity:"High",status:"enabled",hits:12,updated:"2023-11-20"}]:a==="yara"?[{id:"yara-001",name:"SUSP_PowerShell_Obfuscated",category:"Script",severity:"High",status:"enabled",hits:8,updated:"2023-11-10"},{id:"yara-002",name:"MALW_Ransomware_WannaCry",category:"Ransomware",severity:"Critical",status:"enabled",hits:0,updated:"2023-05-12"},{id:"yara-003",name:"WEBSHELL_PHP_Generic",category:"Webshell",severity:"Critical",status:"enabled",hits:2,updated:"2023-10-05"},{id:"yara-004",name:"APT_Tool_Mimikatz_Memory",category:"Credential Theft",severity:"High",status:"disabled",hits:0,updated:"2023-09-01"}]:[{id:"sigma-001",name:"Suspicious Process Creation via WMI",category:"Execution",severity:"High",status:"enabled",hits:15,updated:"2023-11-18"},{id:"sigma-002",name:"Clear Windows Event Logs",category:"Defense Evasion",severity:"Medium",status:"enabled",hits:3,updated:"2023-10-22"}])}finally{t(!1)}})()},[a]);const Se=async()=>{b(!0);try{await L.updateSuricataRules(n)}catch(s){console.error("Failed to save rules:",s)}finally{b(!1)}},we=s=>{h(m.map(N=>N.id===s?{...N,status:N.status==="enabled"?"disabled":"enabled"}:N))},I=m.filter(s=>{const N=s.name.toLowerCase().includes(r.toLowerCase())||s.category.toLowerCase().includes(r.toLowerCase())||s.id.toString().includes(r),R=S.category==="all"||s.category===S.category,g=S.severity==="all"||s.severity===S.severity,p=S.status==="all"||s.status===S.status;return N&&R&&g&&p});return e.jsxs("div",{className:"advanced-detection",children:[e.jsxs("div",{className:"detection-stats-row",children:[e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.totalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(W,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.activeRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Active Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.recentHits}),e.jsx("div",{className:"stat-label",children:"Hits (24h)"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(V,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.lastUpdate}),e.jsx("div",{className:"stat-label",children:"Last Update"})]})]})]}),e.jsxs("div",{className:"detection-content",children:[e.jsxs("div",{className:"detection-sidebar",children:[e.jsxs("button",{className:`sidebar-item ${a==="suricata"?"active":""}`,onClick:()=>o("suricata"),children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:"Suricata IDS"})]}),e.jsxs("button",{className:`sidebar-item ${a==="yara"?"active":""}`,onClick:()=>o("yara"),children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"YARA Rules"})]}),e.jsxs("button",{className:`sidebar-item ${a==="sigma"?"active":""}`,onClick:()=>o("sigma"),children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"Sigma Rules"})]}),e.jsxs("button",{className:`sidebar-item ${a==="analytics"?"active":""}`,onClick:()=>o("analytics"),disabled:!U,children:[e.jsx(ke,{className:"w-4 h-4"}),e.jsx("span",{children:"Analytics"})]}),e.jsxs("button",{className:`sidebar-item ${a==="editor"?"active":""}`,onClick:()=>o("editor"),children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{children:"Rule Editor"})]})]}),e.jsx("div",{className:"rules-panel",children:a==="analytics"?e.jsx(os,{rules:x,onCategoryClick:s=>{o("suricata"),O({...S,category:s})},onSeverityClick:s=>{o("suricata"),O({...S,severity:s})}}):a==="editor"?e.jsxs("div",{className:"rule-editor-container",children:[e.jsxs("div",{className:"panel-controls",children:[e.jsx("h3",{children:"Suricata Rules File (suricata.rules)"}),e.jsx("div",{className:"control-actions",children:e.jsxs("button",{className:"btn-primary",onClick:Se,disabled:y,children:[y?e.jsx(V,{className:"w-4 h-4 animate-spin"}):e.jsx(Ae,{className:"w-4 h-4"}),y?"Saving...":"Save Rules"]})})]}),e.jsx("textarea",{className:"rule-editor-textarea",value:n,onChange:s=>u(s.target.value),spellCheck:"false"})]}):e.jsxs(e.Fragment,{children:[!U&&e.jsxs("div",{className:"load-library-prompt",children:[e.jsxs("button",{className:"btn-load-library",onClick:ve,children:[e.jsx(he,{className:"w-5 h-5"}),"Load Rule Library (5,000 Rules)"]}),e.jsx("p",{children:"Load comprehensive detection rules from Suricata ET, YARA, and Sigma"})]}),e.jsxs("div",{className:"panel-controls",children:[e.jsxs("div",{className:"search-input",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search rules by name, ID, or category...",value:r,onChange:s=>f(s.target.value)})]}),e.jsxs("div",{className:"control-actions",children:[e.jsxs("button",{className:"btn-secondary",onClick:()=>$(!D),children:[e.jsx(me,{className:"w-4 h-4"}),D?"Hide Filters":"Filters"]}),e.jsxs("button",{className:"btn-primary",children:[e.jsx(Me,{className:"w-4 h-4"})," Add Rule"]})]})]}),c.size>0&&e.jsxs("div",{className:"bulk-actions-toolbar",children:[e.jsx("div",{className:"bulk-info",children:e.jsxs("span",{children:[c.size," rule",c.size!==1?"s":""," selected"]})}),e.jsxs("div",{className:"bulk-buttons",children:[e.jsx("button",{className:"btn-sm btn-success",onClick:ge,children:"Enable Selected"}),e.jsx("button",{className:"btn-sm btn-danger",onClick:ye,children:"Disable Selected"}),e.jsxs("button",{className:"btn-sm btn-secondary",onClick:()=>w(new Set),children:[e.jsx(De,{className:"w-4 h-4"})," Clear Selection"]})]})]}),U&&e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{className:"btn-quick",onClick:Ne,children:"Enable All Critical"}),e.jsx("button",{className:"btn-quick",onClick:be,children:"Enable Recommended"}),e.jsx("button",{className:"btn-quick",onClick:fe,children:"Disable All"})]}),D&&e.jsx("div",{className:"filter-panel",children:e.jsxs("div",{className:"filter-row",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:S.category,onChange:s=>O({...S,category:s.target.value}),children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Malware",children:"Malware"}),e.jsx("option",{value:"Exploit",children:"Exploit"}),e.jsx("option",{value:"Phishing",children:"Phishing"}),e.jsx("option",{value:"Ransomware",children:"Ransomware"}),e.jsx("option",{value:"Scan",children:"Scan"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Severity"}),e.jsxs("select",{value:S.severity,onChange:s=>O({...S,severity:s.target.value}),children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:S.status,onChange:s=>O({...S,status:s.target.value}),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"enabled",children:"Enabled"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})]})]})}),e.jsx("div",{className:"rules-table-container",children:v?e.jsx("div",{className:"loading-state",children:"Loading rules..."}):e.jsxs("table",{className:"rules-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"},children:e.jsx("input",{type:"checkbox",checked:c.size===I.length&&I.length>0,onChange:pe})}),e.jsx("th",{style:{width:"60px"},children:"Status"}),e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Rule Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Hits"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:I.map(s=>e.jsxs("tr",{className:s.status==="disabled"?"disabled-row":"",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:c.has(s.id),onChange:()=>{const N=new Set(c);N.has(s.id)?N.delete(s.id):N.add(s.id),w(N)}})}),e.jsx("td",{children:e.jsx("button",{className:`toggle-btn ${s.status}`,onClick:()=>we(s.id),children:s.status==="enabled"?e.jsx(Ee,{className:"w-6 h-6 text-green-400"}):e.jsx(Te,{className:"w-6 h-6 text-gray-500"})})}),e.jsx("td",{className:"mono text-gray-400",children:s.id}),e.jsx("td",{className:"rule-name",children:s.name}),e.jsx("td",{children:e.jsx("span",{className:"category-badge",children:s.category})}),e.jsx("td",{children:e.jsx("span",{className:`severity-badge ${s.severity.toLowerCase()}`,children:s.severity})}),e.jsx("td",{className:"mono",children:s.hits.toLocaleString()}),e.jsx("td",{className:"text-gray-500",children:s.updated}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Edit"})})]},s.id))})]})})]})})]})]})}const fs=Object.freeze(Object.defineProperty({__proto__:null,default:hs},Symbol.toStringTag,{value:"Module"})),de=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];function ms(){const[a,o]=d.useState(null),[m,h]=d.useState([]),[x,j]=d.useState([]),[v,t]=d.useState([]),[l,i]=d.useState(!0),r=n=>n.is_expired?"expired":n.is_weak_key?"weak":n.is_valid?"valid":"unknown",f=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A";return d.useEffect(()=>{(async()=>{i(!0);try{const u=await L.getSSLStats();let y=null;try{const b=await L.getSensors({limit:1});if(b&&b.sensors&&b.sensors.length>0){const c=b.sensors[0].id;y=await L.getSensorCertificates(c)}}catch(b){console.warn("Could not fetch certificate data:",b)}if(u||y){if(o({totalConnections:u?.total_connections||0,securePercentage:u?.secure_percentage||0,expiredCerts:u?.expiring_soon||y?.expired_count||0,weakCiphers:u?.weak_ciphers||0}),y&&y.certificates){const b=y.certificates.map((c,w)=>({id:c.id||w+1,subject:c.subject||c.common_name||"Unknown",issuer:c.issuer||"Unknown",type:c.key_type||"RSA 2048",status:r(c),expiry:f(c.not_after||c.expiry)}));t(b)}throw new Error("Using mock data for TLS versions and ciphers")}else throw new Error("No SSL data available")}catch(u){console.warn("Failed to load SSL analysis from API, using mock data:",u),o({totalConnections:452890,securePercentage:98.2,expiredCerts:12,weakCiphers:450}),h([{name:"TLS 1.3",value:65},{name:"TLS 1.2",value:30},{name:"TLS 1.1",value:3},{name:"TLS 1.0",value:1},{name:"SSLv3",value:1}]),j([{name:"TLS_AES_128_GCM_SHA256",count:15e4},{name:"TLS_AES_256_GCM_SHA384",count:12e4},{name:"ECDHE-RSA-AES128-GCM-SHA256",count:8e4},{name:"ECDHE-RSA-AES256-GCM-SHA384",count:6e4},{name:"Other",count:42890}]),t([{id:1,subject:"internal-db.corp.local",issuer:"Corp-CA",type:"Self-signed",status:"expired",expiry:"2023-11-01"},{id:2,subject:"legacy-app.corp.local",issuer:"Corp-CA",type:"RSA 1024",status:"weak",expiry:"2024-05-15"},{id:3,subject:"test-env.dev",issuer:"Dev-CA",type:"Self-signed",status:"valid",expiry:"2024-12-20"},{id:4,subject:"payment-gateway.corp",issuer:"DigiCert",type:"RSA 2048",status:"valid",expiry:"2025-01-10"},{id:5,subject:"vpn.corp.net",issuer:"Let's Encrypt",type:"ECDSA",status:"valid",expiry:"2024-02-28"}])}finally{i(!1)}})()},[]),l?e.jsx("div",{className:"loading-state",children:"Analyzing SSL/TLS traffic..."}):e.jsxs("div",{className:"ssl-analysis",children:[e.jsxs("div",{className:"ssl-stats-row",children:[e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(_e,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.securePercentage,"%"]}),e.jsx("div",{className:"stat-label",children:"Encrypted Traffic"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.expiredCerts}),e.jsx("div",{className:"stat-label",children:"Expired Certs"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.weakCiphers}),e.jsx("div",{className:"stat-label",children:"Weak Ciphers"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.totalConnections?(a.totalConnections/1e3).toFixed(1):0,"k"]}),e.jsx("div",{className:"stat-label",children:"Total Connections"})]})]})]}),e.jsxs("div",{className:"ssl-content-grid",children:[e.jsxs("div",{className:"ssl-charts-col",children:[e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Pe,{className:"w-4 h-4 text-blue-400"})," TLS Version Distribution"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(q,{children:[e.jsx(J,{data:m,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:m.map((n,u)=>e.jsx(K,{fill:de[u%de.length]},`cell-${u}`))}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(F,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]}),e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-4 h-4 text-purple-400"})," Top Cipher Suites"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(H,{data:x,layout:"vertical",margin:{left:40},children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(T,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(_,{dataKey:"name",type:"category",width:150,stroke:"#94a3b8",fontSize:10}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(P,{dataKey:"count",fill:"#8b5cf6",radius:[0,4,4,0]})]})})})]})]}),e.jsx("div",{className:"ssl-table-col",children:e.jsxs("div",{className:"ssl-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(z,{className:"w-4 h-4 text-orange-400"})," Certificate Hygiene"]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(V,{className:"w-3 h-3"})," Scan"]})]}),e.jsxs("table",{className:"ssl-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Subject (CN)"}),e.jsx("th",{children:"Issuer"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Expiry"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:v.map(n=>e.jsxs("tr",{children:[e.jsxs("td",{children:[n.status==="valid"&&e.jsx("span",{className:"status-badge success",children:"Valid"}),n.status==="expired"&&e.jsx("span",{className:"status-badge danger",children:"Expired"}),n.status==="weak"&&e.jsx("span",{className:"status-badge warning",children:"Weak"})]}),e.jsx("td",{className:"mono text-white",children:n.subject}),e.jsx("td",{className:"text-gray-400",children:n.issuer}),e.jsx("td",{className:"text-gray-400",children:n.type}),e.jsx("td",{className:"mono text-gray-400",children:n.expiry}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Details"})})]},n.id))})]})]})})]})]})}const Ss=Object.freeze(Object.defineProperty({__proto__:null,default:ms},Symbol.toStringTag,{value:"Module"})),oe=["#3b82f6","#10b981","#f59e0b","#ef4444"];function us(){const[a,o]=d.useState({openCritical:12,mttr:"18m",analystsOnline:"4/6",slaCompliance:98.5}),[m,h]=d.useState([]),[x,j]=d.useState([]),[v,t]=d.useState([]);return d.useEffect(()=>{(async()=>{try{const i=await L.getSocMetrics(),r=await L.getDashboardStats();throw i||r?(o({openCritical:i?.open_critical||r?.summary?.critical_alerts||12,mttr:i?.mean_time_to_respond||"18m",analystsOnline:i?.analysts_online||"4/6",slaCompliance:i?.sla_compliance||98.5}),new Error("Using mock chart data")):new Error("No SOC data available")}catch(i){console.warn("Failed to load SOC metrics from API, using mock data:",i),h(Ye),j(Xe),t(qe)}finally{}})()},[]),e.jsxs("div",{className:"soc-dashboard",children:[e.jsxs("div",{className:"soc-header-grid",children:[e.jsxs("div",{className:"soc-stat-card critical",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Oe,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a.openCritical}),e.jsx("div",{className:"stat-label",children:"Open Critical Incidents"}),e.jsx("div",{className:"stat-trend down",children:"↓ 2 from last hour"})]})]}),e.jsxs("div",{className:"soc-stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Ie,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a.mttr}),e.jsx("div",{className:"stat-label",children:"Mean Time to Respond"}),e.jsx("div",{className:"stat-trend up",children:"↑ 2m vs target"})]})]}),e.jsxs("div",{className:"soc-stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Q,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a.analystsOnline}),e.jsx("div",{className:"stat-label",children:"Analysts Online"}),e.jsx("div",{className:"stat-trend neutral",children:"Shift A"})]})]}),e.jsxs("div",{className:"soc-stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(W,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a.slaCompliance,"%"]}),e.jsx("div",{className:"stat-label",children:"SLA Compliance"}),e.jsx("div",{className:"stat-trend up",children:"↑ 0.5% this week"})]})]})]}),e.jsxs("div",{className:"soc-content-grid",children:[e.jsxs("div",{className:"soc-col-main",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(M,{className:"w-5 h-5 text-blue-400"})," 24h Alert Volume"]})}),e.jsx("div",{className:"chart-container-lg",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(Ge,{data:m,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorCritical",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorHigh",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(T,{dataKey:"time",stroke:"#94a3b8"}),e.jsx(_,{stroke:"#94a3b8"}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"},itemStyle:{color:"#e2e8f0"}}),e.jsx(F,{}),e.jsx(G,{type:"monotone",dataKey:"critical",stackId:"1",stroke:"#ef4444",fill:"url(#colorCritical)"}),e.jsx(G,{type:"monotone",dataKey:"high",stackId:"1",stroke:"#f59e0b",fill:"url(#colorHigh)"}),e.jsx(G,{type:"monotone",dataKey:"medium",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.1})]})})})]}),e.jsxs("div",{className:"soc-row-split",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Q,{className:"w-5 h-5 text-purple-400"})," Analyst Workload"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(H,{data:x,layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(T,{type:"number",stroke:"#94a3b8"}),e.jsx(_,{dataKey:"name",type:"category",stroke:"#94a3b8",width:80}),e.jsx(k,{cursor:{fill:"rgba(255,255,255,0.05)"},contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(F,{}),e.jsx(P,{dataKey:"active",name:"Active Cases",fill:"#f59e0b",radius:[0,4,4,0]}),e.jsx(P,{dataKey:"resolved",name:"Resolved (Today)",fill:"#10b981",radius:[0,4,4,0]})]})})})]}),e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Fe,{className:"w-5 h-5 text-cyan-400"})," Alerts by Source"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(q,{children:[e.jsx(J,{data:v,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:v.map((l,i)=>e.jsx(K,{fill:oe[i%oe.length]},`cell-${i}`))}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(F,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]})]}),e.jsxs("div",{className:"soc-col-side",children:[e.jsxs("div",{className:"soc-panel map-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(X,{className:"w-5 h-5 text-green-400"})," Threat Origins"]})}),e.jsxs("div",{className:"world-map-container",children:[e.jsxs("svg",{viewBox:"0 0 900 450",className:"world-map-svg",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("g",{className:"continents",children:[e.jsx("path",{d:`M 120,100 L 140,85 L 155,80 L 165,75 L 180,70 L 195,75 L 210,80 L 220,90 L 225,105 L 230,120 L 228,135 L 220,150 L 210,165 L 200,175 L 185,180 L 170,178 L 155,172 L 145,165 L 135,155 L 128,140 L 125,125 L 122,110 Z
                    M 160,180 L 165,185 L 172,195 L 178,205 L 180,215 L 178,225 L 172,230 L 165,228 L 158,223 L 155,215 L 154,205 L 156,195 L 158,188 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 195,230 L 205,235 L 215,245 L 220,260 L 223,280 L 223,300 L 220,320 L 215,335 L 208,345 L 198,350 L 188,348 L 180,340 L 175,328 L 172,315 L 170,300 L 168,285 L 168,270 L 170,255 L 175,243 L 182,235 L 188,232 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 420,100 L 435,95 L 450,93 L 465,95 L 480,100 L 492,108 L 500,118 L 502,130 L 498,142 L 488,150 L 475,155 L 460,157 L 445,155 L 432,148 L 422,138 L 418,125 L 418,112 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 440,165 L 455,162 L 470,163 L 485,168 L 500,178 L 512,195 L 520,215 L 523,235 L 522,255 L 518,275 L 510,295 L 498,310 L 483,320 L 465,323 L 448,320 L 432,310 L 420,295 L 412,278 L 408,260 L 407,242 L 410,225 L 418,208 L 428,190 L 435,178 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:`M 510,95 L 535,90 L 560,88 L 585,90 L 610,95 L 635,102 L 660,110 L 685,120 L 705,133 L 720,148 L 728,165 L 730,182 L 725,200 L 715,215 L 700,228 L 680,238 L 655,243 L 630,243 L 605,238 L 580,230 L 560,220 L 545,208 L 535,195 L 528,180 L 525,165 L 525,150 L 528,135 L 535,120 L 545,108 L 560,100 L 580,95 L 600,93 Z
                    M 735,145 L 745,150 L 755,158 L 760,168 L 758,178 L 750,183 L 740,180 L 735,172 L 733,162 L 735,152 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 680,290 L 700,288 L 720,290 L 740,295 L 755,303 L 765,315 L 768,328 L 765,340 L 755,348 L 740,352 L 720,353 L 700,350 L 685,343 L 673,333 L 668,320 L 668,308 L 672,298 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 150,390 L 250,385 L 350,387 L 450,390 L 550,388 L 650,390 L 750,392 L 750,410 L 650,415 L 550,413 L 450,415 L 350,413 L 250,415 L 150,413 Z",fill:"#1e40af",opacity:"0.2",stroke:"#3b82f6",strokeWidth:"1"})]}),e.jsxs("g",{className:"threat-indicators",children:[e.jsx("circle",{cx:"165",cy:"130",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"165",cy:"130",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"2s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"2s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"445",cy:"120",r:"4",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"445",cy:"120",r:"8",fill:"none",stroke:"#f59e0b",strokeWidth:"1.5",opacity:"0.5",children:[e.jsx("animate",{attributeName:"r",values:"8;16;8",dur:"3s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.5;0;0.5",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"650",cy:"160",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"1.5s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"650",cy:"160",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"1.5s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"580",cy:"110",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.8s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"455",cy:"240",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"200",cy:"290",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.2s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"720",cy:"320",r:"3",fill:"#10b981",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"600",cy:"195",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.7s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"745",cy:"155",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.3s",repeatCount:"indefinite"})})]}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#1e293b",strokeWidth:"0.5",opacity:"0.2"})}),e.jsxs("linearGradient",{id:"ocean",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#0f172a",stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:"#1e293b",stopOpacity:"0.5"})]})]}),e.jsx("rect",{width:"900",height:"450",fill:"url(#ocean)"}),e.jsx("rect",{width:"900",height:"450",fill:"url(#grid)"})]}),e.jsxs("div",{className:"map-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot critical"}),e.jsx("span",{children:"Critical"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot high"}),e.jsx("span",{children:"High"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot medium"}),e.jsx("span",{children:"Medium"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot low"}),e.jsx("span",{children:"Low"})]})]})]})]}),e.jsxs("div",{className:"soc-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-5 h-5 text-red-400"})," Priority Incidents"]})}),e.jsx("div",{className:"incident-list",children:[{id:"INC-2024-001",title:"Ransomware Activity",severity:"critical",assignee:"Analyst A",time:"10m"},{id:"INC-2024-002",title:"Data Exfiltration",severity:"high",assignee:"Analyst B",time:"45m"},{id:"INC-2024-003",title:"Brute Force Attack",severity:"high",assignee:"Unassigned",time:"1h"},{id:"INC-2024-004",title:"Malware Download",severity:"medium",assignee:"Analyst C",time:"2h"}].map((l,i)=>e.jsxs("div",{className:"incident-item",children:[e.jsx("div",{className:`severity-bar ${l.severity}`}),e.jsxs("div",{className:"incident-content",children:[e.jsxs("div",{className:"incident-top",children:[e.jsx("span",{className:"incident-id",children:l.id}),e.jsxs("span",{className:"incident-time",children:[l.time," ago"]})]}),e.jsx("div",{className:"incident-title",children:l.title}),e.jsxs("div",{className:"incident-assignee",children:[e.jsx(Q,{className:"w-3 h-3"})," ",l.assignee]})]})]},i))})]})]})]})]})}const ws=Object.freeze(Object.defineProperty({__proto__:null,default:us},Symbol.toStringTag,{value:"Module"}));function xs(){const[a,o]=d.useState(null),[m,h]=d.useState([]),[x,j]=d.useState(!0);d.useEffect(()=>{(async()=>{j(!0);try{const r=await L.getFileStats();throw r?(o({totalFiles:r.total_files||0,malicious:r.malicious_count||0,suspicious:r.suspicious_count||0,clean:r.clean_count||0,pending:r.pending_count||0}),new Error("Using mock file list data")):new Error("No file stats available")}catch(r){console.warn("Failed to load file analysis from API, using mock data:",r),o({totalFiles:1245,malicious:23,suspicious:45,clean:1177,pending:5}),h([{id:1,name:"invoice_2023.pdf.exe",type:"PE32 Executable",size:"1.2 MB",source:"192.168.1.105",dest:"10.0.0.5",status:"malicious",score:98,detection:"Trojan.Win32.Emotet",time:"10m ago"},{id:2,name:"powershell_script.ps1",type:"Script",size:"15 KB",source:"192.168.1.112",dest:"10.0.0.5",status:"suspicious",score:75,detection:"Obfuscated Script",time:"45m ago"},{id:3,name:"quarterly_report.docx",type:"Document",size:"4.5 MB",source:"192.168.1.200",dest:"10.0.0.5",status:"clean",score:0,detection:"-",time:"1h ago"},{id:4,name:"unknown_binary.bin",type:"Binary",size:"512 KB",source:"192.168.1.15",dest:"External",status:"pending",score:0,detection:"Analyzing...",time:"2m ago"},{id:5,name:"update.zip",type:"Archive",size:"12 MB",source:"External",dest:"192.168.1.50",status:"malicious",score:100,detection:"Ransomware.LockBit",time:"3h ago"}])}finally{j(!1)}})()},[]);const v=i=>i.includes("Executable")||i.includes("Binary")?e.jsx(ae,{className:"w-4 h-4 text-red-400"}):i.includes("Script")?e.jsx(z,{className:"w-4 h-4 text-yellow-400"}):i.includes("Archive")?e.jsx(He,{className:"w-4 h-4 text-blue-400"}):e.jsx($e,{className:"w-4 h-4 text-gray-400"}),t=i=>{switch(i){case"malicious":return e.jsx("span",{className:"status-badge danger",children:"Malicious"});case"suspicious":return e.jsx("span",{className:"status-badge warning",children:"Suspicious"});case"clean":return e.jsx("span",{className:"status-badge success",children:"Clean"});case"pending":return e.jsx("span",{className:"status-badge info",children:"Pending"});default:return e.jsx("span",{className:"status-badge",children:"Unknown"})}},l=[{name:"Executables",count:145},{name:"Scripts",count:89},{name:"Documents",count:450},{name:"Archives",count:120},{name:"Images",count:441}];return x?e.jsx("div",{className:"loading-state",children:"Scanning extracted files..."}):e.jsxs("div",{className:"file-analysis",children:[e.jsxs("div",{className:"file-stats-row",children:[e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.totalFiles}),e.jsx("div",{className:"stat-label",children:"Files Extracted (24h)"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.malicious}),e.jsx("div",{className:"stat-label",children:"Malicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.suspicious}),e.jsx("div",{className:"stat-label",children:"Suspicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.pending}),e.jsx("div",{className:"stat-label",children:"Pending Analysis"})]})]})]}),e.jsxs("div",{className:"file-content-grid",children:[e.jsx("div",{className:"file-left-col",children:e.jsxs("div",{className:"file-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(ae,{className:"w-4 h-4 text-blue-400"})," File Types"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(H,{data:l,layout:"vertical",margin:{left:40},children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(T,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(_,{dataKey:"name",type:"category",width:80,stroke:"#94a3b8",fontSize:10}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(P,{dataKey:"count",fill:"#3b82f6",radius:[0,4,4,0],children:l.map((i,r)=>e.jsx(K,{fill:["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#10b981"][r%5]},`cell-${r}`))})]})})})]})}),e.jsx("div",{className:"file-right-col",children:e.jsxs("div",{className:"file-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(M,{className:"w-4 h-4 text-orange-400"})," Recent File Analysis"]}),e.jsx("div",{className:"panel-actions",children:e.jsxs("div",{className:"search-input-sm",children:[e.jsx(Y,{className:"w-3 h-3"}),e.jsx("input",{type:"text",placeholder:"Search files..."})]})})]}),e.jsxs("table",{className:"file-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"File Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Detection"}),e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:m.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:t(i.status)}),e.jsxs("td",{children:[e.jsxs("div",{className:"file-name-cell",children:[v(i.type),e.jsx("span",{className:"file-name",children:i.name})]}),e.jsxs("div",{className:"file-meta",children:[i.size," • ",i.source]})]}),e.jsx("td",{className:"text-gray-400",children:i.type}),e.jsx("td",{children:e.jsxs("div",{className:`score-badge ${i.score>80?"critical":i.score>50?"high":"low"}`,children:[i.score,"/100"]})}),e.jsx("td",{style:{color:"#fca5a5"},children:i.detection}),e.jsx("td",{className:"text-gray-500",children:i.time}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",title:"Download Sample",children:e.jsx(he,{className:"w-4 h-4"})})})]},i.id))})]})]})})]})]})}const Ls=Object.freeze(Object.defineProperty({__proto__:null,default:xs},Symbol.toStringTag,{value:"Module"}));function js(){const[a,o]=d.useState(null),[m,h]=d.useState([]),[x,j]=d.useState([]),[v,t]=d.useState(!0);d.useEffect(()=>{(async()=>{t(!0);try{const f=await L.getDNSStats();throw f?(o({totalQueries:f.total_queries||0,blockedQueries:f.blocked_queries||0,dgaDomains:f.dga_domains||0,tunnelingAlerts:f.tunneling_alerts||0}),new Error("Using mock data for queries and tunneling events")):new Error("No DNS stats available")}catch(f){console.warn("Failed to load DNS intelligence from API, using mock data:",f),o(ss),h(as),j(ts)}finally{t(!1)}})()},[]);const l=es,i=Je;return v?e.jsx("div",{className:"loading-state",children:"Analyzing DNS traffic..."}):e.jsxs("div",{className:"dns-intelligence",children:[e.jsxs("div",{className:"dns-stats-row",children:[e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.totalQueries?(a.totalQueries/1e3).toFixed(1):0,"k"]}),e.jsx("div",{className:"stat-label",children:"Total Queries (24h)"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(ze,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.blockedQueries}),e.jsx("div",{className:"stat-label",children:"Blocked Domains"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.dgaDomains}),e.jsx("div",{className:"stat-label",children:"DGA Detected"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-orange-500/10 text-orange-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.tunnelingAlerts}),e.jsx("div",{className:"stat-label",children:"Tunneling Events"})]})]})]}),e.jsxs("div",{className:"dns-content-grid",children:[e.jsxs("div",{className:"dns-left-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(M,{className:"w-4 h-4 text-blue-400"})," DNS Query Volume (QPS)"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(Ve,{data:i,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(T,{dataKey:"time",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(_,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(Ze,{type:"monotone",dataKey:"qps",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})]}),e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Be,{className:"w-4 h-4 text-purple-400"})," Query Types"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(H,{data:l,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(T,{dataKey:"name",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(_,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(P,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})]})]}),e.jsxs("div",{className:"dns-right-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(B,{className:"w-4 h-4 text-red-400"})," DNS Tunneling Detection"]})}),e.jsx("div",{className:"tunnel-list",children:x.map(r=>e.jsxs("div",{className:"tunnel-item",children:[e.jsx("div",{className:"tunnel-icon",children:e.jsx(B,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{className:"tunnel-info",children:[e.jsx("div",{className:"tunnel-domain",children:r.domain}),e.jsxs("div",{className:"tunnel-meta",children:[e.jsx("span",{children:r.method}),e.jsx("span",{children:"•"}),e.jsx("span",{children:r.volume}),e.jsx("span",{children:"•"}),e.jsx("span",{children:r.client})]})]}),e.jsxs("div",{className:"tunnel-confidence",children:[e.jsxs("div",{className:"confidence-val",children:[r.confidence,"%"]}),e.jsx("div",{className:"confidence-lbl",children:"Confidence"})]})]},r.id))})]}),e.jsxs("div",{className:"dns-panel flex-1",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(Y,{className:"w-4 h-4 text-green-400"})," Recent Queries"]}),e.jsx("button",{className:"btn-icon",children:e.jsx(me,{className:"w-4 h-4"})})]}),e.jsxs("table",{className:"dns-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Domain"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:m.map(r=>e.jsxs("tr",{children:[e.jsxs("td",{children:[r.status==="blocked"&&e.jsx("span",{className:"status-dot blocked",title:"Blocked"}),r.status==="allowed"&&e.jsx("span",{className:"status-dot allowed",title:"Allowed"}),r.status==="flagged"&&e.jsx("span",{className:"status-dot flagged",title:"Flagged"})]}),e.jsx("td",{className:"mono text-white",children:r.domain}),e.jsx("td",{className:"text-gray-400",children:r.type}),e.jsx("td",{className:"mono text-blue-300",children:r.client}),e.jsx("td",{children:e.jsx("span",{className:"category-tag",children:r.category})}),e.jsx("td",{className:"text-gray-500",children:r.time})]},r.id))})]})]})]})]})]})}const Cs=Object.freeze(Object.defineProperty({__proto__:null,default:js},Symbol.toStringTag,{value:"Module"}));function vs({view:a="playbooks"}){const[o,m]=d.useState(a),[h,x]=d.useState([]),[j,v]=d.useState([]),[t,l]=d.useState([]),[i,r]=d.useState(!0);d.useEffect(()=>{m(a)},[a]);const f=n=>{if(!n)return"-";const u=new Date,y=new Date(n),b=u.getTime()-y.getTime(),c=Math.round(b/1e3),w=Math.round(c/60),D=Math.round(w/60),$=Math.round(D/24);return c<60?`${c}s ago`:w<60?`${w}m ago`:D<24?`${D}h ago`:$<7?`${$}d ago`:y.toLocaleDateString()};return d.useEffect(()=>{(async()=>{r(!0);try{const[u,y]=await Promise.all([L.getPlaybooks(),L.getExecutions({limit:10})]);if(u&&Array.isArray(u)&&u.length>0){const b=u.map(c=>({id:c.id,name:c.name||c.title,trigger:c.trigger||"Manual",status:c.status==="active"||c.status==="manual"||c.status==="disabled"?c.status:"manual",runs:c.execution_count||0,successRate:c.success_rate||100,lastRun:f(c.last_execution)}));x(b)}if(y&&Array.isArray(y)&&y.length>0){const b=y.map(c=>({id:c.id,playbook:c.playbook_name||"Unknown",target:c.target||c.alert_id||"N/A",status:c.status==="completed"?"success":c.status==="failed"?"failed":"running",time:f(c.started_at),duration:c.duration||"-"}));l(b)}if((!u||u.length===0)&&(!y||y.length===0))throw new Error("No SOAR data available from API");v([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}])}catch(u){console.warn("Failed to load SOAR data from API, using mock data:",u),x([{id:1,name:"Block Malicious IP (Firewall)",trigger:"Critical Alert",status:"active",runs:145,successRate:98,lastRun:"10m ago"},{id:2,name:"Isolate Host (EDR)",trigger:"Ransomware Detection",status:"active",runs:12,successRate:100,lastRun:"2h ago"},{id:3,name:"Enrich IOCs (VirusTotal)",trigger:"New Artifact",status:"active",runs:1250,successRate:99,lastRun:"1m ago"},{id:4,name:"Reset User Password (AD)",trigger:"Brute Force Success",status:"manual",runs:5,successRate:100,lastRun:"1d ago"},{id:5,name:"Send Slack Notification",trigger:"High Severity",status:"active",runs:450,successRate:100,lastRun:"5m ago"}]),v([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}]),l([{id:101,playbook:"Block Malicious IP",target:"185.22.1.4",status:"success",time:"10m ago",duration:"2s"},{id:102,playbook:"Enrich IOCs",target:"hash: 44d8...2f",status:"success",time:"12m ago",duration:"1.5s"},{id:103,playbook:"Send Slack Notification",target:"#security-ops",status:"success",time:"15m ago",duration:"0.5s"},{id:104,playbook:"Isolate Host",target:"WORKSTATION-04",status:"failed",time:"2h ago",duration:"5s"}])}finally{r(!1)}})()},[]),i?e.jsx("div",{className:"loading-state",children:"Loading automation modules..."}):e.jsxs("div",{className:"soar-integration",children:[e.jsxs("div",{className:"soar-header",children:[e.jsxs("div",{className:"view-selector",children:[e.jsxs("button",{className:`view-btn ${o==="playbooks"?"active":""}`,onClick:()=>m("playbooks"),children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Playbooks & Automation"})]}),e.jsxs("button",{className:`view-btn ${o==="connectors"?"active":""}`,onClick:()=>m("connectors"),children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"SIEM & Connectors"})]})]}),e.jsx("div",{className:"soar-actions",children:e.jsx("button",{className:"btn-primary",children:o==="playbooks"?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4"})," New Playbook"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4"})," New Connector"]})})})]}),e.jsx("div",{className:"soar-content",children:o==="playbooks"?e.jsx("div",{className:"playbooks-view",children:e.jsxs("div",{className:"soar-grid",children:[e.jsxs("div",{className:"soar-panel flex-2",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Z,{className:"w-4 h-4 text-yellow-400"})," Active Playbooks"]})}),e.jsxs("table",{className:"soar-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Playbook Name"}),e.jsx("th",{children:"Trigger"}),e.jsx("th",{children:"Success Rate"}),e.jsx("th",{children:"Last Run"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:h.map(n=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:`status-pill ${n.status}`,children:n.status})}),e.jsx("td",{className:"font-medium text-white",children:n.name}),e.jsx("td",{className:"text-gray-400",children:n.trigger}),e.jsxs("td",{children:[e.jsx("div",{className:"progress-bar-sm",children:e.jsx("div",{className:"progress-fill",style:{width:`${n.successRate}%`,background:n.successRate>90?"#10b981":"#f59e0b"}})}),e.jsxs("span",{className:"text-xs text-gray-400",children:[n.successRate,"%"]})]}),e.jsx("td",{className:"text-gray-500",children:n.lastRun}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",children:e.jsx(Ke,{className:"w-4 h-4"})})})]},n.id))})]})]}),e.jsxs("div",{className:"soar-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(M,{className:"w-4 h-4 text-blue-400"})," Recent Executions"]})}),e.jsx("div",{className:"history-list",children:t.map(n=>e.jsxs("div",{className:"history-item",children:[e.jsx("div",{className:"history-status",children:n.status==="success"?e.jsx(W,{className:"w-4 h-4 text-green-400"}):e.jsx(Ue,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{className:"history-info",children:[e.jsx("div",{className:"history-name",children:n.playbook}),e.jsx("div",{className:"history-target",children:n.target})]}),e.jsxs("div",{className:"history-meta",children:[e.jsx("div",{children:n.time}),e.jsx("div",{className:"history-dur",children:n.duration})]})]},n.id))})]})]})}):e.jsx("div",{className:"connectors-view",children:e.jsxs("div",{className:"connectors-grid",children:[j.map(n=>e.jsxs("div",{className:"connector-card",children:[e.jsxs("div",{className:"connector-header",children:[e.jsx("div",{className:"connector-icon",children:n.type==="SIEM"?e.jsx(te,{className:"w-6 h-6"}):n.type==="Firewall"?e.jsx(A,{className:"w-6 h-6"}):e.jsx(Qe,{className:"w-6 h-6"})}),e.jsx("div",{className:`connector-status ${n.status}`})]}),e.jsxs("div",{className:"connector-body",children:[e.jsx("h4",{children:n.name}),e.jsx("div",{className:"connector-type",children:n.type}),e.jsxs("div",{className:"connector-stats",children:[e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Latency"}),e.jsx("span",{className:"mono",children:n.latency})]}),e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Throughput"}),e.jsx("span",{className:"mono",children:n.events})]})]})]}),e.jsx("div",{className:"connector-footer",children:e.jsx("button",{className:"btn-secondary full-width",children:"Configure"})})]},n.id)),e.jsx("div",{className:"connector-card add-new",children:e.jsxs("div",{className:"add-content",children:[e.jsx("div",{className:"add-icon",children:e.jsx(ie,{className:"w-8 h-8"})}),e.jsx("span",{children:"Add Integration"})]})})]})})})]})}const ks=Object.freeze(Object.defineProperty({__proto__:null,default:vs},Symbol.toStringTag,{value:"Module"}));export{fs as A,Cs as D,Ls as F,Ss as S,ws as a,ks as b};
