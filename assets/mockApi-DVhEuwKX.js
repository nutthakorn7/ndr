const l=a=>`${a}.${Math.floor(Math.random()*254)+1}`,n=()=>"XX:XX:XX:XX:XX:XX".replace(/X/g,()=>"0123456789ABCDEF".charAt(Math.floor(Math.random()*16))),u=()=>{const a=[],e=[];a.push({id:"internet",ip:"8.8.8.8",name:"Internet",type:"internet",group:"internet",status:"safe",val:20,details:{os:"N/A",mac:"N/A",openPorts:[],lastSeen:"Now"}}),a.push({id:"firewall-core",ip:"10.0.0.1",name:"Core Firewall",type:"firewall",group:"dmz",status:"safe",val:15,details:{os:"Palo Alto PAN-OS",mac:n(),openPorts:[443,22],lastSeen:"Now"}}),e.push({source:"internet",target:"firewall-core",type:"wired",bandwidth:1e3,active:!0,protocol:"HTTPS"}),[{id:"web-server-01",name:"Web Server",ip:"10.0.1.10"},{id:"mail-server-01",name:"Mail Gateway",ip:"10.0.1.20"},{id:"vpn-gateway",name:"VPN Concentrator",ip:"10.0.1.30"}].forEach(t=>{a.push({id:t.id,ip:t.ip,name:t.name,type:"server",group:"dmz",status:Math.random()>.9?"suspicious":"safe",val:10,details:{os:"Ubuntu Linux 22.04",mac:n(),openPorts:[80,443],lastSeen:"Now"}}),e.push({source:"firewall-core",target:t.id,type:"wired",bandwidth:1e3,active:!0,protocol:"TCP"})}),a.push({id:"router-internal",ip:"10.0.2.1",name:"Internal Router",type:"router",group:"lan",status:"safe",val:12,details:{os:"Cisco IOS",mac:n(),openPorts:[22],lastSeen:"Now"}}),e.push({source:"firewall-core",target:"router-internal",type:"wired",bandwidth:1e3,active:!0,protocol:"OSPF"}),[{id:"db-prod-01",name:"Prod DB",ip:"10.0.3.10"},{id:"app-prod-01",name:"App Server 1",ip:"10.0.3.11"},{id:"app-prod-02",name:"App Server 2",ip:"10.0.3.12"},{id:"ad-dc-01",name:"Domain Controller",ip:"10.0.3.50"}].forEach(t=>{a.push({id:t.id,ip:t.ip,name:t.name,type:"server",group:"servers",status:"safe",val:10,details:{os:"Windows Server 2019",mac:n(),openPorts:[445,3389],lastSeen:"Now"}}),e.push({source:"router-internal",target:t.id,type:"wired",bandwidth:1e3,active:!0,protocol:"TCP"})}),e.push({source:"app-prod-01",target:"db-prod-01",type:"wired",bandwidth:1e3,active:!0,protocol:"SQL"}),e.push({source:"app-prod-02",target:"db-prod-01",type:"wired",bandwidth:1e3,active:!0,protocol:"SQL"});const d=15;for(let t=1;t<=d;t++){const s=Math.random()>.95,p=!s&&Math.random()>.9,o=`pc-${t.toString().padStart(3,"0")}`;if(a.push({id:o,ip:l("10.0.10"),name:`Workstation ${t}`,type:"endpoint",group:"lan",status:s?"compromised":p?"suspicious":"safe",val:5,details:{os:"Windows 11 Pro",mac:n(),openPorts:[135,445],lastSeen:"Now"}}),e.push({source:"router-internal",target:o,type:"wired",bandwidth:100,active:Math.random()>.3,protocol:"HTTPS"}),s){const c=`pc-${Math.floor(Math.random()*d+1).toString().padStart(3,"0")}`;c!==o&&e.push({source:o,target:c,type:"wireless",bandwidth:10,active:!0,protocol:"SMB"})}}return{nodes:a,links:e}},m=[{id:"INC-2023-001",title:"Potential Data Exfiltration to Unknown IP",severity:"Critical",status:"Investigating",assignee:"Alex D.",created_at:new Date(Date.now()-1728e5).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString(),description:"Large volume of encrypted traffic detected leaving the Finance subnet towards an uncategorized external IP address (45.33.22.11). Pattern matches known C2 beaconing behavior.",affected_assets:["10.0.3.15 (Finance-DB)","10.0.3.1 (Gateway)"],related_alerts:12,tags:["Exfiltration","C2","Finance"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-1728e5).toISOString(),content:"Incident created from Alert #4421"},{id:"t2",type:"status_change",user:"Alex D.",timestamp:new Date(Date.now()-15552e4).toISOString(),content:"Status changed to Investigating"},{id:"t3",type:"comment",user:"Alex D.",timestamp:new Date(Date.now()-1296e5).toISOString(),content:"Initial analysis confirms traffic is non-standard SSL. IP reputation check is inconclusive but suspicious."},{id:"t4",type:"comment",user:"Sarah J.",timestamp:new Date(Date.now()-432e5).toISOString(),content:"I saw similar traffic patterns last week on the Engineering subnet. Might be related."}]},{id:"INC-2023-002",title:"Ransomware Behavior Detected on Workstation",severity:"High",status:"New",assignee:null,created_at:new Date(Date.now()-144e5).toISOString(),updated_at:new Date(Date.now()-144e5).toISOString(),description:"Rapid file encryption activities detected on endpoint pc-042. High IOPS and modification of file extensions to .enc.",affected_assets:["pc-042","file-share-01"],related_alerts:5,tags:["Ransomware","Endpoint","Urgent"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-144e5).toISOString(),content:"Incident created from Alert #5502"}]},{id:"INC-2023-003",title:"Suspicious PowerShell Execution",severity:"Medium",status:"Resolved",assignee:"Mike R.",created_at:new Date(Date.now()-432e6).toISOString(),updated_at:new Date(Date.now()-3456e5).toISOString(),description:"Encoded PowerShell command executed on Web Server. Determined to be part of scheduled maintenance script but flagged due to encoding.",affected_assets:["web-server-01"],related_alerts:1,tags:["PowerShell","False Positive"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-432e6).toISOString(),content:"Incident created"},{id:"t2",type:"comment",user:"Mike R.",timestamp:new Date(Date.now()-3888e5).toISOString(),content:"Checked with DevOps team. This is the weekly backup script."},{id:"t3",type:"status_change",user:"Mike R.",timestamp:new Date(Date.now()-3456e5).toISOString(),content:"Status changed to Resolved"}]},{id:"INC-2023-004",title:"Brute Force Attempt via SSH",severity:"Low",status:"New",assignee:null,created_at:new Date(Date.now()-36e5).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString(),description:"Multiple failed login attempts (200+) from external IP 192.168.1.50 against SSH service.",affected_assets:["bastion-host"],related_alerts:1,tags:["Brute Force","SSH"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-36e5).toISOString(),content:"Incident created"}]}];class w{async getTopologyData(){return await new Promise(e=>setTimeout(e,500)),u()}async getIncidents(){return await new Promise(e=>setTimeout(e,300)),m}async createIncident(e){return await new Promise(i=>setTimeout(i,600)),{id:`INC-${new Date().getFullYear()}-${Math.floor(Math.random()*1e3)}`,title:e.title||"New Incident",severity:e.severity||"Medium",status:"New",assignee:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),description:e.description||"",affected_assets:e.affected_assets||[],related_alerts:0,tags:[],timeline:[{id:`t-${Date.now()}`,type:"status_change",user:"System",timestamp:new Date().toISOString(),content:"Incident created"}]}}async updateIncidentStatus(e,r){await new Promise(i=>setTimeout(i,300)),console.log(`Updated incident ${e} to ${r}`)}}const S=new w;export{S as m};
