import{j as e}from"./components-core-5MYStnfc.js";import{r as o,ae as f,af as b,ag as p,ah as D,T as I,S as y,ai as _,v as j,aj as C,C as k,c as v,aa as O,K as P}from"./vendor-icons-BKKSVBBa.js";import"./vendor-react-OvXVS5lI.js";const A=[{id:"INC-2023-001",title:"Potential Data Exfiltration to Unknown IP",severity:"Critical",status:"Investigating",assignee:"Alex D.",created_at:new Date(Date.now()-864e5*2).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString(),description:"Large volume of encrypted traffic detected leaving the Finance subnet towards an uncategorized external IP address (45.33.22.11). Pattern matches known C2 beaconing behavior.",affected_assets:["10.0.3.15 (Finance-DB)","10.0.3.1 (Gateway)"],related_alerts:12,tags:["Exfiltration","C2","Finance"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-864e5*2).toISOString(),content:"Incident created from Alert #4421"},{id:"t2",type:"status_change",user:"Alex D.",timestamp:new Date(Date.now()-864e5*1.8).toISOString(),content:"Status changed to Investigating"},{id:"t3",type:"comment",user:"Alex D.",timestamp:new Date(Date.now()-864e5*1.5).toISOString(),content:"Initial analysis confirms traffic is non-standard SSL. IP reputation check is inconclusive but suspicious."},{id:"t4",type:"comment",user:"Sarah J.",timestamp:new Date(Date.now()-864e5*.5).toISOString(),content:"I saw similar traffic patterns last week on the Engineering subnet. Might be related."}]},{id:"INC-2023-002",title:"Ransomware Behavior Detected on Workstation",severity:"High",status:"New",assignee:null,created_at:new Date(Date.now()-144e5).toISOString(),updated_at:new Date(Date.now()-144e5).toISOString(),description:"Rapid file encryption activities detected on endpoint pc-042. High IOPS and modification of file extensions to .enc.",affected_assets:["pc-042","file-share-01"],related_alerts:5,tags:["Ransomware","Endpoint","Urgent"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-144e5).toISOString(),content:"Incident created from Alert #5502"}]},{id:"INC-2023-003",title:"Suspicious PowerShell Execution",severity:"Medium",status:"Resolved",assignee:"Mike R.",created_at:new Date(Date.now()-864e5*5).toISOString(),updated_at:new Date(Date.now()-864e5*4).toISOString(),description:"Encoded PowerShell command executed on Web Server. Determined to be part of scheduled maintenance script but flagged due to encoding.",affected_assets:["web-server-01"],related_alerts:1,tags:["PowerShell","False Positive"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-864e5*5).toISOString(),content:"Incident created"},{id:"t2",type:"comment",user:"Mike R.",timestamp:new Date(Date.now()-864e5*4.5).toISOString(),content:"Checked with DevOps team. This is the weekly backup script."},{id:"t3",type:"status_change",user:"Mike R.",timestamp:new Date(Date.now()-864e5*4).toISOString(),content:"Status changed to Resolved"}]},{id:"INC-2023-004",title:"Brute Force Attempt via SSH",severity:"Low",status:"New",assignee:null,created_at:new Date(Date.now()-36e5).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString(),description:"Multiple failed login attempts (200+) from external IP 192.168.1.50 against SSH service.",affected_assets:["bastion-host"],related_alerts:1,tags:["Brute Force","SSH"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-36e5).toISOString(),content:"Incident created"}]}];function B(){const[h,x]=o.useState(A),[s,c]=o.useState(null),[r,u]=o.useState(""),[n,m]=o.useState("all"),d=n==="all"?h:h.filter(t=>t.status===n),N={New:d.filter(t=>t.status==="New"),Investigating:d.filter(t=>t.status==="Investigating"),Resolved:d.filter(t=>t.status==="Resolved"),"False Positive":d.filter(t=>t.status==="False Positive")},w=(t,i)=>{x(a=>a.map(l=>{if(l.id===t){const S={id:`t-${Date.now()}`,type:"status_change",user:"You",timestamp:new Date().toISOString(),content:`Status changed from ${l.status} to ${i}`};return{...l,status:i,timeline:[S,...l.timeline]}}return l})),s&&s.id===t&&c(a=>a?{...a,status:i}:null)},g=()=>{if(!s||!r.trim())return;const t={id:`c-${Date.now()}`,type:"comment",user:"You",timestamp:new Date().toISOString(),content:r};x(i=>i.map(a=>a.id===s.id?{...a,timeline:[t,...a.timeline]}:a)),c(i=>i?{...i,timeline:[t,...i.timeline]}:null),u("")};return s?e.jsxs("div",{className:"incident-detail-container",children:[e.jsxs("div",{className:"detail-main",children:[e.jsxs("div",{className:"detail-header-card",children:[e.jsxs("div",{className:"header-top",children:[e.jsxs("div",{children:[e.jsxs("button",{className:"btn-text mb-2 flex items-center gap-1 text-sm text-muted",onClick:()=>c(null),children:[e.jsx(f,{className:"w-4 h-4"})," Back to Board"]}),e.jsx("div",{className:"incident-id",children:s.id}),e.jsx("div",{className:"header-title",children:e.jsx("h2",{children:s.title})})]}),e.jsxs("div",{className:"header-actions",children:[e.jsxs("select",{className:"bg-slate-800 border border-slate-600 rounded px-3 py-1 text-sm",value:s.status,onChange:t=>w(s.id,t.target.value),children:[e.jsx("option",{value:"New",children:"New"}),e.jsx("option",{value:"Investigating",children:"Investigating"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"False Positive",children:"False Positive"})]}),e.jsx("button",{className:"btn-icon",children:e.jsx(b,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"header-meta-grid",children:[e.jsxs("div",{className:"meta-item",children:[e.jsx("label",{children:"Severity"}),e.jsx("div",{children:e.jsx("span",{className:`badge ${s.severity}`,children:s.severity})})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("label",{children:"Assignee"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"w-4 h-4"}),s.assignee||"Unassigned"]})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("label",{children:"Created"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),new Date(s.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"meta-item",children:[e.jsx("label",{children:"Related Alerts"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),s.related_alerts]})]})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsxs("div",{className:"section-title",children:[e.jsx(y,{className:"w-5 h-5"})," Description"]}),e.jsx("p",{className:"text-slate-300 leading-relaxed",children:s.description}),e.jsx("div",{className:"mt-4 flex gap-2",children:s.tags.map(t=>e.jsxs("span",{className:"tag flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"})," ",t]},t))})]}),e.jsxs("div",{className:"detail-section",children:[e.jsxs("div",{className:"section-title",children:[e.jsx(j,{className:"w-5 h-5"})," Affected Assets"]}),e.jsx("div",{className:"assets-list",children:s.affected_assets.map(t=>e.jsxs("div",{className:"asset-item",children:[e.jsx(j,{className:"w-4 h-4 text-blue-400"}),t]},t))})]})]}),e.jsxs("div",{className:"detail-sidebar",children:[e.jsx("div",{className:"sidebar-tabs",children:e.jsx("button",{className:"sidebar-tab active",children:"Timeline & Notes"})}),e.jsx("div",{className:"sidebar-content",children:s.timeline.map(t=>e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:"timeline-icon",children:t.type==="comment"?e.jsx(C,{className:"w-3 h-3"}):t.type==="status_change"?e.jsx(k,{className:"w-3 h-3"}):e.jsx(v,{className:"w-3 h-3"})}),e.jsxs("div",{className:"timeline-content",children:[e.jsxs("div",{className:"timeline-header",children:[e.jsx("span",{className:"timeline-user",children:t.user}),e.jsx("span",{className:"timeline-time",children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"timeline-text",children:t.content})]})]},t.id))}),e.jsxs("div",{className:"comment-input-area",children:[e.jsx("textarea",{className:"comment-input",placeholder:"Add a note...",value:r,onChange:t=>u(t.target.value),onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),g())}}),e.jsx("button",{className:"btn-primary p-2 rounded",onClick:g,disabled:!r.trim(),children:e.jsx(O,{className:"w-4 h-4"})})]})]})]}):e.jsxs("div",{className:"incident-board",children:[e.jsxs("div",{className:"board-header",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Incident Response Board"}),e.jsxs("div",{className:"board-filters",children:[e.jsx("button",{className:`btn-sm ${n==="all"?"btn-primary":"btn-secondary"}`,onClick:()=>m("all"),children:"All"}),e.jsx("button",{className:`btn-sm ${n==="New"?"btn-primary":"btn-secondary"}`,onClick:()=>m("New"),children:"New"}),e.jsx("button",{className:`btn-sm ${n==="Investigating"?"btn-primary":"btn-secondary"}`,onClick:()=>m("Investigating"),children:"Investigating"})]})]}),e.jsxs("button",{className:"btn-primary flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"})," New Incident"]})]}),e.jsx("div",{className:"board-columns",children:Object.entries(N).map(([t,i])=>e.jsxs("div",{className:"board-column",children:[e.jsxs("div",{className:"column-header",children:[e.jsx("span",{children:t}),e.jsx("span",{className:"bg-slate-700 px-2 py-0.5 rounded text-xs",children:i.length})]}),i.map(a=>e.jsxs("div",{className:"incident-card",onClick:()=>c(a),children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:a.title}),e.jsx("span",{className:`badge ${a.severity}`,children:a.severity})]}),e.jsx("div",{className:"text-xs text-muted line-clamp-2",children:a.description}),e.jsxs("div",{className:"card-meta",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"w-3 h-3"})," ",a.assignee||"Unassigned"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-3 h-3"})," ",new Date(a.updated_at).toLocaleDateString()]})]})]},a.id))]},t))})]})}export{B as default};
