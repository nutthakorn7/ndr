import{j as e}from"./components-core-1jZtVtDL.js";import{r as i,S as p,C as E,A as g,g as H,s as $,F as w,c as D,d as M,t as G,u as U,v as Q,w as Z,T as k,G as P,K as V,a as X,b as q,U as A,q as Y,x as O,D as J,y as ee,z as se,O as ae,Z as R,h as te,p as I,P as ie,L as F,B as le,k as ce,j as ne}from"./vendor-icons-CSBxVeM_.js";import{R as N,P as W,b as K,c as _,T as v,L as S,B as C,C as y,X as b,Y as f,d as L,A as re,a as T,e as de,f as oe}from"./vendor-charts-Cu2ZRTpc.js";function he(){const[l,n]=i.useState("suricata"),[r,c]=i.useState([]),[d,h]=i.useState(!0),[x,j]=i.useState(null),[o,m]=i.useState("");i.useEffect(()=>{(async()=>{h(!0);try{await new Promise(u=>setTimeout(u,600)),j({totalRules:15420,activeRules:12850,recentHits:452,lastUpdate:"10m ago"}),c(l==="suricata"?[{id:2010983,name:"ET MALWARE Cobalt Strike Beacon",category:"Malware",severity:"Critical",status:"enabled",hits:124,updated:"2023-11-15"},{id:2025641,name:"ET EXPLOIT Apache Log4j RCE",category:"Exploit",severity:"Critical",status:"enabled",hits:45,updated:"2023-10-01"},{id:2001219,name:"ET SCAN Nmap Scripting Engine",category:"Scan",severity:"Medium",status:"enabled",hits:1250,updated:"2023-09-20"},{id:2014752,name:"ET POLICY Suspicious Inbound to Oracle SQL",category:"Policy",severity:"High",status:"disabled",hits:0,updated:"2023-08-15"},{id:2031450,name:"ET PHISHING Successful Generic Phish",category:"Phishing",severity:"High",status:"enabled",hits:12,updated:"2023-11-20"}]:l==="yara"?[{id:"yara-001",name:"SUSP_PowerShell_Obfuscated",category:"Script",severity:"High",status:"enabled",hits:8,updated:"2023-11-10"},{id:"yara-002",name:"MALW_Ransomware_WannaCry",category:"Ransomware",severity:"Critical",status:"enabled",hits:0,updated:"2023-05-12"},{id:"yara-003",name:"WEBSHELL_PHP_Generic",category:"Webshell",severity:"Critical",status:"enabled",hits:2,updated:"2023-10-05"},{id:"yara-004",name:"APT_Tool_Mimikatz_Memory",category:"Credential Theft",severity:"High",status:"disabled",hits:0,updated:"2023-09-01"}]:[{id:"sigma-001",name:"Suspicious Process Creation via WMI",category:"Execution",severity:"High",status:"enabled",hits:15,updated:"2023-11-18"},{id:"sigma-002",name:"Clear Windows Event Logs",category:"Defense Evasion",severity:"Medium",status:"enabled",hits:3,updated:"2023-10-22"}])}catch(u){console.error("Failed to load detection rules:",u)}finally{h(!1)}})()},[l]);const a=t=>{c(r.map(u=>u.id===t?{...u,status:u.status==="enabled"?"disabled":"enabled"}:u))},s=r.filter(t=>t.name.toLowerCase().includes(o.toLowerCase())||t.category.toLowerCase().includes(o.toLowerCase())||t.id.toString().includes(o));return e.jsxs("div",{className:"advanced-detection",children:[e.jsxs("div",{className:"detection-stats-row",children:[e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:x?.totalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(E,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:x?.activeRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Active Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(g,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:x?.recentHits}),e.jsx("div",{className:"stat-label",children:"Hits (24h)"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(H,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:x?.lastUpdate}),e.jsx("div",{className:"stat-label",children:"Last Update"})]})]})]}),e.jsxs("div",{className:"detection-content",children:[e.jsxs("div",{className:"detection-sidebar",children:[e.jsxs("button",{className:`sidebar-item ${l==="suricata"?"active":""}`,onClick:()=>n("suricata"),children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Suricata IDS"})]}),e.jsxs("button",{className:`sidebar-item ${l==="yara"?"active":""}`,onClick:()=>n("yara"),children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"YARA Rules"})]}),e.jsxs("button",{className:`sidebar-item ${l==="sigma"?"active":""}`,onClick:()=>n("sigma"),children:[e.jsx(p,{className:"w-4 h-4"}),e.jsx("span",{children:"Sigma Rules"})]})]}),e.jsxs("div",{className:"rules-panel",children:[e.jsxs("div",{className:"panel-controls",children:[e.jsxs("div",{className:"search-input",children:[e.jsx(D,{className:"w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search rules by name, ID, or category...",value:o,onChange:t=>m(t.target.value)})]}),e.jsxs("div",{className:"control-actions",children:[e.jsxs("button",{className:"btn-secondary",children:[e.jsx(M,{className:"w-4 h-4"})," Filter"]}),e.jsxs("button",{className:"btn-primary",children:[e.jsx(G,{className:"w-4 h-4"})," Add Rule"]})]})]}),e.jsx("div",{className:"rules-table-container",children:d?e.jsx("div",{className:"loading-state",children:"Loading rules..."}):e.jsxs("table",{className:"rules-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"60px"},children:"Status"}),e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Rule Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Hits"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:s.map(t=>e.jsxs("tr",{className:t.status==="disabled"?"disabled-row":"",children:[e.jsx("td",{children:e.jsx("button",{className:`toggle-btn ${t.status}`,onClick:()=>a(t.id),children:t.status==="enabled"?e.jsx(U,{className:"w-6 h-6 text-green-400"}):e.jsx(Q,{className:"w-6 h-6 text-gray-500"})})}),e.jsx("td",{className:"mono text-gray-400",children:t.id}),e.jsx("td",{className:"rule-name",children:t.name}),e.jsx("td",{children:e.jsx("span",{className:"category-badge",children:t.category})}),e.jsx("td",{children:e.jsx("span",{className:`severity-badge ${t.severity.toLowerCase()}`,children:t.severity})}),e.jsx("td",{className:"mono",children:t.hits.toLocaleString()}),e.jsx("td",{className:"text-gray-500",children:t.updated}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Edit"})})]},t.id))})]})})]})]})]})}const ye=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"})),z=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];function xe(){const[l,n]=i.useState(null),[r,c]=i.useState([]),[d,h]=i.useState([]),[x,j]=i.useState([]),[o,m]=i.useState(!0);return i.useEffect(()=>{(async()=>{m(!0);try{await new Promise(s=>setTimeout(s,700)),n({totalConnections:452890,securePercentage:98.2,expiredCerts:12,weakCiphers:450}),c([{name:"TLS 1.3",value:65},{name:"TLS 1.2",value:30},{name:"TLS 1.1",value:3},{name:"TLS 1.0",value:1},{name:"SSLv3",value:1}]),h([{name:"TLS_AES_128_GCM_SHA256",count:15e4},{name:"TLS_AES_256_GCM_SHA384",count:12e4},{name:"ECDHE-RSA-AES128-GCM-SHA256",count:8e4},{name:"ECDHE-RSA-AES256-GCM-SHA384",count:6e4},{name:"Other",count:42890}]),j([{id:1,subject:"internal-db.corp.local",issuer:"Corp-CA",type:"Self-signed",status:"expired",expiry:"2023-11-01"},{id:2,subject:"legacy-app.corp.local",issuer:"Corp-CA",type:"RSA 1024",status:"weak",expiry:"2024-05-15"},{id:3,subject:"test-env.dev",issuer:"Dev-CA",type:"Self-signed",status:"valid",expiry:"2024-12-20"},{id:4,subject:"payment-gateway.corp",issuer:"DigiCert",type:"RSA 2048",status:"valid",expiry:"2025-01-10"},{id:5,subject:"vpn.corp.net",issuer:"Let's Encrypt",type:"ECDSA",status:"valid",expiry:"2024-02-28"}])}catch(s){console.error("Failed to load SSL analysis:",s)}finally{m(!1)}})()},[]),o?e.jsx("div",{className:"loading-state",children:"Analyzing SSL/TLS traffic..."}):e.jsxs("div",{className:"ssl-analysis",children:[e.jsxs("div",{className:"ssl-stats-row",children:[e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[l?.securePercentage,"%"]}),e.jsx("div",{className:"stat-label",children:"Encrypted Traffic"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(k,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.expiredCerts}),e.jsx("div",{className:"stat-label",children:"Expired Certs"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.weakCiphers}),e.jsx("div",{className:"stat-label",children:"Weak Ciphers"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[(l?.totalConnections/1e3).toFixed(1),"k"]}),e.jsx("div",{className:"stat-label",children:"Total Connections"})]})]})]}),e.jsxs("div",{className:"ssl-content-grid",children:[e.jsxs("div",{className:"ssl-charts-col",children:[e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(V,{className:"w-4 h-4 text-blue-400"})," TLS Version Distribution"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(W,{children:[e.jsx(K,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:r.map((a,s)=>e.jsx(_,{fill:z[s%z.length]},`cell-${s}`))}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(S,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]}),e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(p,{className:"w-4 h-4 text-purple-400"})," Top Cipher Suites"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(C,{data:d,layout:"vertical",margin:{left:40},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(b,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(f,{dataKey:"name",type:"category",width:150,stroke:"#94a3b8",fontSize:10}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(L,{dataKey:"count",fill:"#8b5cf6",radius:[0,4,4,0]})]})})})]})]}),e.jsx("div",{className:"ssl-table-col",children:e.jsxs("div",{className:"ssl-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(w,{className:"w-4 h-4 text-orange-400"})," Certificate Hygiene"]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(H,{className:"w-3 h-3"})," Scan"]})]}),e.jsxs("table",{className:"ssl-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Subject (CN)"}),e.jsx("th",{children:"Issuer"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Expiry"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:x.map(a=>e.jsxs("tr",{children:[e.jsxs("td",{children:[a.status==="valid"&&e.jsx("span",{className:"status-badge success",children:"Valid"}),a.status==="expired"&&e.jsx("span",{className:"status-badge danger",children:"Expired"}),a.status==="weak"&&e.jsx("span",{className:"status-badge warning",children:"Weak"})]}),e.jsx("td",{className:"mono text-white",children:a.subject}),e.jsx("td",{className:"text-gray-400",children:a.issuer}),e.jsx("td",{className:"text-gray-400",children:a.type}),e.jsx("td",{className:"mono text-gray-400",children:a.expiry}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Details"})})]},a.id))})]})]})})]})]})}const be=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"})),B=["#3b82f6","#10b981","#f59e0b","#ef4444"];function me(){const l=[{time:"00:00",critical:2,high:5,medium:12},{time:"04:00",critical:1,high:3,medium:8},{time:"08:00",critical:5,high:12,medium:25},{time:"12:00",critical:8,high:15,medium:35},{time:"16:00",critical:6,high:10,medium:28},{time:"20:00",critical:3,high:7,medium:15},{time:"23:59",critical:4,high:6,medium:18}],n=[{name:"Analyst A",active:5,resolved:12},{name:"Analyst B",active:8,resolved:8},{name:"Analyst C",active:3,resolved:15},{name:"Analyst D",active:6,resolved:10}],r=[{name:"Firewall",value:45},{name:"IDS/IPS",value:25},{name:"Endpoint",value:20},{name:"Email",value:10}];return e.jsxs("div",{className:"soc-dashboard",children:[e.jsxs("div",{className:"soc-header-grid",children:[e.jsxs("div",{className:"soc-stat-card critical",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:"12"}),e.jsx("div",{className:"stat-label",children:"Open Critical Incidents"}),e.jsx("div",{className:"stat-trend down",children:"↓ 2 from last hour"})]})]}),e.jsxs("div",{className:"soc-stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(q,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:"18m"}),e.jsx("div",{className:"stat-label",children:"Mean Time to Respond"}),e.jsx("div",{className:"stat-trend up",children:"↑ 2m vs target"})]})]}),e.jsxs("div",{className:"soc-stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:"4/6"}),e.jsx("div",{className:"stat-label",children:"Analysts Online"}),e.jsx("div",{className:"stat-trend neutral",children:"Shift A"})]})]}),e.jsxs("div",{className:"soc-stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(E,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:"98.5%"}),e.jsx("div",{className:"stat-label",children:"SLA Compliance"}),e.jsx("div",{className:"stat-trend up",children:"↑ 0.5% this week"})]})]})]}),e.jsxs("div",{className:"soc-content-grid",children:[e.jsxs("div",{className:"soc-col-main",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(g,{className:"w-5 h-5 text-blue-400"})," 24h Alert Volume"]})}),e.jsx("div",{className:"chart-container-lg",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(re,{data:l,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorCritical",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorHigh",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(b,{dataKey:"time",stroke:"#94a3b8"}),e.jsx(f,{stroke:"#94a3b8"}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"},itemStyle:{color:"#e2e8f0"}}),e.jsx(S,{}),e.jsx(T,{type:"monotone",dataKey:"critical",stackId:"1",stroke:"#ef4444",fill:"url(#colorCritical)"}),e.jsx(T,{type:"monotone",dataKey:"high",stackId:"1",stroke:"#f59e0b",fill:"url(#colorHigh)"}),e.jsx(T,{type:"monotone",dataKey:"medium",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.1})]})})})]}),e.jsxs("div",{className:"soc-row-split",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-5 h-5 text-purple-400"})," Analyst Workload"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(C,{data:n,layout:"vertical",children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(b,{type:"number",stroke:"#94a3b8"}),e.jsx(f,{dataKey:"name",type:"category",stroke:"#94a3b8",width:80}),e.jsx(v,{cursor:{fill:"rgba(255,255,255,0.05)"},contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(S,{}),e.jsx(L,{dataKey:"active",name:"Active Cases",fill:"#f59e0b",radius:[0,4,4,0]}),e.jsx(L,{dataKey:"resolved",name:"Resolved (Today)",fill:"#10b981",radius:[0,4,4,0]})]})})})]}),e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Y,{className:"w-5 h-5 text-cyan-400"})," Alerts by Source"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(W,{children:[e.jsx(K,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:r.map((c,d)=>e.jsx(_,{fill:B[d%B.length]},`cell-${d}`))}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(S,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]})]}),e.jsxs("div",{className:"soc-col-side",children:[e.jsxs("div",{className:"soc-panel map-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(P,{className:"w-5 h-5 text-green-400"})," Threat Origins"]})}),e.jsxs("div",{className:"world-map-container",children:[e.jsxs("svg",{viewBox:"0 0 900 450",className:"world-map-svg",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("g",{className:"continents",children:[e.jsx("path",{d:`M 120,100 L 140,85 L 155,80 L 165,75 L 180,70 L 195,75 L 210,80 L 220,90 L 225,105 L 230,120 L 228,135 L 220,150 L 210,165 L 200,175 L 185,180 L 170,178 L 155,172 L 145,165 L 135,155 L 128,140 L 125,125 L 122,110 Z
                    M 160,180 L 165,185 L 172,195 L 178,205 L 180,215 L 178,225 L 172,230 L 165,228 L 158,223 L 155,215 L 154,205 L 156,195 L 158,188 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 195,230 L 205,235 L 215,245 L 220,260 L 223,280 L 223,300 L 220,320 L 215,335 L 208,345 L 198,350 L 188,348 L 180,340 L 175,328 L 172,315 L 170,300 L 168,285 L 168,270 L 170,255 L 175,243 L 182,235 L 188,232 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 420,100 L 435,95 L 450,93 L 465,95 L 480,100 L 492,108 L 500,118 L 502,130 L 498,142 L 488,150 L 475,155 L 460,157 L 445,155 L 432,148 L 422,138 L 418,125 L 418,112 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 440,165 L 455,162 L 470,163 L 485,168 L 500,178 L 512,195 L 520,215 L 523,235 L 522,255 L 518,275 L 510,295 L 498,310 L 483,320 L 465,323 L 448,320 L 432,310 L 420,295 L 412,278 L 408,260 L 407,242 L 410,225 L 418,208 L 428,190 L 435,178 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:`M 510,95 L 535,90 L 560,88 L 585,90 L 610,95 L 635,102 L 660,110 L 685,120 L 705,133 L 720,148 L 728,165 L 730,182 L 725,200 L 715,215 L 700,228 L 680,238 L 655,243 L 630,243 L 605,238 L 580,230 L 560,220 L 545,208 L 535,195 L 528,180 L 525,165 L 525,150 L 528,135 L 535,120 L 545,108 L 560,100 L 580,95 L 600,93 Z
                    M 735,145 L 745,150 L 755,158 L 760,168 L 758,178 L 750,183 L 740,180 L 735,172 L 733,162 L 735,152 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 680,290 L 700,288 L 720,290 L 740,295 L 755,303 L 765,315 L 768,328 L 765,340 L 755,348 L 740,352 L 720,353 L 700,350 L 685,343 L 673,333 L 668,320 L 668,308 L 672,298 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 150,390 L 250,385 L 350,387 L 450,390 L 550,388 L 650,390 L 750,392 L 750,410 L 650,415 L 550,413 L 450,415 L 350,413 L 250,415 L 150,413 Z",fill:"#1e40af",opacity:"0.2",stroke:"#3b82f6",strokeWidth:"1"})]}),e.jsxs("g",{className:"threat-indicators",children:[e.jsx("circle",{cx:"165",cy:"130",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"165",cy:"130",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"2s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"2s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"445",cy:"120",r:"4",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"445",cy:"120",r:"8",fill:"none",stroke:"#f59e0b",strokeWidth:"1.5",opacity:"0.5",children:[e.jsx("animate",{attributeName:"r",values:"8;16;8",dur:"3s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.5;0;0.5",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"650",cy:"160",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"1.5s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"650",cy:"160",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"1.5s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"580",cy:"110",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.8s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"455",cy:"240",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"200",cy:"290",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.2s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"720",cy:"320",r:"3",fill:"#10b981",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"600",cy:"195",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.7s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"745",cy:"155",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.3s",repeatCount:"indefinite"})})]}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#1e293b",strokeWidth:"0.5",opacity:"0.2"})}),e.jsxs("linearGradient",{id:"ocean",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#0f172a",stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:"#1e293b",stopOpacity:"0.5"})]})]}),e.jsx("rect",{width:"900",height:"450",fill:"url(#ocean)"}),e.jsx("rect",{width:"900",height:"450",fill:"url(#grid)"})]}),e.jsxs("div",{className:"map-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot critical"}),e.jsx("span",{children:"Critical"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot high"}),e.jsx("span",{children:"High"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot medium"}),e.jsx("span",{children:"Medium"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot low"}),e.jsx("span",{children:"Low"})]})]})]})]}),e.jsxs("div",{className:"soc-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(p,{className:"w-5 h-5 text-red-400"})," Priority Incidents"]})}),e.jsx("div",{className:"incident-list",children:[{id:"INC-2024-001",title:"Ransomware Activity",severity:"critical",assignee:"Analyst A",time:"10m"},{id:"INC-2024-002",title:"Data Exfiltration",severity:"high",assignee:"Analyst B",time:"45m"},{id:"INC-2024-003",title:"Brute Force Attack",severity:"high",assignee:"Unassigned",time:"1h"},{id:"INC-2024-004",title:"Malware Download",severity:"medium",assignee:"Analyst C",time:"2h"}].map((c,d)=>e.jsxs("div",{className:"incident-item",children:[e.jsx("div",{className:`severity-bar ${c.severity}`}),e.jsxs("div",{className:"incident-content",children:[e.jsxs("div",{className:"incident-top",children:[e.jsx("span",{className:"incident-id",children:c.id}),e.jsxs("span",{className:"incident-time",children:[c.time," ago"]})]}),e.jsx("div",{className:"incident-title",children:c.title}),e.jsxs("div",{className:"incident-assignee",children:[e.jsx(A,{className:"w-3 h-3"})," ",c.assignee]})]})]},d))})]})]})]})]})}const fe=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));function je(){const[l,n]=i.useState(null),[r,c]=i.useState([]),[d,h]=i.useState(!0),[x,j]=i.useState("all");i.useEffect(()=>{(async()=>{h(!0);try{await new Promise(t=>setTimeout(t,750)),n({totalFiles:1245,malicious:23,suspicious:45,clean:1177,pending:5}),c([{id:1,name:"invoice_2023.pdf.exe",type:"PE32 Executable",size:"1.2 MB",source:"192.168.1.105",dest:"10.0.0.5",status:"malicious",score:98,detection:"Trojan.Win32.Emotet",time:"10m ago"},{id:2,name:"powershell_script.ps1",type:"Script",size:"15 KB",source:"192.168.1.112",dest:"10.0.0.5",status:"suspicious",score:75,detection:"Obfuscated Script",time:"45m ago"},{id:3,name:"quarterly_report.docx",type:"Document",size:"4.5 MB",source:"192.168.1.200",dest:"10.0.0.5",status:"clean",score:0,detection:"-",time:"1h ago"},{id:4,name:"unknown_binary.bin",type:"Binary",size:"512 KB",source:"192.168.1.15",dest:"External",status:"pending",score:0,detection:"Analyzing...",time:"2m ago"},{id:5,name:"update.zip",type:"Archive",size:"12 MB",source:"External",dest:"192.168.1.50",status:"malicious",score:100,detection:"Ransomware.LockBit",time:"3h ago"}])}catch(t){console.error("Failed to load file analysis:",t)}finally{h(!1)}})()},[]);const o=s=>s.includes("Executable")||s.includes("Binary")?e.jsx(O,{className:"w-4 h-4 text-red-400"}):s.includes("Script")?e.jsx(w,{className:"w-4 h-4 text-yellow-400"}):s.includes("Archive")?e.jsx(ee,{className:"w-4 h-4 text-blue-400"}):e.jsx(se,{className:"w-4 h-4 text-gray-400"}),m=s=>{switch(s){case"malicious":return e.jsx("span",{className:"status-badge danger",children:"Malicious"});case"suspicious":return e.jsx("span",{className:"status-badge warning",children:"Suspicious"});case"clean":return e.jsx("span",{className:"status-badge success",children:"Clean"});case"pending":return e.jsx("span",{className:"status-badge info",children:"Pending"});default:return e.jsx("span",{className:"status-badge",children:"Unknown"})}},a=[{name:"Executables",count:145},{name:"Scripts",count:89},{name:"Documents",count:450},{name:"Archives",count:120},{name:"Images",count:441}];return d?e.jsx("div",{className:"loading-state",children:"Scanning extracted files..."}):e.jsxs("div",{className:"file-analysis",children:[e.jsxs("div",{className:"file-stats-row",children:[e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(w,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.totalFiles}),e.jsx("div",{className:"stat-label",children:"Files Extracted (24h)"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(k,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.malicious}),e.jsx("div",{className:"stat-label",children:"Malicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(g,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.suspicious}),e.jsx("div",{className:"stat-label",children:"Suspicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(p,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.pending}),e.jsx("div",{className:"stat-label",children:"Pending Analysis"})]})]})]}),e.jsxs("div",{className:"file-content-grid",children:[e.jsx("div",{className:"file-left-col",children:e.jsxs("div",{className:"file-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(O,{className:"w-4 h-4 text-blue-400"})," File Types"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(C,{data:a,layout:"vertical",margin:{left:40},children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(b,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(f,{dataKey:"name",type:"category",width:80,stroke:"#94a3b8",fontSize:10}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(L,{dataKey:"count",fill:"#3b82f6",radius:[0,4,4,0],children:a.map((s,t)=>e.jsx(_,{fill:["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#10b981"][t%5]},`cell-${t}`))})]})})})]})}),e.jsx("div",{className:"file-right-col",children:e.jsxs("div",{className:"file-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(g,{className:"w-4 h-4 text-orange-400"})," Recent File Analysis"]}),e.jsxs("div",{className:"panel-actions",children:[e.jsxs("div",{className:"search-input-sm",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("input",{type:"text",placeholder:"Search files..."})]}),e.jsx("button",{className:"btn-icon",children:e.jsx(M,{className:"w-4 h-4"})})]})]}),e.jsxs("table",{className:"file-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"File Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Detection"}),e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:r.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:m(s.status)}),e.jsxs("td",{children:[e.jsxs("div",{className:"file-name-cell",children:[o(s.type),e.jsx("span",{className:"file-name",children:s.name})]}),e.jsxs("div",{className:"file-meta",children:[s.size," • ",s.source]})]}),e.jsx("td",{className:"text-gray-400",children:s.type}),e.jsx("td",{children:e.jsxs("div",{className:`score-badge ${s.score>80?"critical":s.score>50?"high":"low"}`,children:[s.score,"/100"]})}),e.jsx("td",{style:{color:"#fca5a5"},children:s.detection}),e.jsx("td",{className:"text-gray-500",children:s.time}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",title:"Download Sample",children:e.jsx(J,{className:"w-4 h-4"})})})]},s.id))})]})]})})]})]})}const Le=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"}));function ue(){const[l,n]=i.useState(null),[r,c]=i.useState([]),[d,h]=i.useState([]),[x,j]=i.useState(!0);i.useEffect(()=>{(async()=>{j(!0);try{await new Promise(s=>setTimeout(s,650)),n({totalQueries:845290,blockedQueries:1240,dgaDomains:15,tunnelingAlerts:3}),c([{id:1,domain:"x8374.bad-site.com",type:"A",client:"192.168.1.105",status:"blocked",category:"Malware",time:"2s ago"},{id:2,domain:"google.com",type:"A",client:"192.168.1.112",status:"allowed",category:"Search",time:"5s ago"},{id:3,domain:"a.root-servers.net",type:"AAAA",client:"192.168.1.200",status:"allowed",category:"Infrastructure",time:"8s ago"},{id:4,domain:"uwq82.dga-gen.org",type:"TXT",client:"192.168.1.15",status:"flagged",category:"DGA",time:"12s ago"},{id:5,domain:"api.slack.com",type:"CNAME",client:"192.168.1.50",status:"allowed",category:"Business",time:"15s ago"}]),h([{id:1,domain:"tunnel.exfil.io",method:"TXT Records",volume:"45 MB",client:"192.168.1.105",confidence:98,time:"10m ago"},{id:2,domain:"c2.covert.net",method:"Null/Private",volume:"12 KB",client:"192.168.1.15",confidence:85,time:"1h ago"},{id:3,domain:"long-subdomain.bad.com",method:"Long Labels",volume:"2 MB",client:"192.168.1.200",confidence:70,time:"3h ago"}])}catch(s){console.error("Failed to load DNS intelligence:",s)}finally{j(!1)}})()},[]);const o=[{name:"A",count:45e3},{name:"AAAA",count:12e3},{name:"CNAME",count:25e3},{name:"TXT",count:5e3},{name:"MX",count:2e3},{name:"PTR",count:8e3},{name:"SRV",count:1500}],m=[{time:"00:00",qps:120},{time:"04:00",qps:80},{time:"08:00",qps:450},{time:"12:00",qps:600},{time:"16:00",qps:550},{time:"20:00",qps:300},{time:"24:00",qps:150}];return x?e.jsx("div",{className:"loading-state",children:"Analyzing DNS traffic..."}):e.jsxs("div",{className:"dns-intelligence",children:[e.jsxs("div",{className:"dns-stats-row",children:[e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(P,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[(l?.totalQueries/1e3).toFixed(1),"k"]}),e.jsx("div",{className:"stat-label",children:"Total Queries (24h)"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(ae,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.blockedQueries}),e.jsx("div",{className:"stat-label",children:"Blocked Domains"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.dgaDomains}),e.jsx("div",{className:"stat-label",children:"DGA Detected"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-orange-500/10 text-orange-400",children:e.jsx(g,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.tunnelingAlerts}),e.jsx("div",{className:"stat-label",children:"Tunneling Events"})]})]})]}),e.jsxs("div",{className:"dns-content-grid",children:[e.jsxs("div",{className:"dns-left-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(g,{className:"w-4 h-4 text-blue-400"})," DNS Query Volume (QPS)"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(de,{data:m,children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(b,{dataKey:"time",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(f,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(oe,{type:"monotone",dataKey:"qps",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})]}),e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(te,{className:"w-4 h-4 text-purple-400"})," Query Types"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(C,{data:o,children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(b,{dataKey:"name",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(f,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(v,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(L,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})]})]}),e.jsxs("div",{className:"dns-right-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(k,{className:"w-4 h-4 text-red-400"})," DNS Tunneling Detection"]})}),e.jsx("div",{className:"tunnel-list",children:d.map(a=>e.jsxs("div",{className:"tunnel-item",children:[e.jsx("div",{className:"tunnel-icon",children:e.jsx(k,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{className:"tunnel-info",children:[e.jsx("div",{className:"tunnel-domain",children:a.domain}),e.jsxs("div",{className:"tunnel-meta",children:[e.jsx("span",{children:a.method}),e.jsx("span",{children:"•"}),e.jsx("span",{children:a.volume}),e.jsx("span",{children:"•"}),e.jsx("span",{children:a.client})]})]}),e.jsxs("div",{className:"tunnel-confidence",children:[e.jsxs("div",{className:"confidence-val",children:[a.confidence,"%"]}),e.jsx("div",{className:"confidence-lbl",children:"Confidence"})]})]},a.id))})]}),e.jsxs("div",{className:"dns-panel flex-1",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(D,{className:"w-4 h-4 text-green-400"})," Recent Queries"]}),e.jsx("button",{className:"btn-icon",children:e.jsx(M,{className:"w-4 h-4"})})]}),e.jsxs("table",{className:"dns-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Domain"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:r.map(a=>e.jsxs("tr",{children:[e.jsxs("td",{children:[a.status==="blocked"&&e.jsx("span",{className:"status-dot blocked",title:"Blocked"}),a.status==="allowed"&&e.jsx("span",{className:"status-dot allowed",title:"Allowed"}),a.status==="flagged"&&e.jsx("span",{className:"status-dot flagged",title:"Flagged"})]}),e.jsx("td",{className:"mono text-white",children:a.domain}),e.jsx("td",{className:"text-gray-400",children:a.type}),e.jsx("td",{className:"mono text-blue-300",children:a.client}),e.jsx("td",{children:e.jsx("span",{className:"category-tag",children:a.category})}),e.jsx("td",{className:"text-gray-500",children:a.time})]},a.id))})]})]})]})]})]})}const Se=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"}));function Ne({view:l="playbooks"}){const[n,r]=i.useState(l),[c,d]=i.useState([]),[h,x]=i.useState([]),[j,o]=i.useState([]),[m,a]=i.useState(!0);return i.useEffect(()=>{r(l)},[l]),i.useEffect(()=>{(async()=>{a(!0);try{await new Promise(t=>setTimeout(t,800)),d([{id:1,name:"Block Malicious IP (Firewall)",trigger:"Critical Alert",status:"active",runs:145,successRate:98,lastRun:"10m ago"},{id:2,name:"Isolate Host (EDR)",trigger:"Ransomware Detection",status:"active",runs:12,successRate:100,lastRun:"2h ago"},{id:3,name:"Enrich IOCs (VirusTotal)",trigger:"New Artifact",status:"active",runs:1250,successRate:99,lastRun:"1m ago"},{id:4,name:"Reset User Password (AD)",trigger:"Brute Force Success",status:"manual",runs:5,successRate:100,lastRun:"1d ago"},{id:5,name:"Send Slack Notification",trigger:"High Severity",status:"active",runs:450,successRate:100,lastRun:"5m ago"}]),x([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}]),o([{id:101,playbook:"Block Malicious IP",target:"185.22.1.4",status:"success",time:"10m ago",duration:"2s"},{id:102,playbook:"Enrich IOCs",target:"hash: 44d8...2f",status:"success",time:"12m ago",duration:"1.5s"},{id:103,playbook:"Send Slack Notification",target:"#security-ops",status:"success",time:"15m ago",duration:"0.5s"},{id:104,playbook:"Isolate Host",target:"WORKSTATION-04",status:"failed",time:"2h ago",duration:"5s"}])}catch(t){console.error("Failed to load SOAR data:",t)}finally{a(!1)}})()},[]),m?e.jsx("div",{className:"loading-state",children:"Loading automation modules..."}):e.jsxs("div",{className:"soar-integration",children:[e.jsxs("div",{className:"soar-header",children:[e.jsxs("div",{className:"view-selector",children:[e.jsxs("button",{className:`view-btn ${n==="playbooks"?"active":""}`,onClick:()=>r("playbooks"),children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:"Playbooks & Automation"})]}),e.jsxs("button",{className:`view-btn ${n==="connectors"?"active":""}`,onClick:()=>r("connectors"),children:[e.jsx(I,{className:"w-4 h-4"}),e.jsx("span",{children:"SIEM & Connectors"})]})]}),e.jsx("div",{className:"soar-actions",children:e.jsx("button",{className:"btn-primary",children:n==="playbooks"?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4"})," New Playbook"]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4"})," New Connector"]})})})]}),e.jsx("div",{className:"soar-content",children:n==="playbooks"?e.jsx("div",{className:"playbooks-view",children:e.jsxs("div",{className:"soar-grid",children:[e.jsxs("div",{className:"soar-panel flex-2",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(R,{className:"w-4 h-4 text-yellow-400"})," Active Playbooks"]})}),e.jsxs("table",{className:"soar-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Playbook Name"}),e.jsx("th",{children:"Trigger"}),e.jsx("th",{children:"Success Rate"}),e.jsx("th",{children:"Last Run"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:c.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:`status-pill ${s.status}`,children:s.status})}),e.jsx("td",{className:"font-medium text-white",children:s.name}),e.jsx("td",{className:"text-gray-400",children:s.trigger}),e.jsxs("td",{children:[e.jsx("div",{className:"progress-bar-sm",children:e.jsx("div",{className:"progress-fill",style:{width:`${s.successRate}%`,background:s.successRate>90?"#10b981":"#f59e0b"}})}),e.jsxs("span",{className:"text-xs text-gray-400",children:[s.successRate,"%"]})]}),e.jsx("td",{className:"text-gray-500",children:s.lastRun}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",children:e.jsx(le,{className:"w-4 h-4"})})})]},s.id))})]})]}),e.jsxs("div",{className:"soar-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(g,{className:"w-4 h-4 text-blue-400"})," Recent Executions"]})}),e.jsx("div",{className:"history-list",children:j.map(s=>e.jsxs("div",{className:"history-item",children:[e.jsx("div",{className:"history-status",children:s.status==="success"?e.jsx(E,{className:"w-4 h-4 text-green-400"}):e.jsx(ce,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{className:"history-info",children:[e.jsx("div",{className:"history-name",children:s.playbook}),e.jsx("div",{className:"history-target",children:s.target})]}),e.jsxs("div",{className:"history-meta",children:[e.jsx("div",{children:s.time}),e.jsx("div",{className:"history-dur",children:s.duration})]})]},s.id))})]})]})}):e.jsx("div",{className:"connectors-view",children:e.jsxs("div",{className:"connectors-grid",children:[h.map(s=>e.jsxs("div",{className:"connector-card",children:[e.jsxs("div",{className:"connector-header",children:[e.jsx("div",{className:"connector-icon",children:s.type==="SIEM"?e.jsx(I,{className:"w-6 h-6"}):s.type==="Firewall"?e.jsx(p,{className:"w-6 h-6"}):e.jsx(ne,{className:"w-6 h-6"})}),e.jsx("div",{className:`connector-status ${s.status}`})]}),e.jsxs("div",{className:"connector-body",children:[e.jsx("h4",{children:s.name}),e.jsx("div",{className:"connector-type",children:s.type}),e.jsxs("div",{className:"connector-stats",children:[e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Latency"}),e.jsx("span",{className:"mono",children:s.latency})]}),e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Throughput"}),e.jsx("span",{className:"mono",children:s.events})]})]})]}),e.jsx("div",{className:"connector-footer",children:e.jsx("button",{className:"btn-secondary full-width",children:"Configure"})})]},s.id)),e.jsx("div",{className:"connector-card add-new",children:e.jsxs("div",{className:"add-content",children:[e.jsx("div",{className:"add-icon",children:e.jsx(F,{className:"w-8 h-8"})}),e.jsx("span",{children:"Add Integration"})]})})]})})})]})}const we=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"}));export{ye as A,Se as D,Le as F,be as S,fe as a,we as b};
