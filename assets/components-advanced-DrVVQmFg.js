import{j as s}from"./components-core-CnaLEL4G.js";import{r as c,S as C,C as B,A,b as W,x as es,F as I,y as as,d as ts,e as K,z as J,B as is,J as ls,K as ns,O as cs,T as O,G as U,Q as rs,a as ds,c as os,U as H,w as hs,V as G,D as ms,Y as xs,_ as us,$ as js,Z as $,k as Ns,v as V,P as ps,L as Z,a0 as vs,o as gs,n as ys}from"./vendor-icons-BDNhdNL_.js";import{a as y}from"./components-dashboard-CBHl15UI.js";import{R as L,P as q,k as ss,l as Q,T as S,L as P,B as F,C as R,X as _,Y as D,a as M,A as fs,j as z,n as bs,p as Ls}from"./vendor-charts-D7ahKQGc.js";import{m as Ss,a as ws,b as ks,c as Cs,d as As,e as Rs,f as _s,g as Ds}from"./components-features-Dj1NPK2A.js";function Es(){const[l,o]=c.useState("suricata"),[j,N]=c.useState([]),[f,g]=c.useState(!0),[x,p]=c.useState(null),[d,a]=c.useState(""),[t,v]=c.useState(""),[e,r]=c.useState(!1),m=i=>{if(typeof i=="number")return i>=1&&i<=3?"Critical":i===4?"High":i===5?"Medium":"Low";switch(String(i).toLowerCase()){case"critical":return"Critical";case"high":return"High";case"medium":return"Medium";case"low":return"Low";default:return"Informational"}},u=i=>{if(!i)return"N/A";try{return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return i}};c.useEffect(()=>{(async()=>{g(!0);try{if(l==="editor"){const k=await y.getSuricataRules();v(k.rules||""),g(!1);return}const[b,T]=await Promise.all([y.getDetectionRules(),y.getDetectionStats().catch(()=>null)]);if(b&&Array.isArray(b)){const k=b.filter(h=>l==="suricata"?h.type==="suricata"||h.type==="ids":l==="yara"?h.type==="yara":l==="sigma"?h.type==="sigma":!0).map(h=>({id:h.id||h.sid,name:h.name||h.msg,category:h.category||"Unclassified",severity:m(h.severity||h.priority),status:h.enabled?"enabled":"disabled",hits:h.hit_count||0,updated:u(h.updated_at||h.last_modified)}));N(k),p(T?{totalRules:T.total_rules||k.length,activeRules:T.active_rules||k.filter(h=>h.status==="enabled").length,recentHits:T.recent_hits||0,lastUpdate:T.last_update||"10m ago"}:{totalRules:k.length,activeRules:k.filter(h=>h.status==="enabled").length,recentHits:0,lastUpdate:"Just now"})}else throw new Error("Invalid rules response")}catch(b){console.warn("Failed to load detection rules from API, using mock data:",b),p({totalRules:15420,activeRules:12850,recentHits:452,lastUpdate:"10m ago"}),N(l==="suricata"?[{id:2010983,name:"ET MALWARE Cobalt Strike Beacon",category:"Malware",severity:"Critical",status:"enabled",hits:124,updated:"2023-11-15"},{id:2025641,name:"ET EXPLOIT Apache Log4j RCE",category:"Exploit",severity:"Critical",status:"enabled",hits:45,updated:"2023-10-01"},{id:2001219,name:"ET SCAN Nmap Scripting Engine",category:"Scan",severity:"Medium",status:"enabled",hits:1250,updated:"2023-09-20"},{id:2014752,name:"ET POLICY Suspicious Inbound to Oracle SQL",category:"Policy",severity:"High",status:"disabled",hits:0,updated:"2023-08-15"},{id:2031450,name:"ET PHISHING Successful Generic Phish",category:"Phishing",severity:"High",status:"enabled",hits:12,updated:"2023-11-20"}]:l==="yara"?[{id:"yara-001",name:"SUSP_PowerShell_Obfuscated",category:"Script",severity:"High",status:"enabled",hits:8,updated:"2023-11-10"},{id:"yara-002",name:"MALW_Ransomware_WannaCry",category:"Ransomware",severity:"Critical",status:"enabled",hits:0,updated:"2023-05-12"},{id:"yara-003",name:"WEBSHELL_PHP_Generic",category:"Webshell",severity:"Critical",status:"enabled",hits:2,updated:"2023-10-05"},{id:"yara-004",name:"APT_Tool_Mimikatz_Memory",category:"Credential Theft",severity:"High",status:"disabled",hits:0,updated:"2023-09-01"}]:[{id:"sigma-001",name:"Suspicious Process Creation via WMI",category:"Execution",severity:"High",status:"enabled",hits:15,updated:"2023-11-18"},{id:"sigma-002",name:"Clear Windows Event Logs",category:"Defense Evasion",severity:"Medium",status:"enabled",hits:3,updated:"2023-10-22"}])}finally{g(!1)}})()},[l]);const n=async()=>{r(!0);try{await y.updateSuricataRules(t)}catch(i){console.error("Failed to save rules:",i)}finally{r(!1)}},w=i=>{N(j.map(b=>b.id===i?{...b,status:b.status==="enabled"?"disabled":"enabled"}:b))},E=j.filter(i=>i.name.toLowerCase().includes(d.toLowerCase())||i.category.toLowerCase().includes(d.toLowerCase())||i.id.toString().includes(d));return s.jsxs("div",{className:"advanced-detection",children:[s.jsxs("div",{className:"detection-stats-row",children:[s.jsxs("div",{className:"detection-stat-card",children:[s.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:s.jsx(C,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:x?.totalRules.toLocaleString()}),s.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),s.jsxs("div",{className:"detection-stat-card",children:[s.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:s.jsx(B,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:x?.activeRules.toLocaleString()}),s.jsx("div",{className:"stat-label",children:"Active Rules"})]})]}),s.jsxs("div",{className:"detection-stat-card",children:[s.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:s.jsx(A,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:x?.recentHits}),s.jsx("div",{className:"stat-label",children:"Hits (24h)"})]})]}),s.jsxs("div",{className:"detection-stat-card",children:[s.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:s.jsx(W,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:x?.lastUpdate}),s.jsx("div",{className:"stat-label",children:"Last Update"})]})]})]}),s.jsxs("div",{className:"detection-content",children:[s.jsxs("div",{className:"detection-sidebar",children:[s.jsxs("button",{className:`sidebar-item ${l==="suricata"?"active":""}`,onClick:()=>o("suricata"),children:[s.jsx(es,{className:"w-4 h-4"}),s.jsx("span",{children:"Suricata IDS"})]}),s.jsxs("button",{className:`sidebar-item ${l==="yara"?"active":""}`,onClick:()=>o("yara"),children:[s.jsx(I,{className:"w-4 h-4"}),s.jsx("span",{children:"YARA Rules"})]}),s.jsxs("button",{className:`sidebar-item ${l==="sigma"?"active":""}`,onClick:()=>o("sigma"),children:[s.jsx(C,{className:"w-4 h-4"}),s.jsx("span",{children:"Sigma Rules"})]}),s.jsxs("button",{className:`sidebar-item ${l==="editor"?"active":""}`,onClick:()=>o("editor"),children:[s.jsx(as,{className:"w-4 h-4"}),s.jsx("span",{children:"Rule Editor"})]})]}),s.jsx("div",{className:"rules-panel",children:l==="editor"?s.jsxs("div",{className:"rule-editor-container",children:[s.jsxs("div",{className:"panel-controls",children:[s.jsx("h3",{children:"Suricata Rules File (suricata.rules)"}),s.jsx("div",{className:"control-actions",children:s.jsxs("button",{className:"btn-primary",onClick:n,disabled:e,children:[e?s.jsx(W,{className:"w-4 h-4 animate-spin"}):s.jsx(ts,{className:"w-4 h-4"}),e?"Saving...":"Save Rules"]})})]}),s.jsx("textarea",{className:"rule-editor-textarea",value:t,onChange:i=>v(i.target.value),spellCheck:"false"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"panel-controls",children:[s.jsxs("div",{className:"search-input",children:[s.jsx(K,{className:"w-4 h-4"}),s.jsx("input",{type:"text",placeholder:"Search rules by name, ID, or category...",value:d,onChange:i=>a(i.target.value)})]}),s.jsxs("div",{className:"control-actions",children:[s.jsxs("button",{className:"btn-secondary",children:[s.jsx(J,{className:"w-4 h-4"})," Filter"]}),s.jsxs("button",{className:"btn-primary",children:[s.jsx(is,{className:"w-4 h-4"})," Add Rule"]})]})]}),s.jsx("div",{className:"rules-table-container",children:f?s.jsx("div",{className:"loading-state",children:"Loading rules..."}):s.jsxs("table",{className:"rules-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"60px"},children:"Status"}),s.jsx("th",{children:"ID"}),s.jsx("th",{children:"Rule Name"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Severity"}),s.jsx("th",{children:"Hits"}),s.jsx("th",{children:"Updated"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:E.map(i=>s.jsxs("tr",{className:i.status==="disabled"?"disabled-row":"",children:[s.jsx("td",{children:s.jsx("button",{className:`toggle-btn ${i.status}`,onClick:()=>w(i.id),children:i.status==="enabled"?s.jsx(ls,{className:"w-6 h-6 text-green-400"}):s.jsx(ns,{className:"w-6 h-6 text-gray-500"})})}),s.jsx("td",{className:"mono text-gray-400",children:i.id}),s.jsx("td",{className:"rule-name",children:i.name}),s.jsx("td",{children:s.jsx("span",{className:"category-badge",children:i.category})}),s.jsx("td",{children:s.jsx("span",{className:`severity-badge ${i.severity.toLowerCase()}`,children:i.severity})}),s.jsx("td",{className:"mono",children:i.hits.toLocaleString()}),s.jsx("td",{className:"text-gray-500",children:i.updated}),s.jsx("td",{children:s.jsx("button",{className:"btn-xs",children:"Edit"})})]},i.id))})]})})]})})]})]})}const Bs=Object.freeze(Object.defineProperty({__proto__:null,default:Es},Symbol.toStringTag,{value:"Module"})),Y=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];function Ts(){const[l,o]=c.useState(null),[j,N]=c.useState([]),[f,g]=c.useState([]),[x,p]=c.useState([]),[d,a]=c.useState(!0),t=e=>e.is_expired?"expired":e.is_weak_key?"weak":e.is_valid?"valid":"unknown",v=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A";return c.useEffect(()=>{(async()=>{a(!0);try{const r=await y.getSSLStats();let m=null;try{const u=await y.getSensors({limit:1});if(u&&u.sensors&&u.sensors.length>0){const n=u.sensors[0].id;m=await y.getSensorCertificates(n)}}catch(u){console.warn("Could not fetch certificate data:",u)}if(r||m){if(o({totalConnections:r?.total_connections||0,securePercentage:r?.secure_percentage||0,expiredCerts:r?.expiring_soon||m?.expired_count||0,weakCiphers:r?.weak_ciphers||0}),m&&m.certificates){const u=m.certificates.map((n,w)=>({id:n.id||w+1,subject:n.subject||n.common_name||"Unknown",issuer:n.issuer||"Unknown",type:n.key_type||"RSA 2048",status:t(n),expiry:v(n.not_after||n.expiry)}));p(u)}throw new Error("Using mock data for TLS versions and ciphers")}else throw new Error("No SSL data available")}catch(r){console.warn("Failed to load SSL analysis from API, using mock data:",r),o({totalConnections:452890,securePercentage:98.2,expiredCerts:12,weakCiphers:450}),N([{name:"TLS 1.3",value:65},{name:"TLS 1.2",value:30},{name:"TLS 1.1",value:3},{name:"TLS 1.0",value:1},{name:"SSLv3",value:1}]),g([{name:"TLS_AES_128_GCM_SHA256",count:15e4},{name:"TLS_AES_256_GCM_SHA384",count:12e4},{name:"ECDHE-RSA-AES128-GCM-SHA256",count:8e4},{name:"ECDHE-RSA-AES256-GCM-SHA384",count:6e4},{name:"Other",count:42890}]),p([{id:1,subject:"internal-db.corp.local",issuer:"Corp-CA",type:"Self-signed",status:"expired",expiry:"2023-11-01"},{id:2,subject:"legacy-app.corp.local",issuer:"Corp-CA",type:"RSA 1024",status:"weak",expiry:"2024-05-15"},{id:3,subject:"test-env.dev",issuer:"Dev-CA",type:"Self-signed",status:"valid",expiry:"2024-12-20"},{id:4,subject:"payment-gateway.corp",issuer:"DigiCert",type:"RSA 2048",status:"valid",expiry:"2025-01-10"},{id:5,subject:"vpn.corp.net",issuer:"Let's Encrypt",type:"ECDSA",status:"valid",expiry:"2024-02-28"}])}finally{a(!1)}})()},[]),d?s.jsx("div",{className:"loading-state",children:"Analyzing SSL/TLS traffic..."}):s.jsxs("div",{className:"ssl-analysis",children:[s.jsxs("div",{className:"ssl-stats-row",children:[s.jsxs("div",{className:"ssl-stat-card",children:[s.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:s.jsx(cs,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsxs("div",{className:"stat-value",children:[l?.securePercentage,"%"]}),s.jsx("div",{className:"stat-label",children:"Encrypted Traffic"})]})]}),s.jsxs("div",{className:"ssl-stat-card",children:[s.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:s.jsx(O,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.expiredCerts}),s.jsx("div",{className:"stat-label",children:"Expired Certs"})]})]}),s.jsxs("div",{className:"ssl-stat-card",children:[s.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:s.jsx(C,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.weakCiphers}),s.jsx("div",{className:"stat-label",children:"Weak Ciphers"})]})]}),s.jsxs("div",{className:"ssl-stat-card",children:[s.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:s.jsx(U,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsxs("div",{className:"stat-value",children:[l?.totalConnections?(l.totalConnections/1e3).toFixed(1):0,"k"]}),s.jsx("div",{className:"stat-label",children:"Total Connections"})]})]})]}),s.jsxs("div",{className:"ssl-content-grid",children:[s.jsxs("div",{className:"ssl-charts-col",children:[s.jsxs("div",{className:"ssl-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(rs,{className:"w-4 h-4 text-blue-400"})," TLS Version Distribution"]})}),s.jsx("div",{className:"chart-container",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(q,{children:[s.jsx(ss,{data:j,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:j.map((e,r)=>s.jsx(Q,{fill:Y[r%Y.length]},`cell-${r}`))}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),s.jsx(P,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]}),s.jsxs("div",{className:"ssl-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(C,{className:"w-4 h-4 text-purple-400"})," Top Cipher Suites"]})}),s.jsx("div",{className:"chart-container",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(F,{data:f,layout:"vertical",margin:{left:40},children:[s.jsx(R,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),s.jsx(_,{type:"number",stroke:"#94a3b8",fontSize:10}),s.jsx(D,{dataKey:"name",type:"category",width:150,stroke:"#94a3b8",fontSize:10}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),s.jsx(M,{dataKey:"count",fill:"#8b5cf6",radius:[0,4,4,0]})]})})})]})]}),s.jsx("div",{className:"ssl-table-col",children:s.jsxs("div",{className:"ssl-panel full-height",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h3",{children:[s.jsx(I,{className:"w-4 h-4 text-orange-400"})," Certificate Hygiene"]}),s.jsxs("button",{className:"btn-secondary",children:[s.jsx(W,{className:"w-3 h-3"})," Scan"]})]}),s.jsxs("table",{className:"ssl-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Subject (CN)"}),s.jsx("th",{children:"Issuer"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Expiry"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:x.map(e=>s.jsxs("tr",{children:[s.jsxs("td",{children:[e.status==="valid"&&s.jsx("span",{className:"status-badge success",children:"Valid"}),e.status==="expired"&&s.jsx("span",{className:"status-badge danger",children:"Expired"}),e.status==="weak"&&s.jsx("span",{className:"status-badge warning",children:"Weak"})]}),s.jsx("td",{className:"mono text-white",children:e.subject}),s.jsx("td",{className:"text-gray-400",children:e.issuer}),s.jsx("td",{className:"text-gray-400",children:e.type}),s.jsx("td",{className:"mono text-gray-400",children:e.expiry}),s.jsx("td",{children:s.jsx("button",{className:"btn-xs",children:"Details"})})]},e.id))})]})]})})]})]})}const Ks=Object.freeze(Object.defineProperty({__proto__:null,default:Ts},Symbol.toStringTag,{value:"Module"})),X=["#3b82f6","#10b981","#f59e0b","#ef4444"];function Ms(){const[l,o]=c.useState({openCritical:12,mttr:"18m",analystsOnline:"4/6",slaCompliance:98.5}),[j,N]=c.useState([]),[f,g]=c.useState([]),[x,p]=c.useState([]);return c.useEffect(()=>{(async()=>{try{const a=await y.getSocMetrics(),t=await y.getDashboardStats();throw a||t?(o({openCritical:a?.open_critical||t?.summary?.critical_alerts||12,mttr:a?.mean_time_to_respond||"18m",analystsOnline:a?.analysts_online||"4/6",slaCompliance:a?.sla_compliance||98.5}),new Error("Using mock chart data")):new Error("No SOC data available")}catch(a){console.warn("Failed to load SOC metrics from API, using mock data:",a),N(Ss),g(ws),p(ks)}finally{}})()},[]),s.jsxs("div",{className:"soc-dashboard",children:[s.jsxs("div",{className:"soc-header-grid",children:[s.jsxs("div",{className:"soc-stat-card critical",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(ds,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l.openCritical}),s.jsx("div",{className:"stat-label",children:"Open Critical Incidents"}),s.jsx("div",{className:"stat-trend down",children:"↓ 2 from last hour"})]})]}),s.jsxs("div",{className:"soc-stat-card warning",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(os,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l.mttr}),s.jsx("div",{className:"stat-label",children:"Mean Time to Respond"}),s.jsx("div",{className:"stat-trend up",children:"↑ 2m vs target"})]})]}),s.jsxs("div",{className:"soc-stat-card info",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(H,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l.analystsOnline}),s.jsx("div",{className:"stat-label",children:"Analysts Online"}),s.jsx("div",{className:"stat-trend neutral",children:"Shift A"})]})]}),s.jsxs("div",{className:"soc-stat-card success",children:[s.jsx("div",{className:"stat-icon",children:s.jsx(B,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsxs("div",{className:"stat-value",children:[l.slaCompliance,"%"]}),s.jsx("div",{className:"stat-label",children:"SLA Compliance"}),s.jsx("div",{className:"stat-trend up",children:"↑ 0.5% this week"})]})]})]}),s.jsxs("div",{className:"soc-content-grid",children:[s.jsxs("div",{className:"soc-col-main",children:[s.jsxs("div",{className:"soc-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(A,{className:"w-5 h-5 text-blue-400"})," 24h Alert Volume"]})}),s.jsx("div",{className:"chart-container-lg",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(fs,{data:j,children:[s.jsxs("defs",{children:[s.jsxs("linearGradient",{id:"colorCritical",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),s.jsxs("linearGradient",{id:"colorHigh",x1:"0",y1:"0",x2:"0",y2:"1",children:[s.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),s.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),s.jsx(R,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),s.jsx(_,{dataKey:"time",stroke:"#94a3b8"}),s.jsx(D,{stroke:"#94a3b8"}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"},itemStyle:{color:"#e2e8f0"}}),s.jsx(P,{}),s.jsx(z,{type:"monotone",dataKey:"critical",stackId:"1",stroke:"#ef4444",fill:"url(#colorCritical)"}),s.jsx(z,{type:"monotone",dataKey:"high",stackId:"1",stroke:"#f59e0b",fill:"url(#colorHigh)"}),s.jsx(z,{type:"monotone",dataKey:"medium",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.1})]})})})]}),s.jsxs("div",{className:"soc-row-split",children:[s.jsxs("div",{className:"soc-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(H,{className:"w-5 h-5 text-purple-400"})," Analyst Workload"]})}),s.jsx("div",{className:"chart-container-sm",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(F,{data:f,layout:"vertical",children:[s.jsx(R,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),s.jsx(_,{type:"number",stroke:"#94a3b8"}),s.jsx(D,{dataKey:"name",type:"category",stroke:"#94a3b8",width:80}),s.jsx(S,{cursor:{fill:"rgba(255,255,255,0.05)"},contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),s.jsx(P,{}),s.jsx(M,{dataKey:"active",name:"Active Cases",fill:"#f59e0b",radius:[0,4,4,0]}),s.jsx(M,{dataKey:"resolved",name:"Resolved (Today)",fill:"#10b981",radius:[0,4,4,0]})]})})})]}),s.jsxs("div",{className:"soc-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(hs,{className:"w-5 h-5 text-cyan-400"})," Alerts by Source"]})}),s.jsx("div",{className:"chart-container-sm",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(q,{children:[s.jsx(ss,{data:x,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:x.map((d,a)=>s.jsx(Q,{fill:X[a%X.length]},`cell-${a}`))}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),s.jsx(P,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]})]}),s.jsxs("div",{className:"soc-col-side",children:[s.jsxs("div",{className:"soc-panel map-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(U,{className:"w-5 h-5 text-green-400"})," Threat Origins"]})}),s.jsxs("div",{className:"world-map-container",children:[s.jsxs("svg",{viewBox:"0 0 900 450",className:"world-map-svg",preserveAspectRatio:"xMidYMid meet",children:[s.jsxs("g",{className:"continents",children:[s.jsx("path",{d:`M 120,100 L 140,85 L 155,80 L 165,75 L 180,70 L 195,75 L 210,80 L 220,90 L 225,105 L 230,120 L 228,135 L 220,150 L 210,165 L 200,175 L 185,180 L 170,178 L 155,172 L 145,165 L 135,155 L 128,140 L 125,125 L 122,110 Z
                    M 160,180 L 165,185 L 172,195 L 178,205 L 180,215 L 178,225 L 172,230 L 165,228 L 158,223 L 155,215 L 154,205 L 156,195 L 158,188 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),s.jsx("path",{d:"M 195,230 L 205,235 L 215,245 L 220,260 L 223,280 L 223,300 L 220,320 L 215,335 L 208,345 L 198,350 L 188,348 L 180,340 L 175,328 L 172,315 L 170,300 L 168,285 L 168,270 L 170,255 L 175,243 L 182,235 L 188,232 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),s.jsx("path",{d:"M 420,100 L 435,95 L 450,93 L 465,95 L 480,100 L 492,108 L 500,118 L 502,130 L 498,142 L 488,150 L 475,155 L 460,157 L 445,155 L 432,148 L 422,138 L 418,125 L 418,112 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),s.jsx("path",{d:"M 440,165 L 455,162 L 470,163 L 485,168 L 500,178 L 512,195 L 520,215 L 523,235 L 522,255 L 518,275 L 510,295 L 498,310 L 483,320 L 465,323 L 448,320 L 432,310 L 420,295 L 412,278 L 408,260 L 407,242 L 410,225 L 418,208 L 428,190 L 435,178 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),s.jsx("path",{d:`M 510,95 L 535,90 L 560,88 L 585,90 L 610,95 L 635,102 L 660,110 L 685,120 L 705,133 L 720,148 L 728,165 L 730,182 L 725,200 L 715,215 L 700,228 L 680,238 L 655,243 L 630,243 L 605,238 L 580,230 L 560,220 L 545,208 L 535,195 L 528,180 L 525,165 L 525,150 L 528,135 L 535,120 L 545,108 L 560,100 L 580,95 L 600,93 Z
                    M 735,145 L 745,150 L 755,158 L 760,168 L 758,178 L 750,183 L 740,180 L 735,172 L 733,162 L 735,152 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),s.jsx("path",{d:"M 680,290 L 700,288 L 720,290 L 740,295 L 755,303 L 765,315 L 768,328 L 765,340 L 755,348 L 740,352 L 720,353 L 700,350 L 685,343 L 673,333 L 668,320 L 668,308 L 672,298 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),s.jsx("path",{d:"M 150,390 L 250,385 L 350,387 L 450,390 L 550,388 L 650,390 L 750,392 L 750,410 L 650,415 L 550,413 L 450,415 L 350,413 L 250,415 L 150,413 Z",fill:"#1e40af",opacity:"0.2",stroke:"#3b82f6",strokeWidth:"1"})]}),s.jsxs("g",{className:"threat-indicators",children:[s.jsx("circle",{cx:"165",cy:"130",r:"5",fill:"#ef4444",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2s",repeatCount:"indefinite"})}),s.jsxs("circle",{cx:"165",cy:"130",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[s.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"2s",repeatCount:"indefinite"}),s.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"2s",repeatCount:"indefinite"})]}),s.jsx("circle",{cx:"445",cy:"120",r:"4",fill:"#f59e0b",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3s",repeatCount:"indefinite"})}),s.jsxs("circle",{cx:"445",cy:"120",r:"8",fill:"none",stroke:"#f59e0b",strokeWidth:"1.5",opacity:"0.5",children:[s.jsx("animate",{attributeName:"r",values:"8;16;8",dur:"3s",repeatCount:"indefinite"}),s.jsx("animate",{attributeName:"opacity",values:"0.5;0;0.5",dur:"3s",repeatCount:"indefinite"})]}),s.jsx("circle",{cx:"650",cy:"160",r:"5",fill:"#ef4444",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"1.5s",repeatCount:"indefinite"})}),s.jsxs("circle",{cx:"650",cy:"160",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[s.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"1.5s",repeatCount:"indefinite"}),s.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"1.5s",repeatCount:"indefinite"})]}),s.jsx("circle",{cx:"580",cy:"110",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.8s",repeatCount:"indefinite"})}),s.jsx("circle",{cx:"455",cy:"240",r:"3",fill:"#3b82f6",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.5s",repeatCount:"indefinite"})}),s.jsx("circle",{cx:"200",cy:"290",r:"3",fill:"#3b82f6",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.2s",repeatCount:"indefinite"})}),s.jsx("circle",{cx:"720",cy:"320",r:"3",fill:"#10b981",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.5s",repeatCount:"indefinite"})}),s.jsx("circle",{cx:"600",cy:"195",r:"3",fill:"#3b82f6",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.7s",repeatCount:"indefinite"})}),s.jsx("circle",{cx:"745",cy:"155",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:s.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.3s",repeatCount:"indefinite"})})]}),s.jsxs("defs",{children:[s.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:s.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#1e293b",strokeWidth:"0.5",opacity:"0.2"})}),s.jsxs("linearGradient",{id:"ocean",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[s.jsx("stop",{offset:"0%",stopColor:"#0f172a",stopOpacity:"1"}),s.jsx("stop",{offset:"100%",stopColor:"#1e293b",stopOpacity:"0.5"})]})]}),s.jsx("rect",{width:"900",height:"450",fill:"url(#ocean)"}),s.jsx("rect",{width:"900",height:"450",fill:"url(#grid)"})]}),s.jsxs("div",{className:"map-legend",children:[s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot critical"}),s.jsx("span",{children:"Critical"})]}),s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot high"}),s.jsx("span",{children:"High"})]}),s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot medium"}),s.jsx("span",{children:"Medium"})]}),s.jsxs("div",{className:"legend-item",children:[s.jsx("span",{className:"legend-dot low"}),s.jsx("span",{children:"Low"})]})]})]})]}),s.jsxs("div",{className:"soc-panel flex-1",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(C,{className:"w-5 h-5 text-red-400"})," Priority Incidents"]})}),s.jsx("div",{className:"incident-list",children:[{id:"INC-2024-001",title:"Ransomware Activity",severity:"critical",assignee:"Analyst A",time:"10m"},{id:"INC-2024-002",title:"Data Exfiltration",severity:"high",assignee:"Analyst B",time:"45m"},{id:"INC-2024-003",title:"Brute Force Attack",severity:"high",assignee:"Unassigned",time:"1h"},{id:"INC-2024-004",title:"Malware Download",severity:"medium",assignee:"Analyst C",time:"2h"}].map((d,a)=>s.jsxs("div",{className:"incident-item",children:[s.jsx("div",{className:`severity-bar ${d.severity}`}),s.jsxs("div",{className:"incident-content",children:[s.jsxs("div",{className:"incident-top",children:[s.jsx("span",{className:"incident-id",children:d.id}),s.jsxs("span",{className:"incident-time",children:[d.time," ago"]})]}),s.jsx("div",{className:"incident-title",children:d.title}),s.jsxs("div",{className:"incident-assignee",children:[s.jsx(H,{className:"w-3 h-3"})," ",d.assignee]})]})]},a))})]})]})]})]})}const Us=Object.freeze(Object.defineProperty({__proto__:null,default:Ms},Symbol.toStringTag,{value:"Module"}));function Ps(){const[l,o]=c.useState(null),[j,N]=c.useState([]),[f,g]=c.useState(!0);c.useEffect(()=>{(async()=>{g(!0);try{const t=await y.getFileStats();throw t?(o({totalFiles:t.total_files||0,malicious:t.malicious_count||0,suspicious:t.suspicious_count||0,clean:t.clean_count||0,pending:t.pending_count||0}),new Error("Using mock file list data")):new Error("No file stats available")}catch(t){console.warn("Failed to load file analysis from API, using mock data:",t),o({totalFiles:1245,malicious:23,suspicious:45,clean:1177,pending:5}),N([{id:1,name:"invoice_2023.pdf.exe",type:"PE32 Executable",size:"1.2 MB",source:"192.168.1.105",dest:"10.0.0.5",status:"malicious",score:98,detection:"Trojan.Win32.Emotet",time:"10m ago"},{id:2,name:"powershell_script.ps1",type:"Script",size:"15 KB",source:"192.168.1.112",dest:"10.0.0.5",status:"suspicious",score:75,detection:"Obfuscated Script",time:"45m ago"},{id:3,name:"quarterly_report.docx",type:"Document",size:"4.5 MB",source:"192.168.1.200",dest:"10.0.0.5",status:"clean",score:0,detection:"-",time:"1h ago"},{id:4,name:"unknown_binary.bin",type:"Binary",size:"512 KB",source:"192.168.1.15",dest:"External",status:"pending",score:0,detection:"Analyzing...",time:"2m ago"},{id:5,name:"update.zip",type:"Archive",size:"12 MB",source:"External",dest:"192.168.1.50",status:"malicious",score:100,detection:"Ransomware.LockBit",time:"3h ago"}])}finally{g(!1)}})()},[]);const x=a=>a.includes("Executable")||a.includes("Binary")?s.jsx(G,{className:"w-4 h-4 text-red-400"}):a.includes("Script")?s.jsx(I,{className:"w-4 h-4 text-yellow-400"}):a.includes("Archive")?s.jsx(xs,{className:"w-4 h-4 text-blue-400"}):s.jsx(us,{className:"w-4 h-4 text-gray-400"}),p=a=>{switch(a){case"malicious":return s.jsx("span",{className:"status-badge danger",children:"Malicious"});case"suspicious":return s.jsx("span",{className:"status-badge warning",children:"Suspicious"});case"clean":return s.jsx("span",{className:"status-badge success",children:"Clean"});case"pending":return s.jsx("span",{className:"status-badge info",children:"Pending"});default:return s.jsx("span",{className:"status-badge",children:"Unknown"})}},d=[{name:"Executables",count:145},{name:"Scripts",count:89},{name:"Documents",count:450},{name:"Archives",count:120},{name:"Images",count:441}];return f?s.jsx("div",{className:"loading-state",children:"Scanning extracted files..."}):s.jsxs("div",{className:"file-analysis",children:[s.jsxs("div",{className:"file-stats-row",children:[s.jsxs("div",{className:"file-stat-card",children:[s.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:s.jsx(I,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.totalFiles}),s.jsx("div",{className:"stat-label",children:"Files Extracted (24h)"})]})]}),s.jsxs("div",{className:"file-stat-card",children:[s.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:s.jsx(O,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.malicious}),s.jsx("div",{className:"stat-label",children:"Malicious Files"})]})]}),s.jsxs("div",{className:"file-stat-card",children:[s.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:s.jsx(A,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.suspicious}),s.jsx("div",{className:"stat-label",children:"Suspicious Files"})]})]}),s.jsxs("div",{className:"file-stat-card",children:[s.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:s.jsx(C,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.pending}),s.jsx("div",{className:"stat-label",children:"Pending Analysis"})]})]})]}),s.jsxs("div",{className:"file-content-grid",children:[s.jsx("div",{className:"file-left-col",children:s.jsxs("div",{className:"file-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(G,{className:"w-4 h-4 text-blue-400"})," File Types"]})}),s.jsx("div",{className:"chart-container",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(F,{data:d,layout:"vertical",margin:{left:40},children:[s.jsx(R,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),s.jsx(_,{type:"number",stroke:"#94a3b8",fontSize:10}),s.jsx(D,{dataKey:"name",type:"category",width:80,stroke:"#94a3b8",fontSize:10}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),s.jsx(M,{dataKey:"count",fill:"#3b82f6",radius:[0,4,4,0],children:d.map((a,t)=>s.jsx(Q,{fill:["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#10b981"][t%5]},`cell-${t}`))})]})})})]})}),s.jsx("div",{className:"file-right-col",children:s.jsxs("div",{className:"file-panel full-height",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h3",{children:[s.jsx(A,{className:"w-4 h-4 text-orange-400"})," Recent File Analysis"]}),s.jsx("div",{className:"panel-actions",children:s.jsxs("div",{className:"search-input-sm",children:[s.jsx(K,{className:"w-3 h-3"}),s.jsx("input",{type:"text",placeholder:"Search files..."})]})})]}),s.jsxs("table",{className:"file-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Status"}),s.jsx("th",{children:"File Name"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Score"}),s.jsx("th",{children:"Detection"}),s.jsx("th",{children:"Time"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:j.map(a=>s.jsxs("tr",{children:[s.jsx("td",{children:p(a.status)}),s.jsxs("td",{children:[s.jsxs("div",{className:"file-name-cell",children:[x(a.type),s.jsx("span",{className:"file-name",children:a.name})]}),s.jsxs("div",{className:"file-meta",children:[a.size," • ",a.source]})]}),s.jsx("td",{className:"text-gray-400",children:a.type}),s.jsx("td",{children:s.jsxs("div",{className:`score-badge ${a.score>80?"critical":a.score>50?"high":"low"}`,children:[a.score,"/100"]})}),s.jsx("td",{style:{color:"#fca5a5"},children:a.detection}),s.jsx("td",{className:"text-gray-500",children:a.time}),s.jsx("td",{children:s.jsx("button",{className:"btn-icon",title:"Download Sample",children:s.jsx(ms,{className:"w-4 h-4"})})})]},a.id))})]})]})})]})]})}const Qs=Object.freeze(Object.defineProperty({__proto__:null,default:Ps},Symbol.toStringTag,{value:"Module"}));function Is(){const[l,o]=c.useState(null),[j,N]=c.useState([]),[f,g]=c.useState([]),[x,p]=c.useState(!0);c.useEffect(()=>{(async()=>{p(!0);try{const v=await y.getDNSStats();throw v?(o({totalQueries:v.total_queries||0,blockedQueries:v.blocked_queries||0,dgaDomains:v.dga_domains||0,tunnelingAlerts:v.tunneling_alerts||0}),new Error("Using mock data for queries and tunneling events")):new Error("No DNS stats available")}catch(v){console.warn("Failed to load DNS intelligence from API, using mock data:",v),o(Rs),N(_s),g(Ds)}finally{p(!1)}})()},[]);const d=As,a=Cs;return x?s.jsx("div",{className:"loading-state",children:"Analyzing DNS traffic..."}):s.jsxs("div",{className:"dns-intelligence",children:[s.jsxs("div",{className:"dns-stats-row",children:[s.jsxs("div",{className:"dns-stat-card",children:[s.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:s.jsx(U,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsxs("div",{className:"stat-value",children:[l?.totalQueries?(l.totalQueries/1e3).toFixed(1):0,"k"]}),s.jsx("div",{className:"stat-label",children:"Total Queries (24h)"})]})]}),s.jsxs("div",{className:"dns-stat-card",children:[s.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:s.jsx(js,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.blockedQueries}),s.jsx("div",{className:"stat-label",children:"Blocked Domains"})]})]}),s.jsxs("div",{className:"dns-stat-card",children:[s.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:s.jsx($,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.dgaDomains}),s.jsx("div",{className:"stat-label",children:"DGA Detected"})]})]}),s.jsxs("div",{className:"dns-stat-card",children:[s.jsx("div",{className:"stat-icon bg-orange-500/10 text-orange-400",children:s.jsx(A,{className:"w-6 h-6"})}),s.jsxs("div",{className:"stat-info",children:[s.jsx("div",{className:"stat-value",children:l?.tunnelingAlerts}),s.jsx("div",{className:"stat-label",children:"Tunneling Events"})]})]})]}),s.jsxs("div",{className:"dns-content-grid",children:[s.jsxs("div",{className:"dns-left-col",children:[s.jsxs("div",{className:"dns-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(A,{className:"w-4 h-4 text-blue-400"})," DNS Query Volume (QPS)"]})}),s.jsx("div",{className:"chart-container-sm",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(bs,{data:a,children:[s.jsx(R,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),s.jsx(_,{dataKey:"time",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),s.jsx(D,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),s.jsx(Ls,{type:"monotone",dataKey:"qps",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})]}),s.jsxs("div",{className:"dns-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(Ns,{className:"w-4 h-4 text-purple-400"})," Query Types"]})}),s.jsx("div",{className:"chart-container-sm",children:s.jsx(L,{width:"100%",height:"100%",children:s.jsxs(F,{data:d,children:[s.jsx(R,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),s.jsx(_,{dataKey:"name",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),s.jsx(D,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),s.jsx(S,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),s.jsx(M,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})]})]}),s.jsxs("div",{className:"dns-right-col",children:[s.jsxs("div",{className:"dns-panel",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(O,{className:"w-4 h-4 text-red-400"})," DNS Tunneling Detection"]})}),s.jsx("div",{className:"tunnel-list",children:f.map(t=>s.jsxs("div",{className:"tunnel-item",children:[s.jsx("div",{className:"tunnel-icon",children:s.jsx(O,{className:"w-5 h-5 text-red-500"})}),s.jsxs("div",{className:"tunnel-info",children:[s.jsx("div",{className:"tunnel-domain",children:t.domain}),s.jsxs("div",{className:"tunnel-meta",children:[s.jsx("span",{children:t.method}),s.jsx("span",{children:"•"}),s.jsx("span",{children:t.volume}),s.jsx("span",{children:"•"}),s.jsx("span",{children:t.client})]})]}),s.jsxs("div",{className:"tunnel-confidence",children:[s.jsxs("div",{className:"confidence-val",children:[t.confidence,"%"]}),s.jsx("div",{className:"confidence-lbl",children:"Confidence"})]})]},t.id))})]}),s.jsxs("div",{className:"dns-panel flex-1",children:[s.jsxs("div",{className:"panel-header",children:[s.jsxs("h3",{children:[s.jsx(K,{className:"w-4 h-4 text-green-400"})," Recent Queries"]}),s.jsx("button",{className:"btn-icon",children:s.jsx(J,{className:"w-4 h-4"})})]}),s.jsxs("table",{className:"dns-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Domain"}),s.jsx("th",{children:"Type"}),s.jsx("th",{children:"Client"}),s.jsx("th",{children:"Category"}),s.jsx("th",{children:"Time"})]})}),s.jsx("tbody",{children:j.map(t=>s.jsxs("tr",{children:[s.jsxs("td",{children:[t.status==="blocked"&&s.jsx("span",{className:"status-dot blocked",title:"Blocked"}),t.status==="allowed"&&s.jsx("span",{className:"status-dot allowed",title:"Allowed"}),t.status==="flagged"&&s.jsx("span",{className:"status-dot flagged",title:"Flagged"})]}),s.jsx("td",{className:"mono text-white",children:t.domain}),s.jsx("td",{className:"text-gray-400",children:t.type}),s.jsx("td",{className:"mono text-blue-300",children:t.client}),s.jsx("td",{children:s.jsx("span",{className:"category-tag",children:t.category})}),s.jsx("td",{className:"text-gray-500",children:t.time})]},t.id))})]})]})]})]})]})}const Gs=Object.freeze(Object.defineProperty({__proto__:null,default:Is},Symbol.toStringTag,{value:"Module"}));function Os({view:l="playbooks"}){const[o,j]=c.useState(l),[N,f]=c.useState([]),[g,x]=c.useState([]),[p,d]=c.useState([]),[a,t]=c.useState(!0);c.useEffect(()=>{j(l)},[l]);const v=e=>{if(!e)return"-";const r=new Date,m=new Date(e),u=r.getTime()-m.getTime(),n=Math.round(u/1e3),w=Math.round(n/60),E=Math.round(w/60),i=Math.round(E/24);return n<60?`${n}s ago`:w<60?`${w}m ago`:E<24?`${E}h ago`:i<7?`${i}d ago`:m.toLocaleDateString()};return c.useEffect(()=>{(async()=>{t(!0);try{const[r,m]=await Promise.all([y.getPlaybooks(),y.getExecutions({limit:10})]);if(r&&Array.isArray(r)&&r.length>0){const u=r.map(n=>({id:n.id,name:n.name||n.title,trigger:n.trigger||"Manual",status:n.status==="active"||n.status==="manual"||n.status==="disabled"?n.status:"manual",runs:n.execution_count||0,successRate:n.success_rate||100,lastRun:v(n.last_execution)}));f(u)}if(m&&Array.isArray(m)&&m.length>0){const u=m.map(n=>({id:n.id,playbook:n.playbook_name||"Unknown",target:n.target||n.alert_id||"N/A",status:n.status==="completed"?"success":n.status==="failed"?"failed":"running",time:v(n.started_at),duration:n.duration||"-"}));d(u)}if((!r||r.length===0)&&(!m||m.length===0))throw new Error("No SOAR data available from API");x([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}])}catch(r){console.warn("Failed to load SOAR data from API, using mock data:",r),f([{id:1,name:"Block Malicious IP (Firewall)",trigger:"Critical Alert",status:"active",runs:145,successRate:98,lastRun:"10m ago"},{id:2,name:"Isolate Host (EDR)",trigger:"Ransomware Detection",status:"active",runs:12,successRate:100,lastRun:"2h ago"},{id:3,name:"Enrich IOCs (VirusTotal)",trigger:"New Artifact",status:"active",runs:1250,successRate:99,lastRun:"1m ago"},{id:4,name:"Reset User Password (AD)",trigger:"Brute Force Success",status:"manual",runs:5,successRate:100,lastRun:"1d ago"},{id:5,name:"Send Slack Notification",trigger:"High Severity",status:"active",runs:450,successRate:100,lastRun:"5m ago"}]),x([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}]),d([{id:101,playbook:"Block Malicious IP",target:"185.22.1.4",status:"success",time:"10m ago",duration:"2s"},{id:102,playbook:"Enrich IOCs",target:"hash: 44d8...2f",status:"success",time:"12m ago",duration:"1.5s"},{id:103,playbook:"Send Slack Notification",target:"#security-ops",status:"success",time:"15m ago",duration:"0.5s"},{id:104,playbook:"Isolate Host",target:"WORKSTATION-04",status:"failed",time:"2h ago",duration:"5s"}])}finally{t(!1)}})()},[]),a?s.jsx("div",{className:"loading-state",children:"Loading automation modules..."}):s.jsxs("div",{className:"soar-integration",children:[s.jsxs("div",{className:"soar-header",children:[s.jsxs("div",{className:"view-selector",children:[s.jsxs("button",{className:`view-btn ${o==="playbooks"?"active":""}`,onClick:()=>j("playbooks"),children:[s.jsx($,{className:"w-4 h-4"}),s.jsx("span",{children:"Playbooks & Automation"})]}),s.jsxs("button",{className:`view-btn ${o==="connectors"?"active":""}`,onClick:()=>j("connectors"),children:[s.jsx(V,{className:"w-4 h-4"}),s.jsx("span",{children:"SIEM & Connectors"})]})]}),s.jsx("div",{className:"soar-actions",children:s.jsx("button",{className:"btn-primary",children:o==="playbooks"?s.jsxs(s.Fragment,{children:[s.jsx(ps,{className:"w-4 h-4"})," New Playbook"]}):s.jsxs(s.Fragment,{children:[s.jsx(Z,{className:"w-4 h-4"})," New Connector"]})})})]}),s.jsx("div",{className:"soar-content",children:o==="playbooks"?s.jsx("div",{className:"playbooks-view",children:s.jsxs("div",{className:"soar-grid",children:[s.jsxs("div",{className:"soar-panel flex-2",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx($,{className:"w-4 h-4 text-yellow-400"})," Active Playbooks"]})}),s.jsxs("table",{className:"soar-table",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{children:"Status"}),s.jsx("th",{children:"Playbook Name"}),s.jsx("th",{children:"Trigger"}),s.jsx("th",{children:"Success Rate"}),s.jsx("th",{children:"Last Run"}),s.jsx("th",{children:"Action"})]})}),s.jsx("tbody",{children:N.map(e=>s.jsxs("tr",{children:[s.jsx("td",{children:s.jsx("div",{className:`status-pill ${e.status}`,children:e.status})}),s.jsx("td",{className:"font-medium text-white",children:e.name}),s.jsx("td",{className:"text-gray-400",children:e.trigger}),s.jsxs("td",{children:[s.jsx("div",{className:"progress-bar-sm",children:s.jsx("div",{className:"progress-fill",style:{width:`${e.successRate}%`,background:e.successRate>90?"#10b981":"#f59e0b"}})}),s.jsxs("span",{className:"text-xs text-gray-400",children:[e.successRate,"%"]})]}),s.jsx("td",{className:"text-gray-500",children:e.lastRun}),s.jsx("td",{children:s.jsx("button",{className:"btn-icon",children:s.jsx(vs,{className:"w-4 h-4"})})})]},e.id))})]})]}),s.jsxs("div",{className:"soar-panel flex-1",children:[s.jsx("div",{className:"panel-header",children:s.jsxs("h3",{children:[s.jsx(A,{className:"w-4 h-4 text-blue-400"})," Recent Executions"]})}),s.jsx("div",{className:"history-list",children:p.map(e=>s.jsxs("div",{className:"history-item",children:[s.jsx("div",{className:"history-status",children:e.status==="success"?s.jsx(B,{className:"w-4 h-4 text-green-400"}):s.jsx(gs,{className:"w-4 h-4 text-red-400"})}),s.jsxs("div",{className:"history-info",children:[s.jsx("div",{className:"history-name",children:e.playbook}),s.jsx("div",{className:"history-target",children:e.target})]}),s.jsxs("div",{className:"history-meta",children:[s.jsx("div",{children:e.time}),s.jsx("div",{className:"history-dur",children:e.duration})]})]},e.id))})]})]})}):s.jsx("div",{className:"connectors-view",children:s.jsxs("div",{className:"connectors-grid",children:[g.map(e=>s.jsxs("div",{className:"connector-card",children:[s.jsxs("div",{className:"connector-header",children:[s.jsx("div",{className:"connector-icon",children:e.type==="SIEM"?s.jsx(V,{className:"w-6 h-6"}):e.type==="Firewall"?s.jsx(C,{className:"w-6 h-6"}):s.jsx(ys,{className:"w-6 h-6"})}),s.jsx("div",{className:`connector-status ${e.status}`})]}),s.jsxs("div",{className:"connector-body",children:[s.jsx("h4",{children:e.name}),s.jsx("div",{className:"connector-type",children:e.type}),s.jsxs("div",{className:"connector-stats",children:[s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Latency"}),s.jsx("span",{className:"mono",children:e.latency})]}),s.jsxs("div",{className:"stat-row",children:[s.jsx("span",{children:"Throughput"}),s.jsx("span",{className:"mono",children:e.events})]})]})]}),s.jsx("div",{className:"connector-footer",children:s.jsx("button",{className:"btn-secondary full-width",children:"Configure"})})]},e.id)),s.jsx("div",{className:"connector-card add-new",children:s.jsxs("div",{className:"add-content",children:[s.jsx("div",{className:"add-icon",children:s.jsx(Z,{className:"w-8 h-8"})}),s.jsx("span",{children:"Add Integration"})]})})]})})})]})}const Vs=Object.freeze(Object.defineProperty({__proto__:null,default:Os},Symbol.toStringTag,{value:"Module"}));export{Bs as A,Gs as D,Qs as F,Ks as S,Us as a,Vs as b};
