import{j as e}from"./components-core-5MYStnfc.js";import{r as d,S as A,C as K,A as R,y as ke,b as V,z as Te,F as W,B as Ae,J as Re,d as Me,D as ue,e as Y,h as xe,K as Ee,X as De,O as _e,Q as Pe,U as Oe,T as B,G as X,V as Ie,a as He,c as Fe,Y as G,x as $e,_ as ie,$ as qe,a0 as ze,a1 as We,Z,l as Be,w as le,P as Ke,L as ce,a2 as Ue,p as Ge,o as Qe}from"./vendor-icons-BKKSVBBa.js";import{R as C,P as J,c as ee,d as U,T as k,B as $,C as E,X as D,Y as _,L as F,a as P,A as Ve,b as Q,e as Ze,f as Ye}from"./vendor-charts-DSUQyGw-.js";import{a as L}from"./components-dashboard-B1-Ah2vY.js";import{m as Xe,a as Je,b as es,c as ss,d as as,e as ts,f as is,g as ls}from"./components-features-t3g_BO7F.js";const ne={Malware:["Trojan","Backdoor","RAT","Botnet","Cryptominer"],Exploit:["RCE","SQLi","XSS","Buffer Overflow","Code Injection"],Phishing:["Credential Harvesting","Fake Login","CEO Fraud"],Scan:["Port Scan","Vuln Scan","Network Mapping"],Policy:["Unauthorized Access","Data Exfiltration","Suspicious Traffic"]},re={Ransomware:["WannaCry","Ryuk","Lockbit","BlackCat"],APT:["APT28","APT29","Lazarus","Equation Group"],Webshell:["PHP Shell","JSP Shell","ASPX Shell"],Script:["Obfuscated PowerShell","Malicious VBS","JavaScript Dropper"],"Credential Theft":["Mimikatz","LaZagne","Password Dumper"]},de={Execution:["Process Creation","Command Line","Scripting"],Persistence:["Registry","Scheduled Task","Startup"],"Defense Evasion":["Clear Logs","Disable Security","Obfuscation"],"Credential Access":["Credential Dumping","Brute Force"],Discovery:["Network Discovery","System Info","Account Discovery"]},cs={Windows:.4,Linux:.3,Web:.25,Cloud:.15,Network:.2,Database:.1,Email:.05},se={Malware:{tactics:["TA0002","TA0003"],techniques:["T1059","T1543","T1053"]},Exploit:{tactics:["TA0001","TA0004"],techniques:["T1190","T1068","T1055"]},Phishing:{tactics:["TA0001"],techniques:["T1566"]},Scan:{tactics:["TA0007"],techniques:["T1046","T1018"]},Policy:{tactics:["TA0010","TA0011"],techniques:["T1041","T1071"]},Ransomware:{tactics:["TA0040","TA0005"],techniques:["T1486","T1490"]},APT:{tactics:["TA0002","TA0008"],techniques:["T1059","T1021"]},Webshell:{tactics:["TA0003","TA0011"],techniques:["T1505","T1071"]},Script:{tactics:["TA0002","TA0005"],techniques:["T1059","T1027"]},"Credential Theft":{tactics:["TA0006"],techniques:["T1003","T1558"]},Execution:{tactics:["TA0002"],techniques:["T1059","T1106"]},Persistence:{tactics:["TA0003"],techniques:["T1547","T1053"]},"Defense Evasion":{tactics:["TA0005"],techniques:["T1070","T1562"]},"Credential Access":{tactics:["TA0006"],techniques:["T1003","T1110"]},Discovery:{tactics:["TA0007"],techniques:["T1082","T1016"]}};function ae(i=365){const r=new Date;return r.setDate(r.getDate()-Math.floor(Math.random()*i)),r.toISOString().split("T")[0]}function te(){const i=Object.keys(cs),r=Math.floor(Math.random()*3)+1,m=[];for(let o=0;o<r;o++){const u=i[Math.floor(Math.random()*i.length)];m.includes(u)||m.push(u)}return m}function ns(i){const r=[],m=Object.keys(ne),o=["Low","Medium","High","Critical"];for(let u=0;u<i;u++){const j=m[Math.floor(Math.random()*m.length)],v=ne[j],s=v[Math.floor(Math.random()*v.length)],l=o[Math.floor(Math.random()*o.length)],t=se[j]||{tactics:[],techniques:[]};r.push({id:2e6+u,name:`ET ${j.toUpperCase()} ${s}`,description:`Detects ${s.toLowerCase()} activity in network traffic`,category:j,severity:l,status:Math.random()>.7?"enabled":"disabled",hits:Math.floor(Math.random()*1e3),updated:ae(),technology:te(),ruleType:"suricata",mitreTactics:t.tactics,mitreTechniques:t.techniques})}return r}function rs(i){const r=[],m=Object.keys(re),o=["Medium","High","Critical"];for(let u=0;u<i;u++){const j=m[Math.floor(Math.random()*m.length)],v=re[j],s=v[Math.floor(Math.random()*v.length)],l=o[Math.floor(Math.random()*o.length)],t=se[j]||{tactics:[],techniques:[]};r.push({id:`yara-${String(u+1).padStart(4,"0")}`,name:`MALW_${s.replace(/\s/g,"_")}`,description:`Signature for ${s} malware family`,category:j,severity:l,status:Math.random()>.8?"enabled":"disabled",hits:Math.floor(Math.random()*50),updated:ae(180),technology:te(),ruleType:"yara",mitreTactics:t.tactics,mitreTechniques:t.techniques})}return r}function ds(i){const r=[],m=Object.keys(de),o=["Low","Medium","High","Critical"];for(let u=0;u<i;u++){const j=m[Math.floor(Math.random()*m.length)],v=de[j],s=v[Math.floor(Math.random()*v.length)],l=o[Math.floor(Math.random()*o.length)],t=se[j]||{tactics:[],techniques:[]};r.push({id:`sigma-${String(u+1).padStart(4,"0")}`,name:`${j}: ${s}`,description:`Detects suspicious ${s.toLowerCase()} behavior`,category:j,severity:l,status:Math.random()>.75?"enabled":"disabled",hits:Math.floor(Math.random()*200),updated:ae(90),technology:te(),ruleType:"sigma",mitreTactics:t.tactics,mitreTechniques:t.techniques})}return r}function os(){const i=ns(3e3),r=rs(1500),m=ds(500);return[...i,...r,...m]}const hs={Malware:"#ef4444",Exploit:"#f59e0b",Phishing:"#8b5cf6",Scan:"#3b82f6",Policy:"#10b981",Ransomware:"#dc2626",APT:"#7c3aed",Webshell:"#ea580c",Script:"#0891b2","Credential Theft":"#e11d48",Execution:"#f97316",Persistence:"#84cc16","Defense Evasion":"#06b6d4","Credential Access":"#ec4899",Discovery:"#14b8a6"},oe={Critical:"#dc2626",High:"#f59e0b",Medium:"#3b82f6",Low:"#10b981"};function ms({rules:i,onCategoryClick:r,onSeverityClick:m}){const o=d.useMemo(()=>{const s=i.length,l=i.filter(x=>x.status==="enabled").length,t=i.filter(x=>x.severity==="Critical").length,n=i.reduce((x,N)=>x+N.hits,0),f=s>0?Math.round(n/s):0,c=s>0?Math.round(l/s*100):0;return{totalRules:s,enabledRules:l,enabledPercentage:c,criticalRules:t,avgHits:f}},[i]),u=d.useMemo(()=>{const s={};return i.forEach(l=>{s[l.category]=(s[l.category]||0)+1}),Object.entries(s).map(([l,t])=>({name:l,value:t})).sort((l,t)=>t.value-l.value)},[i]),j=d.useMemo(()=>{const s={Critical:{total:0,enabled:0},High:{total:0,enabled:0},Medium:{total:0,enabled:0},Low:{total:0,enabled:0}};return i.forEach(l=>{s[l.severity]&&(s[l.severity].total++,l.status==="enabled"&&s[l.severity].enabled++)}),Object.entries(s).map(([l,t])=>({name:l,total:t.total,enabled:t.enabled}))},[i]),v=d.useMemo(()=>[...i].sort((s,l)=>l.hits-s.hits).slice(0,10),[i]);return e.jsxs("div",{className:"rule-analytics",children:[e.jsxs("div",{className:"analytics-stats-row",children:[e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:o.totalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(K,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[o.enabledPercentage,"%"]}),e.jsxs("div",{className:"stat-label",children:["Enabled (",o.enabledRules.toLocaleString(),")"]})]})]}),e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:o.criticalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Critical Severity"})]})]}),e.jsxs("div",{className:"analytics-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(ke,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:o.avgHits}),e.jsx("div",{className:"stat-label",children:"Avg Hits per Rule"})]})]})]}),e.jsxs("div",{className:"analytics-charts-row",children:[e.jsxs("div",{className:"analytics-chart-card",children:[e.jsx("h3",{children:"Rules by Category"}),e.jsx(C,{width:"100%",height:300,children:e.jsxs(J,{children:[e.jsx(ee,{data:u,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:l})=>l?`${s} (${(l*100).toFixed(0)}%)`:s,outerRadius:100,fill:"#8884d8",dataKey:"value",onClick:s=>r?.(s.name),style:{cursor:"pointer"},children:u.map((s,l)=>e.jsx(U,{fill:hs[s.name]||"#64748b"},`cell-${l}`))}),e.jsx(k,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"0.5rem",color:"#e2e8f0"}})]})})]}),e.jsxs("div",{className:"analytics-chart-card",children:[e.jsx("h3",{children:"Rules by Severity"}),e.jsx(C,{width:"100%",height:300,children:e.jsxs($,{data:j,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(D,{dataKey:"name",stroke:"#94a3b8"}),e.jsx(_,{stroke:"#94a3b8"}),e.jsx(k,{contentStyle:{background:"#1e293b",border:"1px solid #334155",borderRadius:"0.5rem",color:"#e2e8f0"}}),e.jsx(F,{}),e.jsx(P,{dataKey:"total",fill:"#3b82f6",name:"Total Rules",onClick:s=>s?.name&&m?.(s.name),style:{cursor:"pointer"}}),e.jsx(P,{dataKey:"enabled",fill:"#10b981",name:"Enabled"})]})})]})]}),e.jsxs("div",{className:"analytics-top-rules",children:[e.jsx("h3",{children:"Top 10 Most Triggered Rules"}),e.jsx("div",{className:"top-rules-table-container",children:e.jsxs("table",{className:"top-rules-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Rule Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Hits"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:v.map((s,l)=>e.jsxs("tr",{children:[e.jsx("td",{className:"rank",children:l+1}),e.jsx("td",{className:"rule-name",children:s.name}),e.jsx("td",{children:e.jsx("span",{className:"category-badge",children:s.category})}),e.jsx("td",{children:e.jsx("span",{className:`severity-badge ${s.severity.toLowerCase()}`,style:{background:`${oe[s.severity]}20`,color:oe[s.severity]},children:s.severity})}),e.jsx("td",{className:"hits",children:s.hits.toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.status}`,children:s.status})})]},s.id))})]})})]})]})}const H=[{id:"TA0043",name:"Reconnaissance",short:"Recon"},{id:"TA0042",name:"Resource Development",short:"Resource Dev"},{id:"TA0001",name:"Initial Access",short:"Initial Access"},{id:"TA0002",name:"Execution",short:"Execution"},{id:"TA0003",name:"Persistence",short:"Persistence"},{id:"TA0004",name:"Privilege Escalation",short:"Priv Esc"},{id:"TA0005",name:"Defense Evasion",short:"Defense Evasion"},{id:"TA0006",name:"Credential Access",short:"Cred Access"},{id:"TA0007",name:"Discovery",short:"Discovery"},{id:"TA0008",name:"Lateral Movement",short:"Lateral Move"},{id:"TA0009",name:"Collection",short:"Collection"},{id:"TA0011",name:"Command and Control",short:"C2"},{id:"TA0010",name:"Exfiltration",short:"Exfiltration"},{id:"TA0040",name:"Impact",short:"Impact"}];function us({rules:i,onTacticClick:r,onTechniqueClick:m}){const o=d.useMemo(()=>{const s={};return H.forEach(l=>{s[l.id]={count:0,techniques:new Set}}),i.forEach(l=>{l.mitreTactics.forEach(t=>{s[t]&&(s[t].count++,l.mitreTechniques.forEach(n=>{s[t].techniques.add(n)}))})}),s},[i]),u=d.useMemo(()=>{const s=i.length,l=i.filter(f=>f.mitreTactics.length>0).length,t=new Set;i.forEach(f=>{f.mitreTechniques.forEach(c=>t.add(c))});const n=s>0?Math.round(l/s*100):0;return{totalRules:s,rulesWithMitre:l,uniqueTechniques:t.size,coveragePercent:n}},[i]),j=s=>s===0?"#1e293b":s<50?"#7f1d1d":s<150?"#dc2626":s<300?"#f97316":s<500?"#eab308":"#22c55e",v=s=>s===0?"None":s<50?"Low":s<150?"Medium-Low":s<300?"Medium":s<500?"Medium-High":"High";return e.jsxs("div",{className:"mitre-heatmap",children:[e.jsxs("div",{className:"mitre-stats",children:[e.jsxs("div",{className:"mitre-stat-card",children:[e.jsx("div",{className:"stat-label",children:"Total Rules with MITRE"}),e.jsx("div",{className:"stat-value",children:u.rulesWithMitre.toLocaleString()}),e.jsxs("div",{className:"stat-sublabel",children:[u.coveragePercent,"% of all rules"]})]}),e.jsxs("div",{className:"mitre-stat-card",children:[e.jsx("div",{className:"stat-label",children:"Unique Techniques Covered"}),e.jsx("div",{className:"stat-value",children:u.uniqueTechniques}),e.jsx("div",{className:"stat-sublabel",children:"Across all tactics"})]}),e.jsxs("div",{className:"mitre-stat-card",children:[e.jsx("div",{className:"stat-label",children:"Tactics Covered"}),e.jsx("div",{className:"stat-value",children:Object.values(o).filter(s=>s.count>0).length}),e.jsx("div",{className:"stat-sublabel",children:"out of 14 tactics"})]})]}),e.jsxs("div",{className:"coverage-legend",children:[e.jsx("span",{className:"legend-title",children:"Coverage Level:"}),e.jsxs("div",{className:"legend-items",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"#1e293b"}}),e.jsx("span",{children:"None (0)"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"#7f1d1d"}}),e.jsx("span",{children:"Low (1-49)"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"#dc2626"}}),e.jsx("span",{children:"Med-Low (50-149)"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"#f97316"}}),e.jsx("span",{children:"Medium (150-299)"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"#eab308"}}),e.jsx("span",{children:"Med-High (300-499)"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("div",{className:"legend-color",style:{background:"#22c55e"}}),e.jsx("span",{children:"High (500+)"})]})]})]}),e.jsxs("div",{className:"mitre-grid",children:[e.jsxs("div",{className:"grid-header",children:[e.jsx("h3",{children:"MITRE ATT&CK Tactics Coverage"}),e.jsx("p",{children:"Click on a tactic to filter rules"})]}),e.jsx("div",{className:"tactics-grid",children:H.map(s=>{const l=o[s.id],t=j(l.count),n=v(l.count);return e.jsxs("div",{className:"tactic-cell",style:{backgroundColor:t},onClick:()=>r?.(s.id),title:`${s.name}
${l.count} rules
${l.techniques.size} unique techniques
Coverage: ${n}`,children:[e.jsx("div",{className:"tactic-name",children:s.short}),e.jsx("div",{className:"tactic-id",children:s.id}),e.jsxs("div",{className:"tactic-count",children:[l.count," rules"]}),e.jsxs("div",{className:"tactic-techniques",children:[l.techniques.size," techniques"]})]},s.id)})})]}),e.jsxs("div",{className:"coverage-details",children:[e.jsx("h4",{children:"Top Covered Tactics"}),e.jsx("div",{className:"top-tactics",children:Object.entries(o).sort(([,s],[,l])=>l.count-s.count).slice(0,5).map(([s,l])=>{const t=H.find(n=>n.id===s);return t?e.jsxs("div",{className:"tactic-row",onClick:()=>r?.(s),children:[e.jsxs("div",{className:"tactic-info",children:[e.jsx("span",{className:"tactic-badge",children:t.id}),e.jsx("span",{className:"tactic-name-full",children:t.name})]}),e.jsxs("div",{className:"tactic-stats",children:[e.jsxs("span",{className:"rule-count",children:[l.count," rules"]}),e.jsxs("span",{className:"tech-count",children:[l.techniques.size," techniques"]})]})]},s):null})})]}),e.jsxs("div",{className:"gap-analysis",children:[e.jsx("h4",{children:"Coverage Gaps"}),e.jsx("div",{className:"gap-list",children:H.filter(s=>o[s.id].count===0).length>0?H.filter(s=>o[s.id].count===0).map(s=>e.jsxs("div",{className:"gap-item",children:[e.jsx("span",{className:"gap-badge",children:s.id}),e.jsx("span",{className:"gap-name",children:s.name}),e.jsx("span",{className:"gap-warning",children:"⚠️ No Coverage"})]},s.id)):e.jsx("div",{className:"no-gaps",children:"✅ All tactics have coverage!"})})]})]})}function xs(){const[i,r]=d.useState("suricata"),[m,o]=d.useState([]),[u,j]=d.useState([]),[v,s]=d.useState(!0),[l,t]=d.useState(null),[n,f]=d.useState(""),[c,x]=d.useState(""),[N,b]=d.useState(!1),[h,w]=d.useState(new Set),[M,q]=d.useState(!1),[S,O]=d.useState({category:"all",severity:"all",technology:"all",status:"all"}),[z,je]=d.useState(!1),ve=a=>{if(typeof a=="number")return a>=1&&a<=3?"Critical":a===4?"High":a===5?"Medium":"Low";switch(String(a).toLowerCase()){case"critical":return"Critical";case"high":return"High";case"medium":return"Medium";case"low":return"Low";default:return"Informational"}},ge=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return a}},pe=()=>{s(!0);const a=os();j(a),je(!0);const T=a.filter(p=>p.ruleType===i).map(p=>({id:p.id,name:p.name,category:p.category,severity:p.severity,status:p.status,hits:p.hits,updated:p.updated}));o(T),t({totalRules:a.length,activeRules:a.filter(p=>p.status==="enabled").length,recentHits:a.reduce((p,g)=>p+g.hits,0),lastUpdate:"Just now"}),s(!1)},Ne=()=>{h.size===I.length?w(new Set):w(new Set(I.map(a=>a.id)))},ye=()=>{o(m.map(a=>h.has(a.id)?{...a,status:"enabled"}:a)),w(new Set)},fe=()=>{o(m.map(a=>h.has(a.id)?{...a,status:"disabled"}:a)),w(new Set)},be=()=>{o(m.map(a=>a.severity==="Critical"?{...a,status:"enabled"}:a))},Se=()=>{o(m.map(a=>a.severity==="Critical"||a.severity==="High"&&(a.category.includes("Malware")||a.category.includes("Exploit")||a.category.includes("Ransomware"))?{...a,status:"enabled"}:a))},we=()=>{o(m.map(a=>({...a,status:"disabled"}))),w(new Set)};d.useEffect(()=>{(async()=>{s(!0);try{if(i==="editor"){const p=await L.getSuricataRules();x(p.rules||""),s(!1);return}const[y,T]=await Promise.all([L.getDetectionRules(),L.getDetectionStats().catch(()=>null)]);if(y&&Array.isArray(y)){const p=y.filter(g=>i==="suricata"?g.type==="suricata"||g.type==="ids":i==="yara"?g.type==="yara":i==="sigma"?g.type==="sigma":!0).map(g=>({id:g.id||g.sid,name:g.name||g.msg,category:g.category||"Unclassified",severity:ve(g.severity||g.priority),status:g.enabled?"enabled":"disabled",hits:g.hit_count||0,updated:ge(g.updated_at||g.last_modified)}));o(p),t(T?{totalRules:T.total_rules||p.length,activeRules:T.active_rules||p.filter(g=>g.status==="enabled").length,recentHits:T.recent_hits||0,lastUpdate:T.last_update||"10m ago"}:{totalRules:p.length,activeRules:p.filter(g=>g.status==="enabled").length,recentHits:0,lastUpdate:"Just now"})}else throw new Error("Invalid rules response")}catch(y){console.warn("Failed to load detection rules from API, using mock data:",y),t({totalRules:15420,activeRules:12850,recentHits:452,lastUpdate:"10m ago"}),o(i==="suricata"?[{id:2010983,name:"ET MALWARE Cobalt Strike Beacon",category:"Malware",severity:"Critical",status:"enabled",hits:124,updated:"2023-11-15"},{id:2025641,name:"ET EXPLOIT Apache Log4j RCE",category:"Exploit",severity:"Critical",status:"enabled",hits:45,updated:"2023-10-01"},{id:2001219,name:"ET SCAN Nmap Scripting Engine",category:"Scan",severity:"Medium",status:"enabled",hits:1250,updated:"2023-09-20"},{id:2014752,name:"ET POLICY Suspicious Inbound to Oracle SQL",category:"Policy",severity:"High",status:"disabled",hits:0,updated:"2023-08-15"},{id:2031450,name:"ET PHISHING Successful Generic Phish",category:"Phishing",severity:"High",status:"enabled",hits:12,updated:"2023-11-20"}]:i==="yara"?[{id:"yara-001",name:"SUSP_PowerShell_Obfuscated",category:"Script",severity:"High",status:"enabled",hits:8,updated:"2023-11-10"},{id:"yara-002",name:"MALW_Ransomware_WannaCry",category:"Ransomware",severity:"Critical",status:"enabled",hits:0,updated:"2023-05-12"},{id:"yara-003",name:"WEBSHELL_PHP_Generic",category:"Webshell",severity:"Critical",status:"enabled",hits:2,updated:"2023-10-05"},{id:"yara-004",name:"APT_Tool_Mimikatz_Memory",category:"Credential Theft",severity:"High",status:"disabled",hits:0,updated:"2023-09-01"}]:[{id:"sigma-001",name:"Suspicious Process Creation via WMI",category:"Execution",severity:"High",status:"enabled",hits:15,updated:"2023-11-18"},{id:"sigma-002",name:"Clear Windows Event Logs",category:"Defense Evasion",severity:"Medium",status:"enabled",hits:3,updated:"2023-10-22"}])}finally{s(!1)}})()},[i]);const Le=async()=>{b(!0);try{await L.updateSuricataRules(c)}catch(a){console.error("Failed to save rules:",a)}finally{b(!1)}},Ce=a=>{o(m.map(y=>y.id===a?{...y,status:y.status==="enabled"?"disabled":"enabled"}:y))},I=m.filter(a=>{const y=a.name.toLowerCase().includes(n.toLowerCase())||a.category.toLowerCase().includes(n.toLowerCase())||a.id.toString().includes(n),T=S.category==="all"||a.category===S.category,p=S.severity==="all"||a.severity===S.severity,g=S.status==="all"||a.status===S.status;return y&&T&&p&&g});return e.jsxs("div",{className:"advanced-detection",children:[e.jsxs("div",{className:"detection-stats-row",children:[e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.totalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(K,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.activeRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Active Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.recentHits}),e.jsx("div",{className:"stat-label",children:"Hits (24h)"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(V,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:l?.lastUpdate}),e.jsx("div",{className:"stat-label",children:"Last Update"})]})]})]}),e.jsxs("div",{className:"detection-content",children:[e.jsxs("div",{className:"detection-sidebar",children:[e.jsxs("button",{className:`sidebar-item ${i==="suricata"?"active":""}`,onClick:()=>r("suricata"),children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{children:"Suricata IDS"})]}),e.jsxs("button",{className:`sidebar-item ${i==="yara"?"active":""}`,onClick:()=>r("yara"),children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"YARA Rules"})]}),e.jsxs("button",{className:`sidebar-item ${i==="sigma"?"active":""}`,onClick:()=>r("sigma"),children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"Sigma Rules"})]}),e.jsxs("button",{className:`sidebar-item ${i==="analytics"?"active":""}`,onClick:()=>r("analytics"),disabled:!z,children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Analytics"})]}),e.jsxs("button",{className:`sidebar-item ${i==="mitre"?"active":""}`,onClick:()=>r("mitre"),disabled:!z,children:[e.jsx(A,{className:"w-4 h-4"}),e.jsx("span",{children:"MITRE ATT&CK"})]}),e.jsxs("button",{className:`sidebar-item ${i==="editor"?"active":""}`,onClick:()=>r("editor"),children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{children:"Rule Editor"})]})]}),e.jsx("div",{className:"rules-panel",children:i==="mitre"?e.jsx(us,{rules:u,onTacticClick:a=>{r("suricata")}}):i==="analytics"?e.jsx(ms,{rules:u,onCategoryClick:a=>{r("suricata"),O({...S,category:a})},onSeverityClick:a=>{r("suricata"),O({...S,severity:a})}}):i==="editor"?e.jsxs("div",{className:"rule-editor-container",children:[e.jsxs("div",{className:"panel-controls",children:[e.jsx("h3",{children:"Suricata Rules File (suricata.rules)"}),e.jsx("div",{className:"control-actions",children:e.jsxs("button",{className:"btn-primary",onClick:Le,disabled:N,children:[N?e.jsx(V,{className:"w-4 h-4 animate-spin"}):e.jsx(Me,{className:"w-4 h-4"}),N?"Saving...":"Save Rules"]})})]}),e.jsx("textarea",{className:"rule-editor-textarea",value:c,onChange:a=>x(a.target.value),spellCheck:"false"})]}):e.jsxs(e.Fragment,{children:[!z&&e.jsxs("div",{className:"load-library-prompt",children:[e.jsxs("button",{className:"btn-load-library",onClick:pe,children:[e.jsx(ue,{className:"w-5 h-5"}),"Load Rule Library (5,000 Rules)"]}),e.jsx("p",{children:"Load comprehensive detection rules from Suricata ET, YARA, and Sigma"})]}),e.jsxs("div",{className:"panel-controls",children:[e.jsxs("div",{className:"search-input",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search rules by name, ID, or category...",value:n,onChange:a=>f(a.target.value)})]}),e.jsxs("div",{className:"control-actions",children:[e.jsxs("button",{className:"btn-secondary",onClick:()=>q(!M),children:[e.jsx(xe,{className:"w-4 h-4"}),M?"Hide Filters":"Filters"]}),e.jsxs("button",{className:"btn-primary",children:[e.jsx(Ee,{className:"w-4 h-4"})," Add Rule"]})]})]}),h.size>0&&e.jsxs("div",{className:"bulk-actions-toolbar",children:[e.jsx("div",{className:"bulk-info",children:e.jsxs("span",{children:[h.size," rule",h.size!==1?"s":""," selected"]})}),e.jsxs("div",{className:"bulk-buttons",children:[e.jsx("button",{className:"btn-sm btn-success",onClick:ye,children:"Enable Selected"}),e.jsx("button",{className:"btn-sm btn-danger",onClick:fe,children:"Disable Selected"}),e.jsxs("button",{className:"btn-sm btn-secondary",onClick:()=>w(new Set),children:[e.jsx(De,{className:"w-4 h-4"})," Clear Selection"]})]})]}),z&&e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{className:"btn-quick",onClick:be,children:"Enable All Critical"}),e.jsx("button",{className:"btn-quick",onClick:Se,children:"Enable Recommended"}),e.jsx("button",{className:"btn-quick",onClick:we,children:"Disable All"})]}),M&&e.jsx("div",{className:"filter-panel",children:e.jsxs("div",{className:"filter-row",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:S.category,onChange:a=>O({...S,category:a.target.value}),children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Malware",children:"Malware"}),e.jsx("option",{value:"Exploit",children:"Exploit"}),e.jsx("option",{value:"Phishing",children:"Phishing"}),e.jsx("option",{value:"Ransomware",children:"Ransomware"}),e.jsx("option",{value:"Scan",children:"Scan"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Severity"}),e.jsxs("select",{value:S.severity,onChange:a=>O({...S,severity:a.target.value}),children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:S.status,onChange:a=>O({...S,status:a.target.value}),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"enabled",children:"Enabled"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})]})]})}),e.jsx("div",{className:"rules-table-container",children:v?e.jsx("div",{className:"loading-state",children:"Loading rules..."}):e.jsxs("table",{className:"rules-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"},children:e.jsx("input",{type:"checkbox",checked:h.size===I.length&&I.length>0,onChange:Ne})}),e.jsx("th",{style:{width:"60px"},children:"Status"}),e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Rule Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Hits"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:I.map(a=>e.jsxs("tr",{className:a.status==="disabled"?"disabled-row":"",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:h.has(a.id),onChange:()=>{const y=new Set(h);y.has(a.id)?y.delete(a.id):y.add(a.id),w(y)}})}),e.jsx("td",{children:e.jsx("button",{className:`toggle-btn ${a.status}`,onClick:()=>Ce(a.id),children:a.status==="enabled"?e.jsx(_e,{className:"w-6 h-6 text-green-400"}):e.jsx(Pe,{className:"w-6 h-6 text-gray-500"})})}),e.jsx("td",{className:"mono text-gray-400",children:a.id}),e.jsx("td",{className:"rule-name",children:a.name}),e.jsx("td",{children:e.jsx("span",{className:"category-badge",children:a.category})}),e.jsx("td",{children:e.jsx("span",{className:`severity-badge ${a.severity.toLowerCase()}`,children:a.severity})}),e.jsx("td",{className:"mono",children:a.hits.toLocaleString()}),e.jsx("td",{className:"text-gray-500",children:a.updated}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Edit"})})]},a.id))})]})})]})})]})]})}const Ls=Object.freeze(Object.defineProperty({__proto__:null,default:xs},Symbol.toStringTag,{value:"Module"})),he=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];function js(){const[i,r]=d.useState(null),[m,o]=d.useState([]),[u,j]=d.useState([]),[v,s]=d.useState([]),[l,t]=d.useState(!0),n=c=>c.is_expired?"expired":c.is_weak_key?"weak":c.is_valid?"valid":"unknown",f=c=>c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A";return d.useEffect(()=>{(async()=>{t(!0);try{const x=await L.getSSLStats();let N=null;try{const b=await L.getSensors({limit:1});if(b&&b.sensors&&b.sensors.length>0){const h=b.sensors[0].id;N=await L.getSensorCertificates(h)}}catch(b){console.warn("Could not fetch certificate data:",b)}if(x||N){if(r({totalConnections:x?.total_connections||0,securePercentage:x?.secure_percentage||0,expiredCerts:x?.expiring_soon||N?.expired_count||0,weakCiphers:x?.weak_ciphers||0}),N&&N.certificates){const b=N.certificates.map((h,w)=>({id:h.id||w+1,subject:h.subject||h.common_name||"Unknown",issuer:h.issuer||"Unknown",type:h.key_type||"RSA 2048",status:n(h),expiry:f(h.not_after||h.expiry)}));s(b)}throw new Error("Using mock data for TLS versions and ciphers")}else throw new Error("No SSL data available")}catch(x){console.warn("Failed to load SSL analysis from API, using mock data:",x),r({totalConnections:452890,securePercentage:98.2,expiredCerts:12,weakCiphers:450}),o([{name:"TLS 1.3",value:65},{name:"TLS 1.2",value:30},{name:"TLS 1.1",value:3},{name:"TLS 1.0",value:1},{name:"SSLv3",value:1}]),j([{name:"TLS_AES_128_GCM_SHA256",count:15e4},{name:"TLS_AES_256_GCM_SHA384",count:12e4},{name:"ECDHE-RSA-AES128-GCM-SHA256",count:8e4},{name:"ECDHE-RSA-AES256-GCM-SHA384",count:6e4},{name:"Other",count:42890}]),s([{id:1,subject:"internal-db.corp.local",issuer:"Corp-CA",type:"Self-signed",status:"expired",expiry:"2023-11-01"},{id:2,subject:"legacy-app.corp.local",issuer:"Corp-CA",type:"RSA 1024",status:"weak",expiry:"2024-05-15"},{id:3,subject:"test-env.dev",issuer:"Dev-CA",type:"Self-signed",status:"valid",expiry:"2024-12-20"},{id:4,subject:"payment-gateway.corp",issuer:"DigiCert",type:"RSA 2048",status:"valid",expiry:"2025-01-10"},{id:5,subject:"vpn.corp.net",issuer:"Let's Encrypt",type:"ECDSA",status:"valid",expiry:"2024-02-28"}])}finally{t(!1)}})()},[]),l?e.jsx("div",{className:"loading-state",children:"Analyzing SSL/TLS traffic..."}):e.jsxs("div",{className:"ssl-analysis",children:[e.jsxs("div",{className:"ssl-stats-row",children:[e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(Oe,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[i?.securePercentage,"%"]}),e.jsx("div",{className:"stat-label",children:"Encrypted Traffic"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.expiredCerts}),e.jsx("div",{className:"stat-label",children:"Expired Certs"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.weakCiphers}),e.jsx("div",{className:"stat-label",children:"Weak Ciphers"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[i?.totalConnections?(i.totalConnections/1e3).toFixed(1):0,"k"]}),e.jsx("div",{className:"stat-label",children:"Total Connections"})]})]})]}),e.jsxs("div",{className:"ssl-content-grid",children:[e.jsxs("div",{className:"ssl-charts-col",children:[e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Ie,{className:"w-4 h-4 text-blue-400"})," TLS Version Distribution"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(J,{children:[e.jsx(ee,{data:m,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:m.map((c,x)=>e.jsx(U,{fill:he[x%he.length]},`cell-${x}`))}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(F,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]}),e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-4 h-4 text-purple-400"})," Top Cipher Suites"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:u,layout:"vertical",margin:{left:40},children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(D,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(_,{dataKey:"name",type:"category",width:150,stroke:"#94a3b8",fontSize:10}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(P,{dataKey:"count",fill:"#8b5cf6",radius:[0,4,4,0]})]})})})]})]}),e.jsx("div",{className:"ssl-table-col",children:e.jsxs("div",{className:"ssl-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(W,{className:"w-4 h-4 text-orange-400"})," Certificate Hygiene"]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(V,{className:"w-3 h-3"})," Scan"]})]}),e.jsxs("table",{className:"ssl-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Subject (CN)"}),e.jsx("th",{children:"Issuer"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Expiry"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:v.map(c=>e.jsxs("tr",{children:[e.jsxs("td",{children:[c.status==="valid"&&e.jsx("span",{className:"status-badge success",children:"Valid"}),c.status==="expired"&&e.jsx("span",{className:"status-badge danger",children:"Expired"}),c.status==="weak"&&e.jsx("span",{className:"status-badge warning",children:"Weak"})]}),e.jsx("td",{className:"mono text-white",children:c.subject}),e.jsx("td",{className:"text-gray-400",children:c.issuer}),e.jsx("td",{className:"text-gray-400",children:c.type}),e.jsx("td",{className:"mono text-gray-400",children:c.expiry}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Details"})})]},c.id))})]})]})})]})]})}const Cs=Object.freeze(Object.defineProperty({__proto__:null,default:js},Symbol.toStringTag,{value:"Module"})),me=["#3b82f6","#10b981","#f59e0b","#ef4444"];function vs(){const[i,r]=d.useState({openCritical:12,mttr:"18m",analystsOnline:"4/6",slaCompliance:98.5}),[m,o]=d.useState([]),[u,j]=d.useState([]),[v,s]=d.useState([]);return d.useEffect(()=>{(async()=>{try{const t=await L.getSocMetrics(),n=await L.getDashboardStats();throw t||n?(r({openCritical:t?.open_critical||n?.summary?.critical_alerts||12,mttr:t?.mean_time_to_respond||"18m",analystsOnline:t?.analysts_online||"4/6",slaCompliance:t?.sla_compliance||98.5}),new Error("Using mock chart data")):new Error("No SOC data available")}catch(t){console.warn("Failed to load SOC metrics from API, using mock data:",t),o(Xe),j(Je),s(es)}finally{}})()},[]),e.jsxs("div",{className:"soc-dashboard",children:[e.jsxs("div",{className:"soc-header-grid",children:[e.jsxs("div",{className:"soc-stat-card critical",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(He,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i.openCritical}),e.jsx("div",{className:"stat-label",children:"Open Critical Incidents"}),e.jsx("div",{className:"stat-trend down",children:"↓ 2 from last hour"})]})]}),e.jsxs("div",{className:"soc-stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Fe,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i.mttr}),e.jsx("div",{className:"stat-label",children:"Mean Time to Respond"}),e.jsx("div",{className:"stat-trend up",children:"↑ 2m vs target"})]})]}),e.jsxs("div",{className:"soc-stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(G,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i.analystsOnline}),e.jsx("div",{className:"stat-label",children:"Analysts Online"}),e.jsx("div",{className:"stat-trend neutral",children:"Shift A"})]})]}),e.jsxs("div",{className:"soc-stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(K,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[i.slaCompliance,"%"]}),e.jsx("div",{className:"stat-label",children:"SLA Compliance"}),e.jsx("div",{className:"stat-trend up",children:"↑ 0.5% this week"})]})]})]}),e.jsxs("div",{className:"soc-content-grid",children:[e.jsxs("div",{className:"soc-col-main",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(R,{className:"w-5 h-5 text-blue-400"})," 24h Alert Volume"]})}),e.jsx("div",{className:"chart-container-lg",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(Ve,{data:m,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorCritical",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorHigh",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(D,{dataKey:"time",stroke:"#94a3b8"}),e.jsx(_,{stroke:"#94a3b8"}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"},itemStyle:{color:"#e2e8f0"}}),e.jsx(F,{}),e.jsx(Q,{type:"monotone",dataKey:"critical",stackId:"1",stroke:"#ef4444",fill:"url(#colorCritical)"}),e.jsx(Q,{type:"monotone",dataKey:"high",stackId:"1",stroke:"#f59e0b",fill:"url(#colorHigh)"}),e.jsx(Q,{type:"monotone",dataKey:"medium",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.1})]})})})]}),e.jsxs("div",{className:"soc-row-split",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(G,{className:"w-5 h-5 text-purple-400"})," Analyst Workload"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:u,layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(D,{type:"number",stroke:"#94a3b8"}),e.jsx(_,{dataKey:"name",type:"category",stroke:"#94a3b8",width:80}),e.jsx(k,{cursor:{fill:"rgba(255,255,255,0.05)"},contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(F,{}),e.jsx(P,{dataKey:"active",name:"Active Cases",fill:"#f59e0b",radius:[0,4,4,0]}),e.jsx(P,{dataKey:"resolved",name:"Resolved (Today)",fill:"#10b981",radius:[0,4,4,0]})]})})})]}),e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx($e,{className:"w-5 h-5 text-cyan-400"})," Alerts by Source"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(J,{children:[e.jsx(ee,{data:v,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:v.map((l,t)=>e.jsx(U,{fill:me[t%me.length]},`cell-${t}`))}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(F,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]})]}),e.jsxs("div",{className:"soc-col-side",children:[e.jsxs("div",{className:"soc-panel map-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(X,{className:"w-5 h-5 text-green-400"})," Threat Origins"]})}),e.jsxs("div",{className:"world-map-container",children:[e.jsxs("svg",{viewBox:"0 0 900 450",className:"world-map-svg",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("g",{className:"continents",children:[e.jsx("path",{d:`M 120,100 L 140,85 L 155,80 L 165,75 L 180,70 L 195,75 L 210,80 L 220,90 L 225,105 L 230,120 L 228,135 L 220,150 L 210,165 L 200,175 L 185,180 L 170,178 L 155,172 L 145,165 L 135,155 L 128,140 L 125,125 L 122,110 Z
                    M 160,180 L 165,185 L 172,195 L 178,205 L 180,215 L 178,225 L 172,230 L 165,228 L 158,223 L 155,215 L 154,205 L 156,195 L 158,188 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 195,230 L 205,235 L 215,245 L 220,260 L 223,280 L 223,300 L 220,320 L 215,335 L 208,345 L 198,350 L 188,348 L 180,340 L 175,328 L 172,315 L 170,300 L 168,285 L 168,270 L 170,255 L 175,243 L 182,235 L 188,232 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 420,100 L 435,95 L 450,93 L 465,95 L 480,100 L 492,108 L 500,118 L 502,130 L 498,142 L 488,150 L 475,155 L 460,157 L 445,155 L 432,148 L 422,138 L 418,125 L 418,112 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 440,165 L 455,162 L 470,163 L 485,168 L 500,178 L 512,195 L 520,215 L 523,235 L 522,255 L 518,275 L 510,295 L 498,310 L 483,320 L 465,323 L 448,320 L 432,310 L 420,295 L 412,278 L 408,260 L 407,242 L 410,225 L 418,208 L 428,190 L 435,178 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:`M 510,95 L 535,90 L 560,88 L 585,90 L 610,95 L 635,102 L 660,110 L 685,120 L 705,133 L 720,148 L 728,165 L 730,182 L 725,200 L 715,215 L 700,228 L 680,238 L 655,243 L 630,243 L 605,238 L 580,230 L 560,220 L 545,208 L 535,195 L 528,180 L 525,165 L 525,150 L 528,135 L 535,120 L 545,108 L 560,100 L 580,95 L 600,93 Z
                    M 735,145 L 745,150 L 755,158 L 760,168 L 758,178 L 750,183 L 740,180 L 735,172 L 733,162 L 735,152 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 680,290 L 700,288 L 720,290 L 740,295 L 755,303 L 765,315 L 768,328 L 765,340 L 755,348 L 740,352 L 720,353 L 700,350 L 685,343 L 673,333 L 668,320 L 668,308 L 672,298 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 150,390 L 250,385 L 350,387 L 450,390 L 550,388 L 650,390 L 750,392 L 750,410 L 650,415 L 550,413 L 450,415 L 350,413 L 250,415 L 150,413 Z",fill:"#1e40af",opacity:"0.2",stroke:"#3b82f6",strokeWidth:"1"})]}),e.jsxs("g",{className:"threat-indicators",children:[e.jsx("circle",{cx:"165",cy:"130",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"165",cy:"130",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"2s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"2s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"445",cy:"120",r:"4",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"445",cy:"120",r:"8",fill:"none",stroke:"#f59e0b",strokeWidth:"1.5",opacity:"0.5",children:[e.jsx("animate",{attributeName:"r",values:"8;16;8",dur:"3s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.5;0;0.5",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"650",cy:"160",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"1.5s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"650",cy:"160",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"1.5s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"580",cy:"110",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.8s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"455",cy:"240",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"200",cy:"290",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.2s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"720",cy:"320",r:"3",fill:"#10b981",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"600",cy:"195",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.7s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"745",cy:"155",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.3s",repeatCount:"indefinite"})})]}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#1e293b",strokeWidth:"0.5",opacity:"0.2"})}),e.jsxs("linearGradient",{id:"ocean",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#0f172a",stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:"#1e293b",stopOpacity:"0.5"})]})]}),e.jsx("rect",{width:"900",height:"450",fill:"url(#ocean)"}),e.jsx("rect",{width:"900",height:"450",fill:"url(#grid)"})]}),e.jsxs("div",{className:"map-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot critical"}),e.jsx("span",{children:"Critical"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot high"}),e.jsx("span",{children:"High"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot medium"}),e.jsx("span",{children:"Medium"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot low"}),e.jsx("span",{children:"Low"})]})]})]})]}),e.jsxs("div",{className:"soc-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-5 h-5 text-red-400"})," Priority Incidents"]})}),e.jsx("div",{className:"incident-list",children:[{id:"INC-2024-001",title:"Ransomware Activity",severity:"critical",assignee:"Analyst A",time:"10m"},{id:"INC-2024-002",title:"Data Exfiltration",severity:"high",assignee:"Analyst B",time:"45m"},{id:"INC-2024-003",title:"Brute Force Attack",severity:"high",assignee:"Unassigned",time:"1h"},{id:"INC-2024-004",title:"Malware Download",severity:"medium",assignee:"Analyst C",time:"2h"}].map((l,t)=>e.jsxs("div",{className:"incident-item",children:[e.jsx("div",{className:`severity-bar ${l.severity}`}),e.jsxs("div",{className:"incident-content",children:[e.jsxs("div",{className:"incident-top",children:[e.jsx("span",{className:"incident-id",children:l.id}),e.jsxs("span",{className:"incident-time",children:[l.time," ago"]})]}),e.jsx("div",{className:"incident-title",children:l.title}),e.jsxs("div",{className:"incident-assignee",children:[e.jsx(G,{className:"w-3 h-3"})," ",l.assignee]})]})]},t))})]})]})]})]})}const ks=Object.freeze(Object.defineProperty({__proto__:null,default:vs},Symbol.toStringTag,{value:"Module"}));function gs(){const[i,r]=d.useState(null),[m,o]=d.useState([]),[u,j]=d.useState(!0);d.useEffect(()=>{(async()=>{j(!0);try{const n=await L.getFileStats();throw n?(r({totalFiles:n.total_files||0,malicious:n.malicious_count||0,suspicious:n.suspicious_count||0,clean:n.clean_count||0,pending:n.pending_count||0}),new Error("Using mock file list data")):new Error("No file stats available")}catch(n){console.warn("Failed to load file analysis from API, using mock data:",n),r({totalFiles:1245,malicious:23,suspicious:45,clean:1177,pending:5}),o([{id:1,name:"invoice_2023.pdf.exe",type:"PE32 Executable",size:"1.2 MB",source:"192.168.1.105",dest:"10.0.0.5",status:"malicious",score:98,detection:"Trojan.Win32.Emotet",time:"10m ago"},{id:2,name:"powershell_script.ps1",type:"Script",size:"15 KB",source:"192.168.1.112",dest:"10.0.0.5",status:"suspicious",score:75,detection:"Obfuscated Script",time:"45m ago"},{id:3,name:"quarterly_report.docx",type:"Document",size:"4.5 MB",source:"192.168.1.200",dest:"10.0.0.5",status:"clean",score:0,detection:"-",time:"1h ago"},{id:4,name:"unknown_binary.bin",type:"Binary",size:"512 KB",source:"192.168.1.15",dest:"External",status:"pending",score:0,detection:"Analyzing...",time:"2m ago"},{id:5,name:"update.zip",type:"Archive",size:"12 MB",source:"External",dest:"192.168.1.50",status:"malicious",score:100,detection:"Ransomware.LockBit",time:"3h ago"}])}finally{j(!1)}})()},[]);const v=t=>t.includes("Executable")||t.includes("Binary")?e.jsx(ie,{className:"w-4 h-4 text-red-400"}):t.includes("Script")?e.jsx(W,{className:"w-4 h-4 text-yellow-400"}):t.includes("Archive")?e.jsx(qe,{className:"w-4 h-4 text-blue-400"}):e.jsx(ze,{className:"w-4 h-4 text-gray-400"}),s=t=>{switch(t){case"malicious":return e.jsx("span",{className:"status-badge danger",children:"Malicious"});case"suspicious":return e.jsx("span",{className:"status-badge warning",children:"Suspicious"});case"clean":return e.jsx("span",{className:"status-badge success",children:"Clean"});case"pending":return e.jsx("span",{className:"status-badge info",children:"Pending"});default:return e.jsx("span",{className:"status-badge",children:"Unknown"})}},l=[{name:"Executables",count:145},{name:"Scripts",count:89},{name:"Documents",count:450},{name:"Archives",count:120},{name:"Images",count:441}];return u?e.jsx("div",{className:"loading-state",children:"Scanning extracted files..."}):e.jsxs("div",{className:"file-analysis",children:[e.jsxs("div",{className:"file-stats-row",children:[e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(W,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.totalFiles}),e.jsx("div",{className:"stat-label",children:"Files Extracted (24h)"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(B,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.malicious}),e.jsx("div",{className:"stat-label",children:"Malicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.suspicious}),e.jsx("div",{className:"stat-label",children:"Suspicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(A,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.pending}),e.jsx("div",{className:"stat-label",children:"Pending Analysis"})]})]})]}),e.jsxs("div",{className:"file-content-grid",children:[e.jsx("div",{className:"file-left-col",children:e.jsxs("div",{className:"file-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(ie,{className:"w-4 h-4 text-blue-400"})," File Types"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:l,layout:"vertical",margin:{left:40},children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(D,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(_,{dataKey:"name",type:"category",width:80,stroke:"#94a3b8",fontSize:10}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(P,{dataKey:"count",fill:"#3b82f6",radius:[0,4,4,0],children:l.map((t,n)=>e.jsx(U,{fill:["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#10b981"][n%5]},`cell-${n}`))})]})})})]})}),e.jsx("div",{className:"file-right-col",children:e.jsxs("div",{className:"file-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(R,{className:"w-4 h-4 text-orange-400"})," Recent File Analysis"]}),e.jsx("div",{className:"panel-actions",children:e.jsxs("div",{className:"search-input-sm",children:[e.jsx(Y,{className:"w-3 h-3"}),e.jsx("input",{type:"text",placeholder:"Search files..."})]})})]}),e.jsxs("table",{className:"file-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"File Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Detection"}),e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:m.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:s(t.status)}),e.jsxs("td",{children:[e.jsxs("div",{className:"file-name-cell",children:[v(t.type),e.jsx("span",{className:"file-name",children:t.name})]}),e.jsxs("div",{className:"file-meta",children:[t.size," • ",t.source]})]}),e.jsx("td",{className:"text-gray-400",children:t.type}),e.jsx("td",{children:e.jsxs("div",{className:`score-badge ${t.score>80?"critical":t.score>50?"high":"low"}`,children:[t.score,"/100"]})}),e.jsx("td",{style:{color:"#fca5a5"},children:t.detection}),e.jsx("td",{className:"text-gray-500",children:t.time}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",title:"Download Sample",children:e.jsx(ue,{className:"w-4 h-4"})})})]},t.id))})]})]})})]})]})}const Ts=Object.freeze(Object.defineProperty({__proto__:null,default:gs},Symbol.toStringTag,{value:"Module"}));function ps(){const[i,r]=d.useState(null),[m,o]=d.useState([]),[u,j]=d.useState([]),[v,s]=d.useState(!0);d.useEffect(()=>{(async()=>{s(!0);try{const f=await L.getDNSStats();throw f?(r({totalQueries:f.total_queries||0,blockedQueries:f.blocked_queries||0,dgaDomains:f.dga_domains||0,tunnelingAlerts:f.tunneling_alerts||0}),new Error("Using mock data for queries and tunneling events")):new Error("No DNS stats available")}catch(f){console.warn("Failed to load DNS intelligence from API, using mock data:",f),r(ts),o(is),j(ls)}finally{s(!1)}})()},[]);const l=as,t=ss;return v?e.jsx("div",{className:"loading-state",children:"Analyzing DNS traffic..."}):e.jsxs("div",{className:"dns-intelligence",children:[e.jsxs("div",{className:"dns-stats-row",children:[e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[i?.totalQueries?(i.totalQueries/1e3).toFixed(1):0,"k"]}),e.jsx("div",{className:"stat-label",children:"Total Queries (24h)"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(We,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.blockedQueries}),e.jsx("div",{className:"stat-label",children:"Blocked Domains"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.dgaDomains}),e.jsx("div",{className:"stat-label",children:"DGA Detected"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-orange-500/10 text-orange-400",children:e.jsx(R,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:i?.tunnelingAlerts}),e.jsx("div",{className:"stat-label",children:"Tunneling Events"})]})]})]}),e.jsxs("div",{className:"dns-content-grid",children:[e.jsxs("div",{className:"dns-left-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(R,{className:"w-4 h-4 text-blue-400"})," DNS Query Volume (QPS)"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(Ze,{data:t,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(D,{dataKey:"time",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(_,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(Ye,{type:"monotone",dataKey:"qps",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})]}),e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Be,{className:"w-4 h-4 text-purple-400"})," Query Types"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:l,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(D,{dataKey:"name",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(_,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(k,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(P,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})]})]}),e.jsxs("div",{className:"dns-right-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(B,{className:"w-4 h-4 text-red-400"})," DNS Tunneling Detection"]})}),e.jsx("div",{className:"tunnel-list",children:u.map(n=>e.jsxs("div",{className:"tunnel-item",children:[e.jsx("div",{className:"tunnel-icon",children:e.jsx(B,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{className:"tunnel-info",children:[e.jsx("div",{className:"tunnel-domain",children:n.domain}),e.jsxs("div",{className:"tunnel-meta",children:[e.jsx("span",{children:n.method}),e.jsx("span",{children:"•"}),e.jsx("span",{children:n.volume}),e.jsx("span",{children:"•"}),e.jsx("span",{children:n.client})]})]}),e.jsxs("div",{className:"tunnel-confidence",children:[e.jsxs("div",{className:"confidence-val",children:[n.confidence,"%"]}),e.jsx("div",{className:"confidence-lbl",children:"Confidence"})]})]},n.id))})]}),e.jsxs("div",{className:"dns-panel flex-1",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(Y,{className:"w-4 h-4 text-green-400"})," Recent Queries"]}),e.jsx("button",{className:"btn-icon",children:e.jsx(xe,{className:"w-4 h-4"})})]}),e.jsxs("table",{className:"dns-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Domain"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:m.map(n=>e.jsxs("tr",{children:[e.jsxs("td",{children:[n.status==="blocked"&&e.jsx("span",{className:"status-dot blocked",title:"Blocked"}),n.status==="allowed"&&e.jsx("span",{className:"status-dot allowed",title:"Allowed"}),n.status==="flagged"&&e.jsx("span",{className:"status-dot flagged",title:"Flagged"})]}),e.jsx("td",{className:"mono text-white",children:n.domain}),e.jsx("td",{className:"text-gray-400",children:n.type}),e.jsx("td",{className:"mono text-blue-300",children:n.client}),e.jsx("td",{children:e.jsx("span",{className:"category-tag",children:n.category})}),e.jsx("td",{className:"text-gray-500",children:n.time})]},n.id))})]})]})]})]})]})}const As=Object.freeze(Object.defineProperty({__proto__:null,default:ps},Symbol.toStringTag,{value:"Module"}));function Ns({view:i="playbooks"}){const[r,m]=d.useState(i),[o,u]=d.useState([]),[j,v]=d.useState([]),[s,l]=d.useState([]),[t,n]=d.useState(!0);d.useEffect(()=>{m(i)},[i]);const f=c=>{if(!c)return"-";const x=new Date,N=new Date(c),b=x.getTime()-N.getTime(),h=Math.round(b/1e3),w=Math.round(h/60),M=Math.round(w/60),q=Math.round(M/24);return h<60?`${h}s ago`:w<60?`${w}m ago`:M<24?`${M}h ago`:q<7?`${q}d ago`:N.toLocaleDateString()};return d.useEffect(()=>{(async()=>{n(!0);try{const[x,N]=await Promise.all([L.getPlaybooks(),L.getExecutions({limit:10})]);if(x&&Array.isArray(x)&&x.length>0){const b=x.map(h=>({id:h.id,name:h.name||h.title,trigger:h.trigger||"Manual",status:h.status==="active"||h.status==="manual"||h.status==="disabled"?h.status:"manual",runs:h.execution_count||0,successRate:h.success_rate||100,lastRun:f(h.last_execution)}));u(b)}if(N&&Array.isArray(N)&&N.length>0){const b=N.map(h=>({id:h.id,playbook:h.playbook_name||"Unknown",target:h.target||h.alert_id||"N/A",status:h.status==="completed"?"success":h.status==="failed"?"failed":"running",time:f(h.started_at),duration:h.duration||"-"}));l(b)}if((!x||x.length===0)&&(!N||N.length===0))throw new Error("No SOAR data available from API");v([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}])}catch(x){console.warn("Failed to load SOAR data from API, using mock data:",x),u([{id:1,name:"Block Malicious IP (Firewall)",trigger:"Critical Alert",status:"active",runs:145,successRate:98,lastRun:"10m ago"},{id:2,name:"Isolate Host (EDR)",trigger:"Ransomware Detection",status:"active",runs:12,successRate:100,lastRun:"2h ago"},{id:3,name:"Enrich IOCs (VirusTotal)",trigger:"New Artifact",status:"active",runs:1250,successRate:99,lastRun:"1m ago"},{id:4,name:"Reset User Password (AD)",trigger:"Brute Force Success",status:"manual",runs:5,successRate:100,lastRun:"1d ago"},{id:5,name:"Send Slack Notification",trigger:"High Severity",status:"active",runs:450,successRate:100,lastRun:"5m ago"}]),v([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}]),l([{id:101,playbook:"Block Malicious IP",target:"185.22.1.4",status:"success",time:"10m ago",duration:"2s"},{id:102,playbook:"Enrich IOCs",target:"hash: 44d8...2f",status:"success",time:"12m ago",duration:"1.5s"},{id:103,playbook:"Send Slack Notification",target:"#security-ops",status:"success",time:"15m ago",duration:"0.5s"},{id:104,playbook:"Isolate Host",target:"WORKSTATION-04",status:"failed",time:"2h ago",duration:"5s"}])}finally{n(!1)}})()},[]),t?e.jsx("div",{className:"loading-state",children:"Loading automation modules..."}):e.jsxs("div",{className:"soar-integration",children:[e.jsxs("div",{className:"soar-header",children:[e.jsxs("div",{className:"view-selector",children:[e.jsxs("button",{className:`view-btn ${r==="playbooks"?"active":""}`,onClick:()=>m("playbooks"),children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Playbooks & Automation"})]}),e.jsxs("button",{className:`view-btn ${r==="connectors"?"active":""}`,onClick:()=>m("connectors"),children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"SIEM & Connectors"})]})]}),e.jsx("div",{className:"soar-actions",children:e.jsx("button",{className:"btn-primary",children:r==="playbooks"?e.jsxs(e.Fragment,{children:[e.jsx(Ke,{className:"w-4 h-4"})," New Playbook"]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4"})," New Connector"]})})})]}),e.jsx("div",{className:"soar-content",children:r==="playbooks"?e.jsx("div",{className:"playbooks-view",children:e.jsxs("div",{className:"soar-grid",children:[e.jsxs("div",{className:"soar-panel flex-2",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Z,{className:"w-4 h-4 text-yellow-400"})," Active Playbooks"]})}),e.jsxs("table",{className:"soar-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Playbook Name"}),e.jsx("th",{children:"Trigger"}),e.jsx("th",{children:"Success Rate"}),e.jsx("th",{children:"Last Run"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:o.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:`status-pill ${c.status}`,children:c.status})}),e.jsx("td",{className:"font-medium text-white",children:c.name}),e.jsx("td",{className:"text-gray-400",children:c.trigger}),e.jsxs("td",{children:[e.jsx("div",{className:"progress-bar-sm",children:e.jsx("div",{className:"progress-fill",style:{width:`${c.successRate}%`,background:c.successRate>90?"#10b981":"#f59e0b"}})}),e.jsxs("span",{className:"text-xs text-gray-400",children:[c.successRate,"%"]})]}),e.jsx("td",{className:"text-gray-500",children:c.lastRun}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",children:e.jsx(Ue,{className:"w-4 h-4"})})})]},c.id))})]})]}),e.jsxs("div",{className:"soar-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(R,{className:"w-4 h-4 text-blue-400"})," Recent Executions"]})}),e.jsx("div",{className:"history-list",children:s.map(c=>e.jsxs("div",{className:"history-item",children:[e.jsx("div",{className:"history-status",children:c.status==="success"?e.jsx(K,{className:"w-4 h-4 text-green-400"}):e.jsx(Ge,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{className:"history-info",children:[e.jsx("div",{className:"history-name",children:c.playbook}),e.jsx("div",{className:"history-target",children:c.target})]}),e.jsxs("div",{className:"history-meta",children:[e.jsx("div",{children:c.time}),e.jsx("div",{className:"history-dur",children:c.duration})]})]},c.id))})]})]})}):e.jsx("div",{className:"connectors-view",children:e.jsxs("div",{className:"connectors-grid",children:[j.map(c=>e.jsxs("div",{className:"connector-card",children:[e.jsxs("div",{className:"connector-header",children:[e.jsx("div",{className:"connector-icon",children:c.type==="SIEM"?e.jsx(le,{className:"w-6 h-6"}):c.type==="Firewall"?e.jsx(A,{className:"w-6 h-6"}):e.jsx(Qe,{className:"w-6 h-6"})}),e.jsx("div",{className:`connector-status ${c.status}`})]}),e.jsxs("div",{className:"connector-body",children:[e.jsx("h4",{children:c.name}),e.jsx("div",{className:"connector-type",children:c.type}),e.jsxs("div",{className:"connector-stats",children:[e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Latency"}),e.jsx("span",{className:"mono",children:c.latency})]}),e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Throughput"}),e.jsx("span",{className:"mono",children:c.events})]})]})]}),e.jsx("div",{className:"connector-footer",children:e.jsx("button",{className:"btn-secondary full-width",children:"Configure"})})]},c.id)),e.jsx("div",{className:"connector-card add-new",children:e.jsxs("div",{className:"add-content",children:[e.jsx("div",{className:"add-icon",children:e.jsx(ce,{className:"w-8 h-8"})}),e.jsx("span",{children:"Add Integration"})]})})]})})})]})}const Rs=Object.freeze(Object.defineProperty({__proto__:null,default:Ns},Symbol.toStringTag,{value:"Module"}));export{Ls as A,As as D,Ts as F,Cs as S,ks as a,Rs as b};
