import{u as C,j as e}from"./components-core-Bv39ez-c.js";import{r as p,D as A,A as M,N as O,c as L,Z as _,d as R}from"./vendor-icons-B2pXvChz.js";import{a as k}from"./components-dashboard-CLV7lsLK.js";import{R as x,A as E,C as y,X as v,Y as b,T as g,L as D,a as I,P as H,b as B,c as P,B as X,d as $,e as z,f as F}from"./vendor-charts-zYpqy-0r.js";const G=r=>`${r}.${Math.floor(Math.random()*254)+1}`,f=()=>"XX:XX:XX:XX:XX:XX".replace(/X/g,()=>"0123456789ABCDEF".charAt(Math.floor(Math.random()*16))),W=()=>{const r=[],t=[];r.push({id:"internet",ip:"8.8.8.8",name:"Internet",type:"internet",group:"internet",status:"safe",val:20,details:{os:"N/A",mac:"N/A",openPorts:[],lastSeen:"Now"}}),r.push({id:"firewall-core",ip:"10.0.0.1",name:"Core Firewall",type:"firewall",group:"dmz",status:"safe",val:15,details:{os:"Palo Alto PAN-OS",mac:f(),openPorts:[443,22],lastSeen:"Now"}}),t.push({source:"internet",target:"firewall-core",type:"wired",bandwidth:1e3,active:!0,protocol:"HTTPS"}),[{id:"web-server-01",name:"Web Server",ip:"10.0.1.10"},{id:"mail-server-01",name:"Mail Gateway",ip:"10.0.1.20"},{id:"vpn-gateway",name:"VPN Concentrator",ip:"10.0.1.30"}].forEach(a=>{r.push({id:a.id,ip:a.ip,name:a.name,type:"server",group:"dmz",status:Math.random()>.9?"suspicious":"safe",val:10,details:{os:"Ubuntu Linux 22.04",mac:f(),openPorts:[80,443],lastSeen:"Now"}}),t.push({source:"firewall-core",target:a.id,type:"wired",bandwidth:1e3,active:!0,protocol:"TCP"})}),r.push({id:"router-internal",ip:"10.0.2.1",name:"Internal Router",type:"router",group:"lan",status:"safe",val:12,details:{os:"Cisco IOS",mac:f(),openPorts:[22],lastSeen:"Now"}}),t.push({source:"firewall-core",target:"router-internal",type:"wired",bandwidth:1e3,active:!0,protocol:"OSPF"}),[{id:"db-prod-01",name:"Prod DB",ip:"10.0.3.10"},{id:"app-prod-01",name:"App Server 1",ip:"10.0.3.11"},{id:"app-prod-02",name:"App Server 2",ip:"10.0.3.12"},{id:"ad-dc-01",name:"Domain Controller",ip:"10.0.3.50"}].forEach(a=>{r.push({id:a.id,ip:a.ip,name:a.name,type:"server",group:"servers",status:"safe",val:10,details:{os:"Windows Server 2019",mac:f(),openPorts:[445,3389],lastSeen:"Now"}}),t.push({source:"router-internal",target:a.id,type:"wired",bandwidth:1e3,active:!0,protocol:"TCP"})}),t.push({source:"app-prod-01",target:"db-prod-01",type:"wired",bandwidth:1e3,active:!0,protocol:"SQL"}),t.push({source:"app-prod-02",target:"db-prod-01",type:"wired",bandwidth:1e3,active:!0,protocol:"SQL"});const c=15;for(let a=1;a<=c;a++){const d=Math.random()>.95,S=!d&&Math.random()>.9,u=`pc-${a.toString().padStart(3,"0")}`;if(r.push({id:u,ip:G("10.0.10"),name:`Workstation ${a}`,type:"endpoint",group:"lan",status:d?"compromised":S?"suspicious":"safe",val:5,details:{os:"Windows 11 Pro",mac:f(),openPorts:[135,445],lastSeen:"Now"}}),t.push({source:"router-internal",target:u,type:"wired",bandwidth:100,active:Math.random()>.3,protocol:"HTTPS"}),d){const w=`pc-${Math.floor(Math.random()*c+1).toString().padStart(3,"0")}`;w!==u&&t.push({source:u,target:w,type:"wireless",bandwidth:10,active:!0,protocol:"SMB"})}}return{nodes:r,links:t}},K=[{id:"INC-2023-001",title:"Potential Data Exfiltration to Unknown IP",severity:"Critical",status:"Investigating",assignee:"Alex D.",created_at:new Date(Date.now()-864e5*2).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString(),description:"Large volume of encrypted traffic detected leaving the Finance subnet towards an uncategorized external IP address (45.33.22.11). Pattern matches known C2 beaconing behavior.",affected_assets:["10.0.3.15 (Finance-DB)","10.0.3.1 (Gateway)"],related_alerts:12,tags:["Exfiltration","C2","Finance"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-864e5*2).toISOString(),content:"Incident created from Alert #4421"},{id:"t2",type:"status_change",user:"Alex D.",timestamp:new Date(Date.now()-864e5*1.8).toISOString(),content:"Status changed to Investigating"},{id:"t3",type:"comment",user:"Alex D.",timestamp:new Date(Date.now()-864e5*1.5).toISOString(),content:"Initial analysis confirms traffic is non-standard SSL. IP reputation check is inconclusive but suspicious."},{id:"t4",type:"comment",user:"Sarah J.",timestamp:new Date(Date.now()-864e5*.5).toISOString(),content:"I saw similar traffic patterns last week on the Engineering subnet. Might be related."}]},{id:"INC-2023-002",title:"Ransomware Behavior Detected on Workstation",severity:"High",status:"New",assignee:null,created_at:new Date(Date.now()-144e5).toISOString(),updated_at:new Date(Date.now()-144e5).toISOString(),description:"Rapid file encryption activities detected on endpoint pc-042. High IOPS and modification of file extensions to .enc.",affected_assets:["pc-042","file-share-01"],related_alerts:5,tags:["Ransomware","Endpoint","Urgent"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-144e5).toISOString(),content:"Incident created from Alert #5502"}]},{id:"INC-2023-003",title:"Suspicious PowerShell Execution",severity:"Medium",status:"Resolved",assignee:"Mike R.",created_at:new Date(Date.now()-864e5*5).toISOString(),updated_at:new Date(Date.now()-864e5*4).toISOString(),description:"Encoded PowerShell command executed on Web Server. Determined to be part of scheduled maintenance script but flagged due to encoding.",affected_assets:["web-server-01"],related_alerts:1,tags:["PowerShell","False Positive"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-864e5*5).toISOString(),content:"Incident created"},{id:"t2",type:"comment",user:"Mike R.",timestamp:new Date(Date.now()-864e5*4.5).toISOString(),content:"Checked with DevOps team. This is the weekly backup script."},{id:"t3",type:"status_change",user:"Mike R.",timestamp:new Date(Date.now()-864e5*4).toISOString(),content:"Status changed to Resolved"}]},{id:"INC-2023-004",title:"Brute Force Attempt via SSH",severity:"Low",status:"New",assignee:null,created_at:new Date(Date.now()-36e5).toISOString(),updated_at:new Date(Date.now()-36e5).toISOString(),description:"Multiple failed login attempts (200+) from external IP 192.168.1.50 against SSH service.",affected_assets:["bastion-host"],related_alerts:1,tags:["Brute Force","SSH"],timeline:[{id:"t1",type:"status_change",user:"System",timestamp:new Date(Date.now()-36e5).toISOString(),content:"Incident created"}]}];class U{async getDashboardAnalytics(){return await new Promise(t=>setTimeout(t,400)),{summary:{total_events:12450,critical_alerts:5,open_alerts:12,assets_count:48}}}async getTopologyData(){return await new Promise(t=>setTimeout(t,500)),W()}async getIncidents(){return await new Promise(t=>setTimeout(t,300)),K}async createIncident(t){return await new Promise(s=>setTimeout(s,600)),{id:`INC-${new Date().getFullYear()}-${Math.floor(Math.random()*1e3)}`,title:t.title||"New Incident",severity:t.severity||"Medium",status:"New",assignee:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),description:t.description||"",affected_assets:t.affected_assets||[],related_alerts:0,tags:[],timeline:[{id:`t-${Date.now()}`,type:"status_change",user:"System",timestamp:new Date().toISOString(),content:"Incident created"}]}}async updateIncidentStatus(t,l){await new Promise(s=>setTimeout(s,300)),console.log(`Updated incident ${t} to ${l}`)}async getTrafficStats(t){await new Promise(a=>setTimeout(a,500));const l=[],s=new Date,c=t==="1h"?12:24;for(let a=c;a>=0;a--)l.push({time:new Date(s.getTime()-a*(t==="1h"?3e5:36e5)).getHours()+":00",inbound:Math.floor(Math.random()*500)+200,outbound:Math.floor(Math.random()*300)+100});return l}async getProtocolStats(){return await new Promise(t=>setTimeout(t,400)),[{name:"HTTPS",value:45},{name:"DNS",value:15},{name:"HTTP",value:12},{name:"SSH",value:8},{name:"SMB",value:5},{name:"Other",value:15}]}async getTopTalkers(){return await new Promise(t=>setTimeout(t,600)),[{ip:"192.168.1.105",bytes:"4.2 GB",flows:12450,risk:"High"},{ip:"192.168.1.200",bytes:"2.1 GB",flows:8540,risk:"Medium"},{ip:"192.168.1.15",bytes:"1.8 GB",flows:6200,risk:"Low"},{ip:"10.0.0.5",bytes:"950 MB",flows:4100,risk:"Low"},{ip:"172.16.0.25",bytes:"500 MB",flows:1200,risk:"Critical"}]}async chatWithAI(t,l){await new Promise(c=>setTimeout(c,1e3));const s=t.toLowerCase();return s.includes("alert")||s.includes("critical")?{response:"I found 5 critical alerts in the last hour. The most concerning is a potential C2 communication from 192.168.1.112. Would you like me to create an incident for this?"}:s.includes("traffic")||s.includes("bandwidth")?{response:"Network traffic is currently stable at 1.2 Gbps. However, I noticed a 15% spike in outbound traffic from the DMZ subnet 20 minutes ago."}:s.includes("ip")||s.includes("192.168")?{response:"That IP address (192.168.1.105) has been flagged for suspicious PowerShell activity. It has communicated with 3 external malicious IPs in the last 24 hours."}:{response:"I'm monitoring the network. Everything looks nominal right now. You can ask me about specific alerts, IPs, or traffic trends."}}}const j=new U,T=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];function Y(){const{addToast:r}=C(),[t,l]=p.useState("24h"),[s,c]=p.useState([]),[a,d]=p.useState([]),[S,u]=p.useState([]),[w,N]=p.useState(!0);return p.useEffect(()=>{(async()=>{N(!0);try{const n=await k.getTrafficStats(t),h=await k.getProtocolStats();if(n&&Array.isArray(n)){const m=n.map(o=>({time:new Date(o.timestamp).getHours()+":00",inbound:Math.floor(o.bytes/1024/1024),outbound:Math.floor(o.bytes/1024/1024*.6)}));c(m)}else throw new Error("Invalid traffic response");if(h&&Array.isArray(h)){const m=h.slice(0,6).map(o=>({name:o.protocol||o.name,value:o.count||o.value}));d(m)}else throw new Error("Invalid protocol response")}catch{console.warn("Failed to load network analytics from API, using mock data");const h=await j.getTrafficStats(t);c(h);const m=await j.getProtocolStats();d(m);const o=await j.getTopTalkers();u(o)}finally{N(!1)}})()},[t]),w?e.jsx("div",{className:"loading-state",children:"Loading network analytics..."}):e.jsxs("div",{className:"network-analytics",children:[e.jsxs("div",{className:"analytics-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"Network Traffic Analysis"}),e.jsxs("span",{className:"live-badge",children:[e.jsx("span",{className:"pulse-dot"})," Live"]})]}),e.jsxs("div",{className:"header-controls",children:[e.jsxs("select",{value:t,onChange:i=>l(i.target.value),className:"control-select",children:[e.jsx("option",{value:"1h",children:"Last 1 Hour"}),e.jsx("option",{value:"6h",children:"Last 6 Hours"}),e.jsx("option",{value:"24h",children:"Last 24 Hours"}),e.jsx("option",{value:"7d",children:"Last 7 Days"})]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(A,{className:"w-4 h-4"})," Export Report"]})]})]}),e.jsxs("div",{className:"charts-row",children:[e.jsxs("div",{className:"chart-card wide",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{children:[e.jsx(M,{className:"w-4 h-4 text-blue-400"})," Traffic Volume (Mbps)"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(E,{data:s,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorIn",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorOut",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(v,{dataKey:"time",stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(b,{stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(g,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},itemStyle:{color:"#e2e8f0"}}),e.jsx(D,{}),e.jsx(I,{type:"monotone",dataKey:"inbound",stroke:"#3b82f6",fillOpacity:1,fill:"url(#colorIn)",name:"Inbound"}),e.jsx(I,{type:"monotone",dataKey:"outbound",stroke:"#10b981",fillOpacity:1,fill:"url(#colorOut)",name:"Outbound"})]})})})]}),e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{children:[e.jsx(O,{className:"w-4 h-4 text-purple-400"})," Protocol Distribution"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(H,{children:[e.jsx(B,{data:a,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:a.map((i,n)=>e.jsx(P,{fill:T[n%T.length]},`cell-${n}`))}),e.jsx(g,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(D,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]}),e.jsxs("div",{className:"charts-row",children:[e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{children:[e.jsx(L,{className:"w-4 h-4 text-red-400"})," Alert Severity"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(X,{data:[{name:"Critical",value:5,color:"#ef4444"},{name:"High",value:12,color:"#f59e0b"},{name:"Medium",value:25,color:"#3b82f6"},{name:"Low",value:45,color:"#10b981"}],children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(v,{dataKey:"name",stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(b,{stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(g,{cursor:{fill:"#334155",opacity:.2},contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx($,{dataKey:"value",radius:[4,4,0,0],children:[{name:"Critical",value:5,color:"#ef4444"},{name:"High",value:12,color:"#f59e0b"},{name:"Medium",value:25,color:"#3b82f6"},{name:"Low",value:45,color:"#10b981"}].map((i,n)=>e.jsx(P,{fill:i.color},`cell-${n}`))})]})})})]}),e.jsxs("div",{className:"chart-card wide",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{children:[e.jsx(_,{className:"w-4 h-4 text-yellow-400"})," Events Per Second (EPS)"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsxs(z,{data:s,children:[e.jsx(y,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(v,{dataKey:"time",stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(b,{stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(g,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(F,{type:"monotone",dataKey:"inbound",stroke:"#f59e0b",strokeWidth:2,dot:!1,name:"EPS"})]})})})]})]}),e.jsxs("div",{className:"data-row",children:[e.jsxs("div",{className:"data-card wide",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{children:[e.jsx(R,{className:"w-4 h-4 text-orange-400"})," Top Talkers"]}),e.jsx("button",{className:"btn-text",children:"View All"})]}),e.jsxs("table",{className:"analytics-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"Total Bytes"}),e.jsx("th",{children:"Flows"}),e.jsx("th",{children:"Risk Level"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:S.map((i,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"mono text-cyan-400",children:i.ip}),e.jsx("td",{children:i.bytes}),e.jsx("td",{children:i.flows.toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:`risk-badge ${i.risk.toLowerCase()}`,children:i.risk})}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",onClick:()=>r(`Analyzing traffic for ${i.ip}...`,"info"),children:"Analyze"})})]},n))})]})]}),e.jsxs("div",{className:"stats-column",children:[e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-label",children:"Total Bandwidth"}),e.jsx("div",{className:"stat-number",children:"1.2 Gbps"}),e.jsx("div",{className:"stat-trend up",children:"↑ 15% peak"})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-label",children:"Active Connections"}),e.jsx("div",{className:"stat-number",children:"24,502"}),e.jsx("div",{className:"stat-trend neutral",children:"~ Stable"})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-label",children:"Unique IPs"}),e.jsx("div",{className:"stat-number",children:"1,892"}),e.jsx("div",{className:"stat-trend up",children:"↑ 12 new"})]})]})]})]})}const J=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{J as N,j as m};
