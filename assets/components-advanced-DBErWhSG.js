import{j as e}from"./components-core-CY16gyg_.js";import{r as c,S as M,C as G,A as D,b as K,u as we,F as H,v as Le,d as ke,D as re,e as V,w as de,x as Ce,X as Ae,y as Re,z as Me,B as De,T as z,G as Z,K as Ee,a as Te,c as _e,U as W,t as Pe,J as ee,O as Oe,Q as Ie,V as Fe,Z as Q,i as He,s as se,P as ze,L as ae,Y as $e,m as Be,l as We}from"./vendor-icons-i_12PHAW.js";import{a as w}from"./components-dashboard-DfAA_F55.js";import{R as C,P as oe,c as he,d as Y,T as A,L as F,B as $,C as E,X as T,Y as _,a as O,A as Ue,b as U,e as Ke,f as Qe}from"./vendor-charts-dUPD06Lp.js";import{m as Ge,a as Ve,b as Ze,c as Ye,d as Xe,e as qe,f as Je,g as es}from"./components-features-B-9YBvvI.js";const te={Malware:["Trojan","Backdoor","RAT","Botnet","Cryptominer"],Exploit:["RCE","SQLi","XSS","Buffer Overflow","Code Injection"],Phishing:["Credential Harvesting","Fake Login","CEO Fraud"],Scan:["Port Scan","Vuln Scan","Network Mapping"],Policy:["Unauthorized Access","Data Exfiltration","Suspicious Traffic"]},ie={Ransomware:["WannaCry","Ryuk","Lockbit","BlackCat"],APT:["APT28","APT29","Lazarus","Equation Group"],Webshell:["PHP Shell","JSP Shell","ASPX Shell"],Script:["Obfuscated PowerShell","Malicious VBS","JavaScript Dropper"],"Credential Theft":["Mimikatz","LaZagne","Password Dumper"]},le={Execution:["Process Creation","Command Line","Scripting"],Persistence:["Registry","Scheduled Task","Startup"],"Defense Evasion":["Clear Logs","Disable Security","Obfuscation"],"Credential Access":["Credential Dumping","Brute Force"],Discovery:["Network Discovery","System Info","Account Discovery"]},ss={Windows:.4,Linux:.3,Web:.25,Cloud:.15,Network:.2,Database:.1,Email:.05};function X(a=365){const r=new Date;return r.setDate(r.getDate()-Math.floor(Math.random()*a)),r.toISOString().split("T")[0]}function q(){const a=Object.keys(ss),r=Math.floor(Math.random()*3)+1,d=[];for(let o=0;o<r;o++){const u=a[Math.floor(Math.random()*a.length)];d.includes(u)||d.push(u)}return d}function as(a){const r=[],d=Object.keys(te),o=["Low","Medium","High","Critical"];for(let u=0;u<a;u++){const p=d[Math.floor(Math.random()*d.length)],v=te[p],m=v[Math.floor(Math.random()*v.length)],h=o[Math.floor(Math.random()*o.length)];r.push({id:2e6+u,name:`ET ${p.toUpperCase()} ${m}`,description:`Detects ${m.toLowerCase()} activity in network traffic`,category:p,severity:h,status:Math.random()>.7?"enabled":"disabled",hits:Math.floor(Math.random()*1e3),updated:X(),technology:q(),ruleType:"suricata"})}return r}function ts(a){const r=[],d=Object.keys(ie),o=["Medium","High","Critical"];for(let u=0;u<a;u++){const p=d[Math.floor(Math.random()*d.length)],v=ie[p],m=v[Math.floor(Math.random()*v.length)],h=o[Math.floor(Math.random()*o.length)];r.push({id:`yara-${String(u+1).padStart(4,"0")}`,name:`MALW_${m.replace(/\s/g,"_")}`,description:`Signature for ${m} malware family`,category:p,severity:h,status:Math.random()>.8?"enabled":"disabled",hits:Math.floor(Math.random()*50),updated:X(180),technology:q(),ruleType:"yara"})}return r}function is(a){const r=[],d=Object.keys(le),o=["Low","Medium","High","Critical"];for(let u=0;u<a;u++){const p=d[Math.floor(Math.random()*d.length)],v=le[p],m=v[Math.floor(Math.random()*v.length)],h=o[Math.floor(Math.random()*o.length)];r.push({id:`sigma-${String(u+1).padStart(4,"0")}`,name:`${p}: ${m}`,description:`Detects suspicious ${m.toLowerCase()} behavior`,category:p,severity:h,status:Math.random()>.75?"enabled":"disabled",hits:Math.floor(Math.random()*200),updated:X(90),technology:q(),ruleType:"sigma"})}return r}function ls(){const a=as(3e3),r=ts(1500),d=is(500);return[...a,...r,...d]}function ns(){const[a,r]=c.useState("suricata"),[d,o]=c.useState([]),[u,p]=c.useState([]),[v,m]=c.useState(!0),[h,i]=c.useState(null),[n,b]=c.useState(""),[t,x]=c.useState(""),[y,f]=c.useState(!1),[l,S]=c.useState(new Set),[R,I]=c.useState(!1),[L,B]=c.useState({category:"all",severity:"all",technology:"all",status:"all"}),[J,ue]=c.useState(!1),me=s=>{if(typeof s=="number")return s>=1&&s<=3?"Critical":s===4?"High":s===5?"Medium":"Low";switch(String(s).toLowerCase()){case"critical":return"Critical";case"high":return"High";case"medium":return"Medium";case"low":return"Low";default:return"Informational"}},xe=s=>{if(!s)return"N/A";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return s}},je=()=>{m(!0);const s=ls();p(s),ue(!0);const k=s.filter(g=>g.ruleType===a).map(g=>({id:g.id,name:g.name,category:g.category,severity:g.severity,status:g.status,hits:g.hits,updated:g.updated}));o(k),i({totalRules:s.length,activeRules:s.filter(g=>g.status==="enabled").length,recentHits:s.reduce((g,j)=>g+j.hits,0),lastUpdate:"Just now"}),m(!1)},pe=()=>{l.size===P.length?S(new Set):S(new Set(P.map(s=>s.id)))},ge=()=>{o(d.map(s=>l.has(s.id)?{...s,status:"enabled"}:s)),S(new Set)},ve=()=>{o(d.map(s=>l.has(s.id)?{...s,status:"disabled"}:s)),S(new Set)},Ne=()=>{o(d.map(s=>s.severity==="Critical"?{...s,status:"enabled"}:s))},ye=()=>{o(d.map(s=>s.severity==="Critical"||s.severity==="High"&&(s.category.includes("Malware")||s.category.includes("Exploit")||s.category.includes("Ransomware"))?{...s,status:"enabled"}:s))},fe=()=>{o(d.map(s=>({...s,status:"disabled"}))),S(new Set)};c.useEffect(()=>{(async()=>{m(!0);try{if(a==="editor"){const g=await w.getSuricataRules();x(g.rules||""),m(!1);return}const[N,k]=await Promise.all([w.getDetectionRules(),w.getDetectionStats().catch(()=>null)]);if(N&&Array.isArray(N)){const g=N.filter(j=>a==="suricata"?j.type==="suricata"||j.type==="ids":a==="yara"?j.type==="yara":a==="sigma"?j.type==="sigma":!0).map(j=>({id:j.id||j.sid,name:j.name||j.msg,category:j.category||"Unclassified",severity:me(j.severity||j.priority),status:j.enabled?"enabled":"disabled",hits:j.hit_count||0,updated:xe(j.updated_at||j.last_modified)}));o(g),i(k?{totalRules:k.total_rules||g.length,activeRules:k.active_rules||g.filter(j=>j.status==="enabled").length,recentHits:k.recent_hits||0,lastUpdate:k.last_update||"10m ago"}:{totalRules:g.length,activeRules:g.filter(j=>j.status==="enabled").length,recentHits:0,lastUpdate:"Just now"})}else throw new Error("Invalid rules response")}catch(N){console.warn("Failed to load detection rules from API, using mock data:",N),i({totalRules:15420,activeRules:12850,recentHits:452,lastUpdate:"10m ago"}),o(a==="suricata"?[{id:2010983,name:"ET MALWARE Cobalt Strike Beacon",category:"Malware",severity:"Critical",status:"enabled",hits:124,updated:"2023-11-15"},{id:2025641,name:"ET EXPLOIT Apache Log4j RCE",category:"Exploit",severity:"Critical",status:"enabled",hits:45,updated:"2023-10-01"},{id:2001219,name:"ET SCAN Nmap Scripting Engine",category:"Scan",severity:"Medium",status:"enabled",hits:1250,updated:"2023-09-20"},{id:2014752,name:"ET POLICY Suspicious Inbound to Oracle SQL",category:"Policy",severity:"High",status:"disabled",hits:0,updated:"2023-08-15"},{id:2031450,name:"ET PHISHING Successful Generic Phish",category:"Phishing",severity:"High",status:"enabled",hits:12,updated:"2023-11-20"}]:a==="yara"?[{id:"yara-001",name:"SUSP_PowerShell_Obfuscated",category:"Script",severity:"High",status:"enabled",hits:8,updated:"2023-11-10"},{id:"yara-002",name:"MALW_Ransomware_WannaCry",category:"Ransomware",severity:"Critical",status:"enabled",hits:0,updated:"2023-05-12"},{id:"yara-003",name:"WEBSHELL_PHP_Generic",category:"Webshell",severity:"Critical",status:"enabled",hits:2,updated:"2023-10-05"},{id:"yara-004",name:"APT_Tool_Mimikatz_Memory",category:"Credential Theft",severity:"High",status:"disabled",hits:0,updated:"2023-09-01"}]:[{id:"sigma-001",name:"Suspicious Process Creation via WMI",category:"Execution",severity:"High",status:"enabled",hits:15,updated:"2023-11-18"},{id:"sigma-002",name:"Clear Windows Event Logs",category:"Defense Evasion",severity:"Medium",status:"enabled",hits:3,updated:"2023-10-22"}])}finally{m(!1)}})()},[a]);const be=async()=>{f(!0);try{await w.updateSuricataRules(t)}catch(s){console.error("Failed to save rules:",s)}finally{f(!1)}},Se=s=>{o(d.map(N=>N.id===s?{...N,status:N.status==="enabled"?"disabled":"enabled"}:N))},P=d.filter(s=>{const N=s.name.toLowerCase().includes(n.toLowerCase())||s.category.toLowerCase().includes(n.toLowerCase())||s.id.toString().includes(n),k=L.category==="all"||s.category===L.category,g=L.severity==="all"||s.severity===L.severity,j=L.status==="all"||s.status===L.status;return N&&k&&g&&j});return e.jsxs("div",{className:"advanced-detection",children:[e.jsxs("div",{className:"detection-stats-row",children:[e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h?.totalRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Total Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(G,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h?.activeRules.toLocaleString()}),e.jsx("div",{className:"stat-label",children:"Active Rules"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h?.recentHits}),e.jsx("div",{className:"stat-label",children:"Hits (24h)"})]})]}),e.jsxs("div",{className:"detection-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(K,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h?.lastUpdate}),e.jsx("div",{className:"stat-label",children:"Last Update"})]})]})]}),e.jsxs("div",{className:"detection-content",children:[e.jsxs("div",{className:"detection-sidebar",children:[e.jsxs("button",{className:`sidebar-item ${a==="suricata"?"active":""}`,onClick:()=>r("suricata"),children:[e.jsx(we,{className:"w-4 h-4"}),e.jsx("span",{children:"Suricata IDS"})]}),e.jsxs("button",{className:`sidebar-item ${a==="yara"?"active":""}`,onClick:()=>r("yara"),children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"YARA Rules"})]}),e.jsxs("button",{className:`sidebar-item ${a==="sigma"?"active":""}`,onClick:()=>r("sigma"),children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{children:"Sigma Rules"})]}),e.jsxs("button",{className:`sidebar-item ${a==="editor"?"active":""}`,onClick:()=>r("editor"),children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("span",{children:"Rule Editor"})]})]}),e.jsx("div",{className:"rules-panel",children:a==="editor"?e.jsxs("div",{className:"rule-editor-container",children:[e.jsxs("div",{className:"panel-controls",children:[e.jsx("h3",{children:"Suricata Rules File (suricata.rules)"}),e.jsx("div",{className:"control-actions",children:e.jsxs("button",{className:"btn-primary",onClick:be,disabled:y,children:[y?e.jsx(K,{className:"w-4 h-4 animate-spin"}):e.jsx(ke,{className:"w-4 h-4"}),y?"Saving...":"Save Rules"]})})]}),e.jsx("textarea",{className:"rule-editor-textarea",value:t,onChange:s=>x(s.target.value),spellCheck:"false"})]}):e.jsxs(e.Fragment,{children:[!J&&e.jsxs("div",{className:"load-library-prompt",children:[e.jsxs("button",{className:"btn-load-library",onClick:je,children:[e.jsx(re,{className:"w-5 h-5"}),"Load Rule Library (5,000 Rules)"]}),e.jsx("p",{children:"Load comprehensive detection rules from Suricata ET, YARA, and Sigma"})]}),e.jsxs("div",{className:"panel-controls",children:[e.jsxs("div",{className:"search-input",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search rules by name, ID, or category...",value:n,onChange:s=>b(s.target.value)})]}),e.jsxs("div",{className:"control-actions",children:[e.jsxs("button",{className:"btn-secondary",onClick:()=>I(!R),children:[e.jsx(de,{className:"w-4 h-4"}),R?"Hide Filters":"Filters"]}),e.jsxs("button",{className:"btn-primary",children:[e.jsx(Ce,{className:"w-4 h-4"})," Add Rule"]})]})]}),l.size>0&&e.jsxs("div",{className:"bulk-actions-toolbar",children:[e.jsx("div",{className:"bulk-info",children:e.jsxs("span",{children:[l.size," rule",l.size!==1?"s":""," selected"]})}),e.jsxs("div",{className:"bulk-buttons",children:[e.jsx("button",{className:"btn-sm btn-success",onClick:ge,children:"Enable Selected"}),e.jsx("button",{className:"btn-sm btn-danger",onClick:ve,children:"Disable Selected"}),e.jsxs("button",{className:"btn-sm btn-secondary",onClick:()=>S(new Set),children:[e.jsx(Ae,{className:"w-4 h-4"})," Clear Selection"]})]})]}),J&&e.jsxs("div",{className:"quick-actions",children:[e.jsx("button",{className:"btn-quick",onClick:Ne,children:"Enable All Critical"}),e.jsx("button",{className:"btn-quick",onClick:ye,children:"Enable Recommended"}),e.jsx("button",{className:"btn-quick",onClick:fe,children:"Disable All"})]}),R&&e.jsx("div",{className:"filter-panel",children:e.jsxs("div",{className:"filter-row",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Category"}),e.jsxs("select",{value:L.category,onChange:s=>B({...L,category:s.target.value}),children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"Malware",children:"Malware"}),e.jsx("option",{value:"Exploit",children:"Exploit"}),e.jsx("option",{value:"Phishing",children:"Phishing"}),e.jsx("option",{value:"Ransomware",children:"Ransomware"}),e.jsx("option",{value:"Scan",children:"Scan"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Severity"}),e.jsxs("select",{value:L.severity,onChange:s=>B({...L,severity:s.target.value}),children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"Critical",children:"Critical"}),e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{value:L.status,onChange:s=>B({...L,status:s.target.value}),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"enabled",children:"Enabled"}),e.jsx("option",{value:"disabled",children:"Disabled"})]})]})]})}),e.jsx("div",{className:"rules-table-container",children:v?e.jsx("div",{className:"loading-state",children:"Loading rules..."}):e.jsxs("table",{className:"rules-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"},children:e.jsx("input",{type:"checkbox",checked:l.size===P.length&&P.length>0,onChange:pe})}),e.jsx("th",{style:{width:"60px"},children:"Status"}),e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Rule Name"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Hits"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:P.map(s=>e.jsxs("tr",{className:s.status==="disabled"?"disabled-row":"",children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:l.has(s.id),onChange:()=>{const N=new Set(l);N.has(s.id)?N.delete(s.id):N.add(s.id),S(N)}})}),e.jsx("td",{children:e.jsx("button",{className:`toggle-btn ${s.status}`,onClick:()=>Se(s.id),children:s.status==="enabled"?e.jsx(Re,{className:"w-6 h-6 text-green-400"}):e.jsx(Me,{className:"w-6 h-6 text-gray-500"})})}),e.jsx("td",{className:"mono text-gray-400",children:s.id}),e.jsx("td",{className:"rule-name",children:s.name}),e.jsx("td",{children:e.jsx("span",{className:"category-badge",children:s.category})}),e.jsx("td",{children:e.jsx("span",{className:`severity-badge ${s.severity.toLowerCase()}`,children:s.severity})}),e.jsx("td",{className:"mono",children:s.hits.toLocaleString()}),e.jsx("td",{className:"text-gray-500",children:s.updated}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Edit"})})]},s.id))})]})})]})})]})]})}const gs=Object.freeze(Object.defineProperty({__proto__:null,default:ns},Symbol.toStringTag,{value:"Module"})),ne=["#10b981","#3b82f6","#f59e0b","#ef4444","#8b5cf6"];function cs(){const[a,r]=c.useState(null),[d,o]=c.useState([]),[u,p]=c.useState([]),[v,m]=c.useState([]),[h,i]=c.useState(!0),n=t=>t.is_expired?"expired":t.is_weak_key?"weak":t.is_valid?"valid":"unknown",b=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}):"N/A";return c.useEffect(()=>{(async()=>{i(!0);try{const x=await w.getSSLStats();let y=null;try{const f=await w.getSensors({limit:1});if(f&&f.sensors&&f.sensors.length>0){const l=f.sensors[0].id;y=await w.getSensorCertificates(l)}}catch(f){console.warn("Could not fetch certificate data:",f)}if(x||y){if(r({totalConnections:x?.total_connections||0,securePercentage:x?.secure_percentage||0,expiredCerts:x?.expiring_soon||y?.expired_count||0,weakCiphers:x?.weak_ciphers||0}),y&&y.certificates){const f=y.certificates.map((l,S)=>({id:l.id||S+1,subject:l.subject||l.common_name||"Unknown",issuer:l.issuer||"Unknown",type:l.key_type||"RSA 2048",status:n(l),expiry:b(l.not_after||l.expiry)}));m(f)}throw new Error("Using mock data for TLS versions and ciphers")}else throw new Error("No SSL data available")}catch(x){console.warn("Failed to load SSL analysis from API, using mock data:",x),r({totalConnections:452890,securePercentage:98.2,expiredCerts:12,weakCiphers:450}),o([{name:"TLS 1.3",value:65},{name:"TLS 1.2",value:30},{name:"TLS 1.1",value:3},{name:"TLS 1.0",value:1},{name:"SSLv3",value:1}]),p([{name:"TLS_AES_128_GCM_SHA256",count:15e4},{name:"TLS_AES_256_GCM_SHA384",count:12e4},{name:"ECDHE-RSA-AES128-GCM-SHA256",count:8e4},{name:"ECDHE-RSA-AES256-GCM-SHA384",count:6e4},{name:"Other",count:42890}]),m([{id:1,subject:"internal-db.corp.local",issuer:"Corp-CA",type:"Self-signed",status:"expired",expiry:"2023-11-01"},{id:2,subject:"legacy-app.corp.local",issuer:"Corp-CA",type:"RSA 1024",status:"weak",expiry:"2024-05-15"},{id:3,subject:"test-env.dev",issuer:"Dev-CA",type:"Self-signed",status:"valid",expiry:"2024-12-20"},{id:4,subject:"payment-gateway.corp",issuer:"DigiCert",type:"RSA 2048",status:"valid",expiry:"2025-01-10"},{id:5,subject:"vpn.corp.net",issuer:"Let's Encrypt",type:"ECDSA",status:"valid",expiry:"2024-02-28"}])}finally{i(!1)}})()},[]),h?e.jsx("div",{className:"loading-state",children:"Analyzing SSL/TLS traffic..."}):e.jsxs("div",{className:"ssl-analysis",children:[e.jsxs("div",{className:"ssl-stats-row",children:[e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(De,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.securePercentage,"%"]}),e.jsx("div",{className:"stat-label",children:"Encrypted Traffic"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.expiredCerts}),e.jsx("div",{className:"stat-label",children:"Expired Certs"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.weakCiphers}),e.jsx("div",{className:"stat-label",children:"Weak Ciphers"})]})]}),e.jsxs("div",{className:"ssl-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.totalConnections?(a.totalConnections/1e3).toFixed(1):0,"k"]}),e.jsx("div",{className:"stat-label",children:"Total Connections"})]})]})]}),e.jsxs("div",{className:"ssl-content-grid",children:[e.jsxs("div",{className:"ssl-charts-col",children:[e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Ee,{className:"w-4 h-4 text-blue-400"})," TLS Version Distribution"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(oe,{children:[e.jsx(he,{data:d,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:d.map((t,x)=>e.jsx(Y,{fill:ne[x%ne.length]},`cell-${x}`))}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(F,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]}),e.jsxs("div",{className:"ssl-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(M,{className:"w-4 h-4 text-purple-400"})," Top Cipher Suites"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:u,layout:"vertical",margin:{left:40},children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(T,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(_,{dataKey:"name",type:"category",width:150,stroke:"#94a3b8",fontSize:10}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(O,{dataKey:"count",fill:"#8b5cf6",radius:[0,4,4,0]})]})})})]})]}),e.jsx("div",{className:"ssl-table-col",children:e.jsxs("div",{className:"ssl-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(H,{className:"w-4 h-4 text-orange-400"})," Certificate Hygiene"]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(K,{className:"w-3 h-3"})," Scan"]})]}),e.jsxs("table",{className:"ssl-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Subject (CN)"}),e.jsx("th",{children:"Issuer"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Expiry"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:v.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{children:[t.status==="valid"&&e.jsx("span",{className:"status-badge success",children:"Valid"}),t.status==="expired"&&e.jsx("span",{className:"status-badge danger",children:"Expired"}),t.status==="weak"&&e.jsx("span",{className:"status-badge warning",children:"Weak"})]}),e.jsx("td",{className:"mono text-white",children:t.subject}),e.jsx("td",{className:"text-gray-400",children:t.issuer}),e.jsx("td",{className:"text-gray-400",children:t.type}),e.jsx("td",{className:"mono text-gray-400",children:t.expiry}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",children:"Details"})})]},t.id))})]})]})})]})]})}const vs=Object.freeze(Object.defineProperty({__proto__:null,default:cs},Symbol.toStringTag,{value:"Module"})),ce=["#3b82f6","#10b981","#f59e0b","#ef4444"];function rs(){const[a,r]=c.useState({openCritical:12,mttr:"18m",analystsOnline:"4/6",slaCompliance:98.5}),[d,o]=c.useState([]),[u,p]=c.useState([]),[v,m]=c.useState([]);return c.useEffect(()=>{(async()=>{try{const i=await w.getSocMetrics(),n=await w.getDashboardStats();throw i||n?(r({openCritical:i?.open_critical||n?.summary?.critical_alerts||12,mttr:i?.mean_time_to_respond||"18m",analystsOnline:i?.analysts_online||"4/6",slaCompliance:i?.sla_compliance||98.5}),new Error("Using mock chart data")):new Error("No SOC data available")}catch(i){console.warn("Failed to load SOC metrics from API, using mock data:",i),o(Ge),p(Ve),m(Ze)}finally{}})()},[]),e.jsxs("div",{className:"soc-dashboard",children:[e.jsxs("div",{className:"soc-header-grid",children:[e.jsxs("div",{className:"soc-stat-card critical",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(Te,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a.openCritical}),e.jsx("div",{className:"stat-label",children:"Open Critical Incidents"}),e.jsx("div",{className:"stat-trend down",children:"↓ 2 from last hour"})]})]}),e.jsxs("div",{className:"soc-stat-card warning",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(_e,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a.mttr}),e.jsx("div",{className:"stat-label",children:"Mean Time to Respond"}),e.jsx("div",{className:"stat-trend up",children:"↑ 2m vs target"})]})]}),e.jsxs("div",{className:"soc-stat-card info",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(W,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a.analystsOnline}),e.jsx("div",{className:"stat-label",children:"Analysts Online"}),e.jsx("div",{className:"stat-trend neutral",children:"Shift A"})]})]}),e.jsxs("div",{className:"soc-stat-card success",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(G,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a.slaCompliance,"%"]}),e.jsx("div",{className:"stat-label",children:"SLA Compliance"}),e.jsx("div",{className:"stat-trend up",children:"↑ 0.5% this week"})]})]})]}),e.jsxs("div",{className:"soc-content-grid",children:[e.jsxs("div",{className:"soc-col-main",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(D,{className:"w-5 h-5 text-blue-400"})," 24h Alert Volume"]})}),e.jsx("div",{className:"chart-container-lg",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(Ue,{data:d,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorCritical",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#ef4444",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#ef4444",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorHigh",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f59e0b",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f59e0b",stopOpacity:0})]})]}),e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(T,{dataKey:"time",stroke:"#94a3b8"}),e.jsx(_,{stroke:"#94a3b8"}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"},itemStyle:{color:"#e2e8f0"}}),e.jsx(F,{}),e.jsx(U,{type:"monotone",dataKey:"critical",stackId:"1",stroke:"#ef4444",fill:"url(#colorCritical)"}),e.jsx(U,{type:"monotone",dataKey:"high",stackId:"1",stroke:"#f59e0b",fill:"url(#colorHigh)"}),e.jsx(U,{type:"monotone",dataKey:"medium",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",fillOpacity:.1})]})})})]}),e.jsxs("div",{className:"soc-row-split",children:[e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(W,{className:"w-5 h-5 text-purple-400"})," Analyst Workload"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:u,layout:"vertical",children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(T,{type:"number",stroke:"#94a3b8"}),e.jsx(_,{dataKey:"name",type:"category",stroke:"#94a3b8",width:80}),e.jsx(A,{cursor:{fill:"rgba(255,255,255,0.05)"},contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(F,{}),e.jsx(O,{dataKey:"active",name:"Active Cases",fill:"#f59e0b",radius:[0,4,4,0]}),e.jsx(O,{dataKey:"resolved",name:"Resolved (Today)",fill:"#10b981",radius:[0,4,4,0]})]})})})]}),e.jsxs("div",{className:"soc-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Pe,{className:"w-5 h-5 text-cyan-400"})," Alerts by Source"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(oe,{children:[e.jsx(he,{data:v,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:v.map((h,i)=>e.jsx(Y,{fill:ce[i%ce.length]},`cell-${i}`))}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155"}}),e.jsx(F,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]})]}),e.jsxs("div",{className:"soc-col-side",children:[e.jsxs("div",{className:"soc-panel map-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Z,{className:"w-5 h-5 text-green-400"})," Threat Origins"]})}),e.jsxs("div",{className:"world-map-container",children:[e.jsxs("svg",{viewBox:"0 0 900 450",className:"world-map-svg",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("g",{className:"continents",children:[e.jsx("path",{d:`M 120,100 L 140,85 L 155,80 L 165,75 L 180,70 L 195,75 L 210,80 L 220,90 L 225,105 L 230,120 L 228,135 L 220,150 L 210,165 L 200,175 L 185,180 L 170,178 L 155,172 L 145,165 L 135,155 L 128,140 L 125,125 L 122,110 Z
                    M 160,180 L 165,185 L 172,195 L 178,205 L 180,215 L 178,225 L 172,230 L 165,228 L 158,223 L 155,215 L 154,205 L 156,195 L 158,188 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 195,230 L 205,235 L 215,245 L 220,260 L 223,280 L 223,300 L 220,320 L 215,335 L 208,345 L 198,350 L 188,348 L 180,340 L 175,328 L 172,315 L 170,300 L 168,285 L 168,270 L 170,255 L 175,243 L 182,235 L 188,232 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 420,100 L 435,95 L 450,93 L 465,95 L 480,100 L 492,108 L 500,118 L 502,130 L 498,142 L 488,150 L 475,155 L 460,157 L 445,155 L 432,148 L 422,138 L 418,125 L 418,112 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 440,165 L 455,162 L 470,163 L 485,168 L 500,178 L 512,195 L 520,215 L 523,235 L 522,255 L 518,275 L 510,295 L 498,310 L 483,320 L 465,323 L 448,320 L 432,310 L 420,295 L 412,278 L 408,260 L 407,242 L 410,225 L 418,208 L 428,190 L 435,178 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:`M 510,95 L 535,90 L 560,88 L 585,90 L 610,95 L 635,102 L 660,110 L 685,120 L 705,133 L 720,148 L 728,165 L 730,182 L 725,200 L 715,215 L 700,228 L 680,238 L 655,243 L 630,243 L 605,238 L 580,230 L 560,220 L 545,208 L 535,195 L 528,180 L 525,165 L 525,150 L 528,135 L 535,120 L 545,108 L 560,100 L 580,95 L 600,93 Z
                    M 735,145 L 745,150 L 755,158 L 760,168 L 758,178 L 750,183 L 740,180 L 735,172 L 733,162 L 735,152 Z`,fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 680,290 L 700,288 L 720,290 L 740,295 L 755,303 L 765,315 L 768,328 L 765,340 L 755,348 L 740,352 L 720,353 L 700,350 L 685,343 L 673,333 L 668,320 L 668,308 L 672,298 Z",fill:"#1e40af",opacity:"0.4",stroke:"#3b82f6",strokeWidth:"1.5"}),e.jsx("path",{d:"M 150,390 L 250,385 L 350,387 L 450,390 L 550,388 L 650,390 L 750,392 L 750,410 L 650,415 L 550,413 L 450,415 L 350,413 L 250,415 L 150,413 Z",fill:"#1e40af",opacity:"0.2",stroke:"#3b82f6",strokeWidth:"1"})]}),e.jsxs("g",{className:"threat-indicators",children:[e.jsx("circle",{cx:"165",cy:"130",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"165",cy:"130",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"2s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"2s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"445",cy:"120",r:"4",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"445",cy:"120",r:"8",fill:"none",stroke:"#f59e0b",strokeWidth:"1.5",opacity:"0.5",children:[e.jsx("animate",{attributeName:"r",values:"8;16;8",dur:"3s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.5;0;0.5",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"650",cy:"160",r:"5",fill:"#ef4444",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"1.5s",repeatCount:"indefinite"})}),e.jsxs("circle",{cx:"650",cy:"160",r:"10",fill:"none",stroke:"#ef4444",strokeWidth:"1.5",opacity:"0.6",children:[e.jsx("animate",{attributeName:"r",values:"10;20;10",dur:"1.5s",repeatCount:"indefinite"}),e.jsx("animate",{attributeName:"opacity",values:"0.6;0;0.6",dur:"1.5s",repeatCount:"indefinite"})]}),e.jsx("circle",{cx:"580",cy:"110",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.8s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"455",cy:"240",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"200",cy:"290",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.2s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"720",cy:"320",r:"3",fill:"#10b981",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"3.5s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"600",cy:"195",r:"3",fill:"#3b82f6",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.7s",repeatCount:"indefinite"})}),e.jsx("circle",{cx:"745",cy:"155",r:"3.5",fill:"#f59e0b",className:"threat-dot",children:e.jsx("animate",{attributeName:"opacity",values:"1;0.3;1",dur:"2.3s",repeatCount:"indefinite"})})]}),e.jsxs("defs",{children:[e.jsx("pattern",{id:"grid",width:"50",height:"50",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 50 0 L 0 0 0 50",fill:"none",stroke:"#1e293b",strokeWidth:"0.5",opacity:"0.2"})}),e.jsxs("linearGradient",{id:"ocean",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#0f172a",stopOpacity:"1"}),e.jsx("stop",{offset:"100%",stopColor:"#1e293b",stopOpacity:"0.5"})]})]}),e.jsx("rect",{width:"900",height:"450",fill:"url(#ocean)"}),e.jsx("rect",{width:"900",height:"450",fill:"url(#grid)"})]}),e.jsxs("div",{className:"map-legend",children:[e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot critical"}),e.jsx("span",{children:"Critical"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot high"}),e.jsx("span",{children:"High"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot medium"}),e.jsx("span",{children:"Medium"})]}),e.jsxs("div",{className:"legend-item",children:[e.jsx("span",{className:"legend-dot low"}),e.jsx("span",{children:"Low"})]})]})]})]}),e.jsxs("div",{className:"soc-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(M,{className:"w-5 h-5 text-red-400"})," Priority Incidents"]})}),e.jsx("div",{className:"incident-list",children:[{id:"INC-2024-001",title:"Ransomware Activity",severity:"critical",assignee:"Analyst A",time:"10m"},{id:"INC-2024-002",title:"Data Exfiltration",severity:"high",assignee:"Analyst B",time:"45m"},{id:"INC-2024-003",title:"Brute Force Attack",severity:"high",assignee:"Unassigned",time:"1h"},{id:"INC-2024-004",title:"Malware Download",severity:"medium",assignee:"Analyst C",time:"2h"}].map((h,i)=>e.jsxs("div",{className:"incident-item",children:[e.jsx("div",{className:`severity-bar ${h.severity}`}),e.jsxs("div",{className:"incident-content",children:[e.jsxs("div",{className:"incident-top",children:[e.jsx("span",{className:"incident-id",children:h.id}),e.jsxs("span",{className:"incident-time",children:[h.time," ago"]})]}),e.jsx("div",{className:"incident-title",children:h.title}),e.jsxs("div",{className:"incident-assignee",children:[e.jsx(W,{className:"w-3 h-3"})," ",h.assignee]})]})]},i))})]})]})]})]})}const Ns=Object.freeze(Object.defineProperty({__proto__:null,default:rs},Symbol.toStringTag,{value:"Module"}));function ds(){const[a,r]=c.useState(null),[d,o]=c.useState([]),[u,p]=c.useState(!0);c.useEffect(()=>{(async()=>{p(!0);try{const n=await w.getFileStats();throw n?(r({totalFiles:n.total_files||0,malicious:n.malicious_count||0,suspicious:n.suspicious_count||0,clean:n.clean_count||0,pending:n.pending_count||0}),new Error("Using mock file list data")):new Error("No file stats available")}catch(n){console.warn("Failed to load file analysis from API, using mock data:",n),r({totalFiles:1245,malicious:23,suspicious:45,clean:1177,pending:5}),o([{id:1,name:"invoice_2023.pdf.exe",type:"PE32 Executable",size:"1.2 MB",source:"192.168.1.105",dest:"10.0.0.5",status:"malicious",score:98,detection:"Trojan.Win32.Emotet",time:"10m ago"},{id:2,name:"powershell_script.ps1",type:"Script",size:"15 KB",source:"192.168.1.112",dest:"10.0.0.5",status:"suspicious",score:75,detection:"Obfuscated Script",time:"45m ago"},{id:3,name:"quarterly_report.docx",type:"Document",size:"4.5 MB",source:"192.168.1.200",dest:"10.0.0.5",status:"clean",score:0,detection:"-",time:"1h ago"},{id:4,name:"unknown_binary.bin",type:"Binary",size:"512 KB",source:"192.168.1.15",dest:"External",status:"pending",score:0,detection:"Analyzing...",time:"2m ago"},{id:5,name:"update.zip",type:"Archive",size:"12 MB",source:"External",dest:"192.168.1.50",status:"malicious",score:100,detection:"Ransomware.LockBit",time:"3h ago"}])}finally{p(!1)}})()},[]);const v=i=>i.includes("Executable")||i.includes("Binary")?e.jsx(ee,{className:"w-4 h-4 text-red-400"}):i.includes("Script")?e.jsx(H,{className:"w-4 h-4 text-yellow-400"}):i.includes("Archive")?e.jsx(Oe,{className:"w-4 h-4 text-blue-400"}):e.jsx(Ie,{className:"w-4 h-4 text-gray-400"}),m=i=>{switch(i){case"malicious":return e.jsx("span",{className:"status-badge danger",children:"Malicious"});case"suspicious":return e.jsx("span",{className:"status-badge warning",children:"Suspicious"});case"clean":return e.jsx("span",{className:"status-badge success",children:"Clean"});case"pending":return e.jsx("span",{className:"status-badge info",children:"Pending"});default:return e.jsx("span",{className:"status-badge",children:"Unknown"})}},h=[{name:"Executables",count:145},{name:"Scripts",count:89},{name:"Documents",count:450},{name:"Archives",count:120},{name:"Images",count:441}];return u?e.jsx("div",{className:"loading-state",children:"Scanning extracted files..."}):e.jsxs("div",{className:"file-analysis",children:[e.jsxs("div",{className:"file-stats-row",children:[e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(H,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.totalFiles}),e.jsx("div",{className:"stat-label",children:"Files Extracted (24h)"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.malicious}),e.jsx("div",{className:"stat-label",children:"Malicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-yellow-500/10 text-yellow-400",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.suspicious}),e.jsx("div",{className:"stat-label",children:"Suspicious Files"})]})]}),e.jsxs("div",{className:"file-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(M,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.pending}),e.jsx("div",{className:"stat-label",children:"Pending Analysis"})]})]})]}),e.jsxs("div",{className:"file-content-grid",children:[e.jsx("div",{className:"file-left-col",children:e.jsxs("div",{className:"file-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(ee,{className:"w-4 h-4 text-blue-400"})," File Types"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:h,layout:"vertical",margin:{left:40},children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(T,{type:"number",stroke:"#94a3b8",fontSize:10}),e.jsx(_,{dataKey:"name",type:"category",width:80,stroke:"#94a3b8",fontSize:10}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(O,{dataKey:"count",fill:"#3b82f6",radius:[0,4,4,0],children:h.map((i,n)=>e.jsx(Y,{fill:["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#10b981"][n%5]},`cell-${n}`))})]})})})]})}),e.jsx("div",{className:"file-right-col",children:e.jsxs("div",{className:"file-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(D,{className:"w-4 h-4 text-orange-400"})," Recent File Analysis"]}),e.jsx("div",{className:"panel-actions",children:e.jsxs("div",{className:"search-input-sm",children:[e.jsx(V,{className:"w-3 h-3"}),e.jsx("input",{type:"text",placeholder:"Search files..."})]})})]}),e.jsxs("table",{className:"file-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"File Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Score"}),e.jsx("th",{children:"Detection"}),e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:d.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:m(i.status)}),e.jsxs("td",{children:[e.jsxs("div",{className:"file-name-cell",children:[v(i.type),e.jsx("span",{className:"file-name",children:i.name})]}),e.jsxs("div",{className:"file-meta",children:[i.size," • ",i.source]})]}),e.jsx("td",{className:"text-gray-400",children:i.type}),e.jsx("td",{children:e.jsxs("div",{className:`score-badge ${i.score>80?"critical":i.score>50?"high":"low"}`,children:[i.score,"/100"]})}),e.jsx("td",{style:{color:"#fca5a5"},children:i.detection}),e.jsx("td",{className:"text-gray-500",children:i.time}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",title:"Download Sample",children:e.jsx(re,{className:"w-4 h-4"})})})]},i.id))})]})]})})]})]})}const ys=Object.freeze(Object.defineProperty({__proto__:null,default:ds},Symbol.toStringTag,{value:"Module"}));function os(){const[a,r]=c.useState(null),[d,o]=c.useState([]),[u,p]=c.useState([]),[v,m]=c.useState(!0);c.useEffect(()=>{(async()=>{m(!0);try{const b=await w.getDNSStats();throw b?(r({totalQueries:b.total_queries||0,blockedQueries:b.blocked_queries||0,dgaDomains:b.dga_domains||0,tunnelingAlerts:b.tunneling_alerts||0}),new Error("Using mock data for queries and tunneling events")):new Error("No DNS stats available")}catch(b){console.warn("Failed to load DNS intelligence from API, using mock data:",b),r(qe),o(Je),p(es)}finally{m(!1)}})()},[]);const h=Xe,i=Ye;return v?e.jsx("div",{className:"loading-state",children:"Analyzing DNS traffic..."}):e.jsxs("div",{className:"dns-intelligence",children:[e.jsxs("div",{className:"dns-stats-row",children:[e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(Z,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.totalQueries?(a.totalQueries/1e3).toFixed(1):0,"k"]}),e.jsx("div",{className:"stat-label",children:"Total Queries (24h)"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(Fe,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.blockedQueries}),e.jsx("div",{className:"stat-label",children:"Blocked Domains"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(Q,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.dgaDomains}),e.jsx("div",{className:"stat-label",children:"DGA Detected"})]})]}),e.jsxs("div",{className:"dns-stat-card",children:[e.jsx("div",{className:"stat-icon bg-orange-500/10 text-orange-400",children:e.jsx(D,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.tunnelingAlerts}),e.jsx("div",{className:"stat-label",children:"Tunneling Events"})]})]})]}),e.jsxs("div",{className:"dns-content-grid",children:[e.jsxs("div",{className:"dns-left-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(D,{className:"w-4 h-4 text-blue-400"})," DNS Query Volume (QPS)"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(Ke,{data:i,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(T,{dataKey:"time",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(_,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(Qe,{type:"monotone",dataKey:"qps",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})]}),e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(He,{className:"w-4 h-4 text-purple-400"})," Query Types"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs($,{data:h,children:[e.jsx(E,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(T,{dataKey:"name",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(_,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(A,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},cursor:{fill:"rgba(255,255,255,0.05)"}}),e.jsx(O,{dataKey:"count",fill:"#8b5cf6",radius:[4,4,0,0]})]})})})]})]}),e.jsxs("div",{className:"dns-right-col",children:[e.jsxs("div",{className:"dns-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(z,{className:"w-4 h-4 text-red-400"})," DNS Tunneling Detection"]})}),e.jsx("div",{className:"tunnel-list",children:u.map(n=>e.jsxs("div",{className:"tunnel-item",children:[e.jsx("div",{className:"tunnel-icon",children:e.jsx(z,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{className:"tunnel-info",children:[e.jsx("div",{className:"tunnel-domain",children:n.domain}),e.jsxs("div",{className:"tunnel-meta",children:[e.jsx("span",{children:n.method}),e.jsx("span",{children:"•"}),e.jsx("span",{children:n.volume}),e.jsx("span",{children:"•"}),e.jsx("span",{children:n.client})]})]}),e.jsxs("div",{className:"tunnel-confidence",children:[e.jsxs("div",{className:"confidence-val",children:[n.confidence,"%"]}),e.jsx("div",{className:"confidence-lbl",children:"Confidence"})]})]},n.id))})]}),e.jsxs("div",{className:"dns-panel flex-1",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(V,{className:"w-4 h-4 text-green-400"})," Recent Queries"]}),e.jsx("button",{className:"btn-icon",children:e.jsx(de,{className:"w-4 h-4"})})]}),e.jsxs("table",{className:"dns-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Domain"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:d.map(n=>e.jsxs("tr",{children:[e.jsxs("td",{children:[n.status==="blocked"&&e.jsx("span",{className:"status-dot blocked",title:"Blocked"}),n.status==="allowed"&&e.jsx("span",{className:"status-dot allowed",title:"Allowed"}),n.status==="flagged"&&e.jsx("span",{className:"status-dot flagged",title:"Flagged"})]}),e.jsx("td",{className:"mono text-white",children:n.domain}),e.jsx("td",{className:"text-gray-400",children:n.type}),e.jsx("td",{className:"mono text-blue-300",children:n.client}),e.jsx("td",{children:e.jsx("span",{className:"category-tag",children:n.category})}),e.jsx("td",{className:"text-gray-500",children:n.time})]},n.id))})]})]})]})]})]})}const fs=Object.freeze(Object.defineProperty({__proto__:null,default:os},Symbol.toStringTag,{value:"Module"}));function hs({view:a="playbooks"}){const[r,d]=c.useState(a),[o,u]=c.useState([]),[p,v]=c.useState([]),[m,h]=c.useState([]),[i,n]=c.useState(!0);c.useEffect(()=>{d(a)},[a]);const b=t=>{if(!t)return"-";const x=new Date,y=new Date(t),f=x.getTime()-y.getTime(),l=Math.round(f/1e3),S=Math.round(l/60),R=Math.round(S/60),I=Math.round(R/24);return l<60?`${l}s ago`:S<60?`${S}m ago`:R<24?`${R}h ago`:I<7?`${I}d ago`:y.toLocaleDateString()};return c.useEffect(()=>{(async()=>{n(!0);try{const[x,y]=await Promise.all([w.getPlaybooks(),w.getExecutions({limit:10})]);if(x&&Array.isArray(x)&&x.length>0){const f=x.map(l=>({id:l.id,name:l.name||l.title,trigger:l.trigger||"Manual",status:l.status==="active"||l.status==="manual"||l.status==="disabled"?l.status:"manual",runs:l.execution_count||0,successRate:l.success_rate||100,lastRun:b(l.last_execution)}));u(f)}if(y&&Array.isArray(y)&&y.length>0){const f=y.map(l=>({id:l.id,playbook:l.playbook_name||"Unknown",target:l.target||l.alert_id||"N/A",status:l.status==="completed"?"success":l.status==="failed"?"failed":"running",time:b(l.started_at),duration:l.duration||"-"}));h(f)}if((!x||x.length===0)&&(!y||y.length===0))throw new Error("No SOAR data available from API");v([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}])}catch(x){console.warn("Failed to load SOAR data from API, using mock data:",x),u([{id:1,name:"Block Malicious IP (Firewall)",trigger:"Critical Alert",status:"active",runs:145,successRate:98,lastRun:"10m ago"},{id:2,name:"Isolate Host (EDR)",trigger:"Ransomware Detection",status:"active",runs:12,successRate:100,lastRun:"2h ago"},{id:3,name:"Enrich IOCs (VirusTotal)",trigger:"New Artifact",status:"active",runs:1250,successRate:99,lastRun:"1m ago"},{id:4,name:"Reset User Password (AD)",trigger:"Brute Force Success",status:"manual",runs:5,successRate:100,lastRun:"1d ago"},{id:5,name:"Send Slack Notification",trigger:"High Severity",status:"active",runs:450,successRate:100,lastRun:"5m ago"}]),v([{id:1,name:"Splunk Enterprise",type:"SIEM",status:"connected",latency:"45ms",events:"1.2M/hr"},{id:2,name:"Elasticsearch (ELK)",type:"SIEM",status:"connected",latency:"12ms",events:"850k/hr"},{id:3,name:"ServiceNow",type:"ITSM",status:"error",latency:"-",events:"0/hr"},{id:4,name:"Palo Alto Firewall",type:"Firewall",status:"connected",latency:"22ms",events:"Action Only"},{id:5,name:"Slack Webhook",type:"Notification",status:"connected",latency:"150ms",events:"Alerts Only"}]),h([{id:101,playbook:"Block Malicious IP",target:"185.22.1.4",status:"success",time:"10m ago",duration:"2s"},{id:102,playbook:"Enrich IOCs",target:"hash: 44d8...2f",status:"success",time:"12m ago",duration:"1.5s"},{id:103,playbook:"Send Slack Notification",target:"#security-ops",status:"success",time:"15m ago",duration:"0.5s"},{id:104,playbook:"Isolate Host",target:"WORKSTATION-04",status:"failed",time:"2h ago",duration:"5s"}])}finally{n(!1)}})()},[]),i?e.jsx("div",{className:"loading-state",children:"Loading automation modules..."}):e.jsxs("div",{className:"soar-integration",children:[e.jsxs("div",{className:"soar-header",children:[e.jsxs("div",{className:"view-selector",children:[e.jsxs("button",{className:`view-btn ${r==="playbooks"?"active":""}`,onClick:()=>d("playbooks"),children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"Playbooks & Automation"})]}),e.jsxs("button",{className:`view-btn ${r==="connectors"?"active":""}`,onClick:()=>d("connectors"),children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"SIEM & Connectors"})]})]}),e.jsx("div",{className:"soar-actions",children:e.jsx("button",{className:"btn-primary",children:r==="playbooks"?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"w-4 h-4"})," New Playbook"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4"})," New Connector"]})})})]}),e.jsx("div",{className:"soar-content",children:r==="playbooks"?e.jsx("div",{className:"playbooks-view",children:e.jsxs("div",{className:"soar-grid",children:[e.jsxs("div",{className:"soar-panel flex-2",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(Q,{className:"w-4 h-4 text-yellow-400"})," Active Playbooks"]})}),e.jsxs("table",{className:"soar-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Playbook Name"}),e.jsx("th",{children:"Trigger"}),e.jsx("th",{children:"Success Rate"}),e.jsx("th",{children:"Last Run"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:o.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("div",{className:`status-pill ${t.status}`,children:t.status})}),e.jsx("td",{className:"font-medium text-white",children:t.name}),e.jsx("td",{className:"text-gray-400",children:t.trigger}),e.jsxs("td",{children:[e.jsx("div",{className:"progress-bar-sm",children:e.jsx("div",{className:"progress-fill",style:{width:`${t.successRate}%`,background:t.successRate>90?"#10b981":"#f59e0b"}})}),e.jsxs("span",{className:"text-xs text-gray-400",children:[t.successRate,"%"]})]}),e.jsx("td",{className:"text-gray-500",children:t.lastRun}),e.jsx("td",{children:e.jsx("button",{className:"btn-icon",children:e.jsx($e,{className:"w-4 h-4"})})})]},t.id))})]})]}),e.jsxs("div",{className:"soar-panel flex-1",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(D,{className:"w-4 h-4 text-blue-400"})," Recent Executions"]})}),e.jsx("div",{className:"history-list",children:m.map(t=>e.jsxs("div",{className:"history-item",children:[e.jsx("div",{className:"history-status",children:t.status==="success"?e.jsx(G,{className:"w-4 h-4 text-green-400"}):e.jsx(Be,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{className:"history-info",children:[e.jsx("div",{className:"history-name",children:t.playbook}),e.jsx("div",{className:"history-target",children:t.target})]}),e.jsxs("div",{className:"history-meta",children:[e.jsx("div",{children:t.time}),e.jsx("div",{className:"history-dur",children:t.duration})]})]},t.id))})]})]})}):e.jsx("div",{className:"connectors-view",children:e.jsxs("div",{className:"connectors-grid",children:[p.map(t=>e.jsxs("div",{className:"connector-card",children:[e.jsxs("div",{className:"connector-header",children:[e.jsx("div",{className:"connector-icon",children:t.type==="SIEM"?e.jsx(se,{className:"w-6 h-6"}):t.type==="Firewall"?e.jsx(M,{className:"w-6 h-6"}):e.jsx(We,{className:"w-6 h-6"})}),e.jsx("div",{className:`connector-status ${t.status}`})]}),e.jsxs("div",{className:"connector-body",children:[e.jsx("h4",{children:t.name}),e.jsx("div",{className:"connector-type",children:t.type}),e.jsxs("div",{className:"connector-stats",children:[e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Latency"}),e.jsx("span",{className:"mono",children:t.latency})]}),e.jsxs("div",{className:"stat-row",children:[e.jsx("span",{children:"Throughput"}),e.jsx("span",{className:"mono",children:t.events})]})]})]}),e.jsx("div",{className:"connector-footer",children:e.jsx("button",{className:"btn-secondary full-width",children:"Configure"})})]},t.id)),e.jsx("div",{className:"connector-card add-new",children:e.jsxs("div",{className:"add-content",children:[e.jsx("div",{className:"add-icon",children:e.jsx(ae,{className:"w-8 h-8"})}),e.jsx("span",{children:"Add Integration"})]})})]})})})]})}const bs=Object.freeze(Object.defineProperty({__proto__:null,default:hs},Symbol.toStringTag,{value:"Module"}));export{gs as A,fs as D,ys as F,vs as S,Ns as a,bs as b};
