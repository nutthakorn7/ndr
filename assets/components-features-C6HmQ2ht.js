import{u as V,j as e}from"./components-core-ChTPXdZ6.js";import{r as c,D as z,A,N as q,k as W,b as P,l as T,m as X,n as K,W as _,o as Q,p as R,T as O,C as $,c as J,a as Y,e as Z,q as ee,G as E,s as se,t as ae,u as te,v as ie,w as ne,x as le,S as re,Z as ce,E as oe}from"./vendor-icons-f0DDQENA.js";import{a as y}from"./components-dashboard-3kBugXXc.js";import{R as C,A as B,C as U,X as H,Y as F,T as M,L as D,b as L,P as de,c as he,d as me}from"./vendor-charts-DMONfKIF.js";const I=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"];function xe(){const{addToast:g}=V(),[f,b]=c.useState("24h"),[N,a]=c.useState([]),[j,x]=c.useState([]),[v,l]=c.useState([]),[i,h]=c.useState(!0);return c.useEffect(()=>{(async()=>{h(!0);try{const r=await y.getTrafficStats(f),n=await y.getProtocolStats();if(r&&Array.isArray(r)){const u=r.map(s=>({time:new Date(s.timestamp).getHours()+":00",inbound:Math.floor(s.bytes/1024/1024),outbound:Math.floor(s.bytes/1024/1024*.6)}));a(u)}else throw new Error("Invalid traffic response");if(n&&Array.isArray(n)){const u=n.slice(0,6).map(s=>({name:s.protocol||s.name,value:s.count||s.value}));x(u)}else throw new Error("Invalid protocol response")}catch(r){console.warn("Failed to load network analytics from API, using mock data:",r),await new Promise(s=>setTimeout(s,800));const n=[],u=new Date;for(let s=24;s>=0;s--)n.push({time:new Date(u.getTime()-s*36e5).getHours()+":00",inbound:Math.floor(Math.random()*500)+200,outbound:Math.floor(Math.random()*300)+100});a(n),x([{name:"HTTPS",value:45},{name:"DNS",value:15},{name:"HTTP",value:12},{name:"SSH",value:8},{name:"SMB",value:5},{name:"Other",value:15}]),l([{ip:"192.168.1.105",bytes:"4.2 GB",flows:12450,risk:"High"},{ip:"192.168.1.200",bytes:"2.1 GB",flows:8540,risk:"Medium"},{ip:"192.168.1.15",bytes:"1.8 GB",flows:6200,risk:"Low"},{ip:"10.0.0.5",bytes:"950 MB",flows:4100,risk:"Low"},{ip:"172.16.0.25",bytes:"500 MB",flows:1200,risk:"Critical"}])}finally{h(!1)}})()},[f]),i?e.jsx("div",{className:"loading-state",children:"Loading network analytics..."}):e.jsxs("div",{className:"network-analytics",children:[e.jsxs("div",{className:"analytics-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"Network Traffic Analysis"}),e.jsxs("span",{className:"live-badge",children:[e.jsx("span",{className:"pulse-dot"})," Live"]})]}),e.jsxs("div",{className:"header-controls",children:[e.jsxs("select",{value:f,onChange:t=>b(t.target.value),className:"control-select",children:[e.jsx("option",{value:"1h",children:"Last 1 Hour"}),e.jsx("option",{value:"6h",children:"Last 6 Hours"}),e.jsx("option",{value:"24h",children:"Last 24 Hours"}),e.jsx("option",{value:"7d",children:"Last 7 Days"})]}),e.jsxs("button",{className:"btn-secondary",children:[e.jsx(z,{className:"w-4 h-4"})," Export Report"]})]})]}),e.jsxs("div",{className:"charts-row",children:[e.jsxs("div",{className:"chart-card wide",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-4 h-4 text-blue-400"})," Traffic Volume (Mbps)"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(B,{data:N,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorIn",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorOut",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})]}),e.jsx(U,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(H,{dataKey:"time",stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(F,{stroke:"#94a3b8",fontSize:12,tickLine:!1,axisLine:!1}),e.jsx(M,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},itemStyle:{color:"#e2e8f0"}}),e.jsx(D,{}),e.jsx(L,{type:"monotone",dataKey:"inbound",stroke:"#3b82f6",fillOpacity:1,fill:"url(#colorIn)",name:"Inbound"}),e.jsx(L,{type:"monotone",dataKey:"outbound",stroke:"#10b981",fillOpacity:1,fill:"url(#colorOut)",name:"Outbound"})]})})})]}),e.jsxs("div",{className:"chart-card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{children:[e.jsx(q,{className:"w-4 h-4 text-purple-400"})," Protocol Distribution"]})}),e.jsx("div",{className:"chart-container",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(de,{children:[e.jsx(he,{data:j,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",children:j.map((t,r)=>e.jsx(me,{fill:I[r%I.length]},`cell-${r}`))}),e.jsx(M,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"}}),e.jsx(D,{layout:"vertical",verticalAlign:"middle",align:"right"})]})})})]})]}),e.jsxs("div",{className:"data-row",children:[e.jsxs("div",{className:"data-card wide",children:[e.jsxs("div",{className:"card-header",children:[e.jsxs("h3",{children:[e.jsx(W,{className:"w-4 h-4 text-orange-400"})," Top Talkers"]}),e.jsx("button",{className:"btn-text",children:"View All"})]}),e.jsxs("table",{className:"analytics-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"Total Bytes"}),e.jsx("th",{children:"Flows"}),e.jsx("th",{children:"Risk Level"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:v.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"mono text-cyan-400",children:t.ip}),e.jsx("td",{children:t.bytes}),e.jsx("td",{children:t.flows.toLocaleString()}),e.jsx("td",{children:e.jsx("span",{className:`risk-badge ${t.risk.toLowerCase()}`,children:t.risk})}),e.jsx("td",{children:e.jsx("button",{className:"btn-xs",onClick:()=>g(`Analyzing traffic for ${t.ip}...`,"info"),children:"Analyze"})})]},r))})]})]}),e.jsxs("div",{className:"stats-column",children:[e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-label",children:"Total Bandwidth"}),e.jsx("div",{className:"stat-number",children:"1.2 Gbps"}),e.jsx("div",{className:"stat-trend up",children:"↑ 15% peak"})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-label",children:"Active Connections"}),e.jsx("div",{className:"stat-number",children:"24,502"}),e.jsx("div",{className:"stat-trend neutral",children:"~ Stable"})]}),e.jsxs("div",{className:"stat-box",children:[e.jsx("div",{className:"stat-label",children:"Unique IPs"}),e.jsx("div",{className:"stat-number",children:"1,892"}),e.jsx("div",{className:"stat-trend up",children:"↑ 12 new"})]})]})]})]})}const Se=Object.freeze(Object.defineProperty({__proto__:null,default:xe},Symbol.toStringTag,{value:"Module"}));function je(){const[g,f]=c.useState([]),[b,N]=c.useState(!0),[a,j]=c.useState(null);c.useEffect(()=>{const l=t=>{if(!t)return"-";const r=new Date,n=new Date(t),u=r.getTime()-n.getTime();if(u<0)return"0d 0h 0m";const s=Math.floor(u/(1e3*60*60*24)),S=Math.floor(u%(1e3*60*60*24)/(1e3*60*60)),k=Math.floor(u%(1e3*60*60)/(1e3*60));return`${s}d ${S}h ${k}m`},i=t=>typeof t!="number"||t<0?"0 Mbps":`${(t*8/(1e3*1e3)).toFixed(2)} Mbps`;(async()=>{N(!0);try{const t=await y.getSensors();if(t&&t.sensors){const r=t.sensors.map(n=>({id:n.id,name:n.name,location:n.location||"Unknown",status:n.status,ip:n.ip_address||n.ip||"N/A",uptime:l(n.last_heartbeat),cpu:n.last_metrics?.cpu||0,ram:n.last_metrics?.ram||0,disk:n.last_metrics?.disk||0,interface:n.interface||"eth0",traffic:i(n.last_metrics?.bytes_per_sec),version:n.version||"2.4.0"}));f(r),r.length>0&&j(r[0])}else throw new Error("Invalid sensor response")}catch(t){console.warn("Failed to load sensors from API, using mock data:",t);const r=[{id:"sensor-01",name:"Gateway-Primary",location:"HQ Server Room",status:"online",ip:"192.168.1.5",uptime:"14d 2h 15m",cpu:45,ram:62,disk:28,interface:"eth0",traffic:"850 Mbps",version:"2.4.0"},{id:"sensor-02",name:"Gateway-Backup",location:"HQ Server Room",status:"online",ip:"192.168.1.6",uptime:"45d 12h 30m",cpu:12,ram:34,disk:15,interface:"eth0",traffic:"12 Mbps",version:"2.4.0"},{id:"sensor-03",name:"Branch-NY",location:"New York Office",status:"warning",ip:"10.50.1.5",uptime:"2d 5h 10m",cpu:88,ram:75,disk:45,interface:"eth1",traffic:"120 Mbps",version:"2.3.5"},{id:"sensor-04",name:"Branch-LDN",location:"London Office",status:"offline",ip:"10.60.1.5",uptime:"-",cpu:0,ram:0,disk:0,interface:"-",traffic:"-",version:"2.3.5"},{id:"sensor-05",name:"Cloud-AWS-East",location:"AWS us-east-1",status:"online",ip:"172.16.0.100",uptime:"120d 1h 5m",cpu:25,ram:40,disk:12,interface:"ens5",traffic:"450 Mbps",version:"2.4.0"}];f(r),j(r[0])}finally{N(!1)}})()},[]);const x=l=>{switch(l){case"online":return e.jsx($,{className:"w-4 h-4 text-green-400"});case"warning":return e.jsx(O,{className:"w-4 h-4 text-yellow-400"});case"offline":return e.jsx(R,{className:"w-4 h-4 text-red-400"});default:return e.jsx(A,{className:"w-4 h-4 text-gray-400"})}},v=l=>{switch(l){case"online":return"bg-green-500/10 text-green-400 border-green-500/20";case"warning":return"bg-yellow-500/10 text-yellow-400 border-yellow-500/20";case"offline":return"bg-red-500/10 text-red-400 border-red-500/20";default:return"bg-gray-500/10 text-gray-400 border-gray-500/20"}};return b?e.jsx("div",{className:"loading-state",children:"Loading sensor fleet..."}):e.jsxs("div",{className:"sensor-management",children:[e.jsxs("div",{className:"sensor-header",children:[e.jsxs("div",{className:"header-title",children:[e.jsx("h2",{children:"Sensor Fleet Management"}),e.jsxs("div",{className:"fleet-stats",children:[e.jsx("span",{className:"stat-badge success",children:"3 Online"}),e.jsx("span",{className:"stat-badge warning",children:"1 Warning"}),e.jsx("span",{className:"stat-badge danger",children:"1 Offline"})]})]}),e.jsxs("button",{className:"btn-primary",children:[e.jsx(P,{className:"w-4 h-4"})," Refresh Fleet"]})]}),e.jsxs("div",{className:"sensor-content",children:[e.jsxs("div",{className:"sensor-list-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsx("h3",{children:"Sensors"})}),e.jsx("div",{className:"sensor-list",children:g.map(l=>e.jsxs("div",{className:`sensor-item ${a?.id===l.id?"active":""}`,onClick:()=>j(l),children:[e.jsxs("div",{className:"sensor-item-header",children:[e.jsx("span",{className:"sensor-name",children:l.name}),x(l.status)]}),e.jsxs("div",{className:"sensor-item-meta",children:[e.jsx("span",{children:l.ip}),e.jsx("span",{className:`status-text ${l.status}`,children:l.status})]})]},l.id))})]}),a&&e.jsxs("div",{className:"sensor-details-panel",children:[e.jsxs("div",{className:"details-header",children:[e.jsxs("div",{className:"details-title",children:[e.jsx(T,{className:"w-6 h-6 text-blue-400"}),e.jsxs("div",{children:[e.jsx("h3",{children:a.name}),e.jsx("span",{className:"sensor-id",children:a.id})]})]}),e.jsx("div",{className:`sensor-status-badge ${v(a.status)}`,children:a.status.toUpperCase()})]}),e.jsxs("div",{className:"metrics-grid",children:[e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-header",children:[e.jsx(X,{className:"w-4 h-4 text-purple-400"}),e.jsx("span",{children:"CPU Usage"})]}),e.jsxs("div",{className:"metric-value",children:[a.cpu,"%"]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:`progress-fill ${a.cpu>80?"danger":"primary"}`,style:{width:`${a.cpu}%`}})})]}),e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-header",children:[e.jsx(A,{className:"w-4 h-4 text-blue-400"}),e.jsx("span",{children:"RAM Usage"})]}),e.jsxs("div",{className:"metric-value",children:[a.ram,"%"]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:`progress-fill ${a.ram>80?"danger":"primary"}`,style:{width:`${a.ram}%`}})})]}),e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-header",children:[e.jsx(K,{className:"w-4 h-4 text-green-400"}),e.jsx("span",{children:"Disk Usage"})]}),e.jsxs("div",{className:"metric-value",children:[a.disk,"%"]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill success",style:{width:`${a.disk}%`}})})]}),e.jsxs("div",{className:"metric-card",children:[e.jsxs("div",{className:"metric-header",children:[e.jsx(_,{className:"w-4 h-4 text-orange-400"}),e.jsx("span",{children:"Traffic"})]}),e.jsx("div",{className:"metric-value",children:a.traffic}),e.jsxs("div",{className:"metric-sub",children:["Interface: ",a.interface]})]})]}),e.jsxs("div",{className:"details-info-grid",children:[e.jsxs("div",{className:"info-group",children:[e.jsx("label",{children:"Location"}),e.jsx("div",{children:a.location})]}),e.jsxs("div",{className:"info-group",children:[e.jsx("label",{children:"IP Address"}),e.jsx("div",{className:"mono",children:a.ip})]}),e.jsxs("div",{className:"info-group",children:[e.jsx("label",{children:"Software Version"}),e.jsxs("div",{children:["v",a.version]})]}),e.jsxs("div",{className:"info-group",children:[e.jsx("label",{children:"Uptime"}),e.jsx("div",{children:a.uptime})]})]}),e.jsxs("div",{className:"sensor-actions",children:[e.jsxs("button",{className:"btn-secondary",children:[e.jsx(Q,{className:"w-4 h-4"})," Remote Console"]}),e.jsx("button",{className:"btn-secondary",children:"View Logs"}),e.jsx("button",{className:"btn-secondary",children:"Configure"}),e.jsx("button",{className:"btn-danger ml-auto",children:"Restart Sensor"})]})]})]})]})}const ke=Object.freeze(Object.defineProperty({__proto__:null,default:je},Symbol.toStringTag,{value:"Module"}));function ue(){const[g,f]=c.useState([]),[b,N]=c.useState(!0),[a,j]=c.useState(null),[x,v]=c.useState("all"),[l,i]=c.useState(""),[h,t]=c.useState({total:0,new24h:0,highRisk:0});c.useEffect(()=>{const s=async()=>{N(!0);try{const[m,d]=await Promise.all([y.getAssets({limit:100}),y.getAssetStats().catch(()=>null)]);if(m&&m.assets){const p=m.assets.map(o=>({id:o.id,ip:o.ip_address||"N/A",mac:o.mac_address||"N/A",hostname:o.hostname||o.ip_address||"Unknown",type:S(o.asset_type),os:o.os_type||"Unknown OS",vendor:o.vendor||"Unknown",firstSeen:o.first_seen||o.created_at,lastSeen:k(o.last_seen),riskScore:G(o),openPorts:o.open_ports||[],tags:o.tags||[]}));f(p),t(d?{total:d.total_assets||p.length,new24h:d.new_24h||0,highRisk:d.high_risk||p.filter(o=>o.riskScore>=50).length}:{total:p.length,new24h:0,highRisk:p.filter(o=>o.riskScore>=50).length})}else throw new Error("Invalid asset response")}catch(m){console.warn("Failed to load assets from API, using mock data:",m);const d=[{id:"asset-01",ip:"192.168.1.105",mac:"00:1A:2B:3C:4D:5E",hostname:"finance-workstation-01",type:"workstation",os:"Windows 11 Pro",vendor:"Dell",firstSeen:"2023-10-15T08:30:00",lastSeen:"Just now",riskScore:15,openPorts:[135,139,445,3389],tags:["finance","restricted"]},{id:"asset-02",ip:"192.168.1.200",mac:"AA:BB:CC:DD:EE:FF",hostname:"dc-primary",type:"server",os:"Windows Server 2019",vendor:"VMware",firstSeen:"2023-09-01T00:00:00",lastSeen:"Just now",riskScore:5,openPorts:[53,88,135,389,445,464,636,3268,3269],tags:["infrastructure","critical"]},{id:"asset-03",ip:"192.168.1.15",mac:"11:22:33:44:55:66",hostname:"dev-macbook-pro",type:"laptop",os:"macOS Sonoma 14.2",vendor:"Apple",firstSeen:"2023-11-20T09:15:00",lastSeen:"5m ago",riskScore:45,openPorts:[22,8080,3e3],tags:["developer","wifi"]},{id:"asset-04",ip:"10.0.0.50",mac:"99:88:77:66:55:44",hostname:"iot-camera-lobby",type:"iot",os:"Linux (Embedded)",vendor:"Hikvision",firstSeen:"2023-08-10T14:20:00",lastSeen:"Just now",riskScore:85,openPorts:[80,554],tags:["iot","surveillance"]},{id:"asset-05",ip:"192.168.1.254",mac:"12:34:56:78:90:AB",hostname:"gateway-router",type:"network",os:"Cisco IOS",vendor:"Cisco",firstSeen:"2023-01-01T00:00:00",lastSeen:"Just now",riskScore:0,openPorts:[22,80,443],tags:["network","gateway"]}];f(d),t({total:d.length,new24h:3,highRisk:d.filter(p=>p.riskScore>=50).length})}finally{N(!1)}},S=m=>({endpoint:"workstation",server:"server",laptop:"laptop",mobile:"mobile",iot:"iot",printer:"printer",network:"network"})[m?.toLowerCase()]||"workstation",k=m=>{if(!m)return"Unknown";const d=new Date(m),o=new Date().getTime()-d.getTime(),w=Math.floor(o/6e4);return w<1?"Just now":w<60?`${w}m ago`:w<1440?`${Math.floor(w/60)}h ago`:`${Math.floor(w/1440)}d ago`},G=m=>{let d=0;m.criticality==="high"?d+=40:m.criticality==="medium"?d+=25:m.criticality==="critical"&&(d+=60);const p=m.open_ports?.length||0;return p>10?d+=30:p>5?d+=15:p>0&&(d+=5),Math.min(100,d)};s()},[]);const r=s=>{switch(s){case"server":return e.jsx(T,{className:"w-5 h-5 text-purple-400"});case"workstation":return e.jsx(ie,{className:"w-5 h-5 text-blue-400"});case"laptop":return e.jsx(te,{className:"w-5 h-5 text-blue-300"});case"iot":return e.jsx(_,{className:"w-5 h-5 text-orange-400"});case"mobile":return e.jsx(ae,{className:"w-5 h-5 text-green-400"});case"printer":return e.jsx(se,{className:"w-5 h-5 text-gray-400"});default:return e.jsx(E,{className:"w-5 h-5 text-gray-400"})}},n=s=>s>=75?e.jsxs("span",{className:"risk-badge critical",children:["Critical (",s,")"]}):s>=50?e.jsxs("span",{className:"risk-badge high",children:["High (",s,")"]}):s>=25?e.jsxs("span",{className:"risk-badge medium",children:["Medium (",s,")"]}):e.jsxs("span",{className:"risk-badge low",children:["Low (",s,")"]}),u=g.filter(s=>{const S=s.ip.includes(l)||s.hostname.toLowerCase().includes(l.toLowerCase())||s.mac.toLowerCase().includes(l.toLowerCase()),k=x==="all"||s.type===x;return S&&k});return b?e.jsx("div",{className:"loading-state",children:"Scanning network for assets..."}):e.jsxs("div",{className:"asset-discovery",children:[e.jsxs("div",{className:"asset-stats-row",children:[e.jsxs("div",{className:"asset-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(T,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h.total}),e.jsx("div",{className:"stat-label",children:"Total Assets"})]})]}),e.jsxs("div",{className:"asset-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(J,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h.new24h}),e.jsx("div",{className:"stat-label",children:"New (24h)"})]})]}),e.jsxs("div",{className:"asset-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(Y,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:h.highRisk}),e.jsx("div",{className:"stat-label",children:"High Risk"})]})]})]}),e.jsxs("div",{className:"asset-content-split",children:[e.jsxs("div",{className:`asset-list-panel ${a?"shrink":""}`,children:[e.jsxs("div",{className:"panel-controls",children:[e.jsxs("div",{className:"search-input",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search IP, Hostname, MAC...",value:l,onChange:s=>i(s.target.value)})]}),e.jsxs("div",{className:"filter-tabs",children:[e.jsx("button",{className:`filter-tab ${x==="all"?"active":""}`,onClick:()=>v("all"),children:"All"}),e.jsx("button",{className:`filter-tab ${x==="server"?"active":""}`,onClick:()=>v("server"),children:"Servers"}),e.jsx("button",{className:`filter-tab ${x==="workstation"?"active":""}`,onClick:()=>v("workstation"),children:"Workstations"}),e.jsx("button",{className:`filter-tab ${x==="iot"?"active":""}`,onClick:()=>v("iot"),children:"IoT"})]})]}),e.jsx("div",{className:"asset-table-container",children:e.jsxs("table",{className:"asset-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Asset Name"}),e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"OS / Vendor"}),e.jsx("th",{children:"Risk"}),e.jsx("th",{children:"Last Seen"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:u.map(s=>e.jsxs("tr",{className:a?.id===s.id?"active":"",onClick:()=>j(s),children:[e.jsx("td",{children:r(s.type)}),e.jsxs("td",{children:[e.jsx("div",{className:"asset-name",children:s.hostname}),e.jsx("div",{className:"asset-mac",children:s.mac})]}),e.jsx("td",{className:"mono",children:s.ip}),e.jsxs("td",{children:[e.jsx("div",{className:"asset-os",children:s.os}),e.jsx("div",{className:"asset-vendor",children:s.vendor})]}),e.jsx("td",{children:n(s.riskScore)}),e.jsx("td",{className:"text-gray-400",children:s.lastSeen}),e.jsx("td",{children:e.jsx(ee,{className:"w-4 h-4 text-gray-500"})})]},s.id))})]})})]}),a&&e.jsxs("div",{className:"asset-details-sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx("h3",{children:"Asset Details"}),e.jsx("button",{className:"close-btn",onClick:()=>j(null),children:"×"})]}),e.jsxs("div",{className:"sidebar-content",children:[e.jsxs("div",{className:"detail-hero",children:[e.jsx("div",{className:"hero-icon",children:r(a.type)}),e.jsxs("div",{className:"hero-info",children:[e.jsx("h2",{children:a.hostname}),e.jsx("div",{className:"hero-ip",children:a.ip})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Identity"}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"MAC Address"}),e.jsx("span",{className:"value mono",children:a.mac})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"Vendor"}),e.jsx("span",{className:"value",children:a.vendor})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"OS"}),e.jsx("span",{className:"value",children:a.os})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"Type"}),e.jsx("span",{className:"value capitalize",children:a.type})]})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Network Profile"}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"label",children:"First Seen"}),e.jsx("span",{className:"value",children:new Date(a.firstSeen).toLocaleDateString()})]}),e.jsx("div",{className:"detail-tags",children:a.tags.map(s=>e.jsx("span",{className:"tag",children:s},s))})]}),e.jsxs("div",{className:"detail-section",children:[e.jsx("h4",{children:"Open Ports"}),e.jsx("div",{className:"ports-grid",children:a.openPorts.map(s=>e.jsxs("div",{className:"port-badge",children:[e.jsx("span",{className:"port-number",children:s}),e.jsx("span",{className:"port-proto",children:"TCP"})]},s))})]}),e.jsxs("div",{className:"detail-actions",children:[e.jsx("button",{className:"btn-primary full-width",children:"View Traffic History"}),e.jsx("button",{className:"btn-secondary full-width",children:"Scan for Vulnerabilities"})]})]})]})]})]})}const Ae=Object.freeze(Object.defineProperty({__proto__:null,default:ue},Symbol.toStringTag,{value:"Module"})),pe=[{id:1,name:"AlienVault OTX",type:"Community",status:"active",iocs:1250430,lastUpdate:"5m ago"},{id:2,name:"Abuse.ch URLhaus",type:"Malware",status:"active",iocs:45200,lastUpdate:"12m ago"},{id:3,name:"Emerging Threats",type:"IDS Rules",status:"active",iocs:8500,lastUpdate:"1h ago"},{id:4,name:"Custom Blacklist",type:"Internal",status:"active",iocs:150,lastUpdate:"2d ago"},{id:5,name:"CISA Automated Indicator Sharing",type:"Gov",status:"error",iocs:0,lastUpdate:"Failed"}],fe=[{id:1,ioc:"185.159.82.15",type:"IP",source:"AlienVault OTX",threat:"Cobalt Strike C2",confidence:95,asset:"192.168.1.105",time:"10m ago"},{id:2,ioc:"update-win32-sys.com",type:"Domain",source:"URLhaus",threat:"Malware Download",confidence:88,asset:"192.168.1.15",time:"45m ago"},{id:3,ioc:"44d88612fea8a8f36de82e1278abb02f",type:"Hash",source:"VirusTotal",threat:"Emotet Payload",confidence:100,asset:"192.168.1.200",time:"2h ago"},{id:4,ioc:"103.240.24.10",type:"IP",source:"Emerging Threats",threat:"Scanner",confidence:60,asset:"Gateway",time:"3h ago"}],ve={totalIocs:1304280,activeThreats:12,blockedConnections:1450,feedHealth:80},Te={totalQueries:452890,blockedQueries:1245,dgaDomains:12,tunnelingAlerts:3},Ce=[{time:"00:00",critical:2,high:5,medium:12},{time:"04:00",critical:1,high:3,medium:8},{time:"08:00",critical:5,high:12,medium:25},{time:"12:00",critical:8,high:15,medium:35},{time:"16:00",critical:6,high:10,medium:28},{time:"20:00",critical:3,high:7,medium:15},{time:"23:59",critical:4,high:6,medium:18}],Me=[{name:"Analyst A",active:5,resolved:12},{name:"Analyst B",active:8,resolved:8},{name:"Analyst C",active:3,resolved:15},{name:"Analyst D",active:6,resolved:10}],Le=[{name:"Firewall",value:45},{name:"IDS/IPS",value:25},{name:"Endpoint",value:20},{name:"Email",value:10}],De=[{id:1,domain:"x8374.bad-site.com",type:"A",client:"192.168.1.105",status:"blocked",category:"Malware",time:"2s ago"},{id:2,domain:"google.com",type:"A",client:"192.168.1.112",status:"allowed",category:"Search",time:"5s ago"},{id:3,domain:"a.root-servers.net",type:"AAAA",client:"192.168.1.200",status:"allowed",category:"Infrastructure",time:"8s ago"},{id:4,domain:"uwq82.dga-gen.org",type:"TXT",client:"192.168.1.15",status:"flagged",category:"DGA",time:"12s ago"},{id:5,domain:"api.slack.com",type:"CNAME",client:"192.168.1.50",status:"allowed",category:"Business",time:"15s ago"}],Ie=[{id:1,domain:"tunnel.exfil.io",method:"TXT Records",volume:"45 MB",client:"192.168.1.105",confidence:98,time:"10m ago"},{id:2,domain:"c2.covert.net",method:"Null/Private",volume:"12 KB",client:"192.168.1.15",confidence:85,time:"1h ago"},{id:3,domain:"long-subdomain.bad.com",method:"Long Labels",volume:"2 MB",client:"192.168.1.200",confidence:70,time:"3h ago"}],Pe=[{name:"A",count:45e3},{name:"AAAA",count:12e3},{name:"CNAME",count:25e3},{name:"TXT",count:5e3},{name:"MX",count:2e3},{name:"PTR",count:8e3},{name:"SRV",count:1500}],_e=[{time:"00:00",qps:120},{time:"04:00",qps:80},{time:"08:00",qps:450},{time:"12:00",qps:600},{time:"16:00",qps:550},{time:"20:00",qps:300},{time:"24:00",qps:150}];function Ne(){const[g,f]=c.useState([]),[b,N]=c.useState([]),[a,j]=c.useState(null),[x,v]=c.useState(!0);c.useEffect(()=>{(async()=>{v(!0);try{const h=await y.getThreatStats();throw h&&h.total_iocs?(j({totalIocs:h.total_iocs||0,activeThreats:h.active_campaigns||0,blockedConnections:h.blocked_24h||0,feedHealth:h.feed_health||0}),new Error("Using mock data for feeds and matches")):new Error("Invalid threat stats response")}catch(h){console.warn("Threat intel API not available, using mock data:",h),await new Promise(t=>setTimeout(t,800)),f(pe),N(fe),j(ve)}finally{v(!1)}})()},[]);const l=[{name:"00:00",matches:2},{name:"04:00",matches:5},{name:"08:00",matches:12},{name:"12:00",matches:8},{name:"16:00",matches:15},{name:"20:00",matches:6},{name:"24:00",matches:4}];return x?e.jsx("div",{className:"loading-state",children:"Loading threat intelligence..."}):e.jsxs("div",{className:"threat-intel",children:[e.jsxs("div",{className:"intel-stats-row",children:[e.jsxs("div",{className:"intel-stat-card",children:[e.jsx("div",{className:"stat-icon bg-purple-500/10 text-purple-400",children:e.jsx(ne,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.totalIocs?(a.totalIocs/1e6).toFixed(1):0,"M"]}),e.jsx("div",{className:"stat-label",children:"Total IOCs"})]})]}),e.jsxs("div",{className:"intel-stat-card",children:[e.jsx("div",{className:"stat-icon bg-red-500/10 text-red-400",children:e.jsx(le,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.activeThreats}),e.jsx("div",{className:"stat-label",children:"Active Matches"})]})]}),e.jsxs("div",{className:"intel-stat-card",children:[e.jsx("div",{className:"stat-icon bg-blue-500/10 text-blue-400",children:e.jsx(re,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsx("div",{className:"stat-value",children:a?.blockedConnections}),e.jsx("div",{className:"stat-label",children:"Blocked (24h)"})]})]}),e.jsxs("div",{className:"intel-stat-card",children:[e.jsx("div",{className:"stat-icon bg-green-500/10 text-green-400",children:e.jsx(ce,{className:"w-6 h-6"})}),e.jsxs("div",{className:"stat-info",children:[e.jsxs("div",{className:"stat-value",children:[a?.feedHealth,"%"]}),e.jsx("div",{className:"stat-label",children:"Feed Health"})]})]})]}),e.jsxs("div",{className:"intel-content-grid",children:[e.jsxs("div",{className:"intel-left-col",children:[e.jsxs("div",{className:"intel-panel",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(E,{className:"w-4 h-4 text-blue-400"})," Intelligence Feeds"]}),e.jsx("button",{className:"btn-icon",children:e.jsx(P,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"feeds-list",children:g.map(i=>e.jsxs("div",{className:"feed-item",children:[e.jsx("div",{className:"feed-status",children:i.status==="active"?e.jsx($,{className:"w-4 h-4 text-green-400"}):e.jsx(R,{className:"w-4 h-4 text-red-400"})}),e.jsxs("div",{className:"feed-info",children:[e.jsx("div",{className:"feed-name",children:i.name}),e.jsxs("div",{className:"feed-meta",children:[e.jsx("span",{children:i.type}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[i.iocs.toLocaleString()," IOCs"]})]})]}),e.jsx("div",{className:"feed-update",children:i.lastUpdate})]},i.id))})]}),e.jsxs("div",{className:"intel-panel",children:[e.jsx("div",{className:"panel-header",children:e.jsxs("h3",{children:[e.jsx(A,{className:"w-4 h-4 text-orange-400"})," Threat Matches (24h)"]})}),e.jsx("div",{className:"chart-container-sm",children:e.jsx(C,{width:"100%",height:"100%",children:e.jsxs(B,{data:l,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorMatches",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#f97316",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#f97316",stopOpacity:0})]})}),e.jsx(U,{strokeDasharray:"3 3",stroke:"#334155",vertical:!1}),e.jsx(H,{dataKey:"name",stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(F,{stroke:"#94a3b8",fontSize:10,tickLine:!1,axisLine:!1}),e.jsx(M,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px"},itemStyle:{color:"#e2e8f0"}}),e.jsx(L,{type:"monotone",dataKey:"matches",stroke:"#f97316",fillOpacity:1,fill:"url(#colorMatches)"})]})})})]})]}),e.jsx("div",{className:"intel-right-col",children:e.jsxs("div",{className:"intel-panel full-height",children:[e.jsxs("div",{className:"panel-header",children:[e.jsxs("h3",{children:[e.jsx(O,{className:"w-4 h-4 text-red-400"})," Recent IOC Matches"]}),e.jsx("button",{className:"btn-text",children:"View All"})]}),e.jsxs("table",{className:"intel-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"IOC"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Threat / Source"}),e.jsx("th",{children:"Confidence"}),e.jsx("th",{children:"Affected Asset"}),e.jsx("th",{children:"Time"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:b.map(i=>e.jsxs("tr",{children:[e.jsx("td",{className:"mono text-red-300",children:i.ioc}),e.jsx("td",{children:e.jsx("span",{className:"type-badge",children:i.type})}),e.jsxs("td",{children:[e.jsx("div",{className:"threat-name",children:i.threat}),e.jsx("div",{className:"threat-source",children:i.source})]}),e.jsxs("td",{children:[e.jsx("div",{className:"confidence-bar",children:e.jsx("div",{className:`confidence-fill ${i.confidence>80?"high":"med"}`,style:{width:`${i.confidence}%`}})}),e.jsxs("span",{className:"confidence-text",children:[i.confidence,"%"]})]}),e.jsx("td",{className:"mono text-blue-300",children:i.asset}),e.jsx("td",{className:"text-gray-400",children:i.time}),e.jsx("td",{children:e.jsx(oe,{className:"w-4 h-4 text-gray-500 cursor-pointer hover:text-white"})})]},i.id))})]})]})})]})]})}const Re=Object.freeze(Object.defineProperty({__proto__:null,default:Ne},Symbol.toStringTag,{value:"Module"}));export{Ae as A,Se as N,ke as S,Re as T,Me as a,Le as b,_e as c,Pe as d,Te as e,De as f,Ie as g,Ce as m};
