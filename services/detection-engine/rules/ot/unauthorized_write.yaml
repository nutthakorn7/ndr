name: Unauthorized OT Write Command
description: Write command to industrial control system from unauthorized source
severity: critical
category: impact
mitre_attack: T0836
enabled: true

conditions:
  - field: zeek_log_type
    operator: in
    value:
      - modbus
      - dnp3
  - field: zeek.function_code
    operator: in
    value:
      - "5"    # Modbus: Write Single Coil
      - "6"    # Modbus: Write Single Register
      - "15"   # Modbus: Write Multiple Coils
      - "16"   # Modbus: Write Multiple Registers
  - field: source.ip_type
    operator: not_equals
    value: authorized_ot_writer

tags:
  - ot
  - ics
  - scada
  - unauthorized
  - critical_infrastructure
